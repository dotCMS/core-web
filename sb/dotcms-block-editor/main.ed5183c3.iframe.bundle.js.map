{"version":3,"file":"main.ed5183c3.iframe.bundle.js","mappings":"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","sources":["webpack:////home/runner/work/core-web/core-web/apps/dotcms-block-editor/src/app|sync|/^\\.(?22e5","/home/runner/work/core-web/core-web/apps/dotcms-block-editor/src/app|sync|/^\\.(","./libs/block-editor/src/lib/editor.directive.ts","./libs/block-editor/src/lib/floating-menu.directive.ts","./libs/block-editor/src/lib/bubble-menu.directive.ts","./libs/block-editor/src/lib/draggable.directive.ts","./libs/block-editor/src/lib/node-view-content.directive.ts","./libs/block-editor/src/lib/AngularRenderer.ts","./libs/block-editor/src/lib/NodeViewRenderer.ts","./libs/block-editor/src/lib/extensions/blocks/contentlet-block/contentlet-block.component.ts","./libs/block-editor/src/lib/extensions/services/suggestions/suggestions.service.ts","./libs/block-editor/src/lib/extensions/components/suggestions-list-item/suggestions-list-item.component.ts","./libs/block-editor/src/lib/extensions/components/suggestion-list/suggestion-list.component.ts","./libs/block-editor/src/lib/extensions/components/suggestions/suggestion-icons.ts","./libs/block-editor/src/lib/extensions/components/suggestions/suggestions.component.ts","./libs/block-editor/src/lib/extensions/components/action-button/action-button.component.ts","./libs/dotcms-js/src/lib/core/string-utils.service.ts","./libs/dotcms-js/src/lib/environments/environment.ts","./libs/dotcms-js/src/lib/core/util/http-request-utils.ts","./libs/dotcms-js/src/lib/core/logger.service.ts","./libs/dotcms-js/src/lib/core/shared/user.model.ts","./libs/dotcms-js/src/lib/core/api-root.service.ts","./libs/dotcms-js/src/lib/core/browser-util.service.ts","./libs/dotcms-js/src/lib/core/util/http-code.ts","./libs/dotcms-js/src/lib/core/util/http-response-util.ts","./libs/dotcms-js/src/lib/core/util/response-view.ts","./libs/dotcms-js/src/lib/core/core-web.service.ts","./libs/dotcms-js/src/lib/core/dot-push-publish-dialog.service.ts","./libs/dotcms-js/src/lib/core/dot-router.service.ts","./libs/dotcms-js/src/lib/core/dotcms-config.service.ts","./libs/dotcms-js/src/lib/core/util/protocol.ts","./libs/dotcms-js/src/lib/core/util/websockets-protocol.ts","./libs/dotcms-js/src/lib/core/util/long-polling-protocol.ts","./libs/dotcms-js/src/lib/core/util/models/dot-event-socket-url.ts","./libs/dotcms-js/src/lib/core/util/dot-event-socket.ts","./libs/dotcms-js/src/lib/core/dotcms-events.service.ts","./libs/dotcms-js/src/lib/core/login.service.ts","./libs/dotcms-js/src/lib/core/routing.service.ts","./libs/dotcms-js/src/lib/core/site.service.ts","./libs/dotcms-js/src/lib/core/util/app.config.ts","./libs/dotcms-js/src/lib/core/util/local-store.service.ts","./libs/dotcms-js/src/lib/core/util/notification.service.ts","./libs/dotcms-js/src/lib/core/core-web.service.mock.ts","./libs/block-editor/src/lib/extensions/components/drag-handler/drag-handler.component.ts","./libs/block-editor/src/lib/extensions/blocks/image-block/image-block.component.ts","./libs/block-editor/src/lib/extensions/components/loader/loader.component.ts","./libs/utils/src/lib/services/dot-temp-file.service.ts","./libs/block-editor/src/lib/extensions/services/dot-image/dot-image.service.ts","./libs/block-editor/src/lib/extensions/components/bubble-menu/bubble-menu.component.ts","./libs/block-editor/src/lib/extensions/components/bubble-menu-button/bubble-menu-button.component.ts","./libs/block-editor/src/lib/extensions/components/bubble-menu-link-form/bubble-menu-link-form.component.ts","./libs/block-editor/src/lib/ngx-tiptap.module.ts","./libs/block-editor/src/lib/plugins/floating.plugin.ts","./libs/block-editor/src/lib/extensions/actions-menu.extension.ts","./libs/block-editor/src/lib/extensions/blocks/image-block/image-block.extention.ts","./libs/block-editor/src/lib/plugins/placeholder.plugin.ts","./libs/block-editor/src/lib/extensions/imageUpload.extension.ts","./libs/block-editor/src/lib/extensions/dragHandler.extension.ts","./libs/block-editor/src/lib/plugins/bubble-link-form.plugin.ts","./libs/block-editor/src/lib/extensions/bubble-link-form.extension.ts","./libs/block-editor/src/lib/utils/bubble-menu.utils.ts","./libs/block-editor/src/lib/plugins/dot-bubble-menu.plugin.ts","./libs/block-editor/src/lib/extensions/dot-bubble-menu.extension.ts","./apps/dotcms-block-editor/src/app/dot-block-editor/dot-block-editor.component.ts","./libs/block-editor/src/lib/extensions/blocks/contentlet-block/contentlet-block.extension.ts","./apps/dotcms-block-editor/src/app/dot-block-editor/dot-block-editor.component.stories.ts","./generated-stories-entry.js"],"sourcesContent":["var map = {\n\t\"./dot-block-editor/dot-block-editor.component.stories.ts\": \"./apps/dotcms-block-editor/src/app/dot-block-editor/dot-block-editor.component.stories.ts\"\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = \"./apps/dotcms-block-editor/src/app sync recursive ^\\\\.(?:(?:^%7C\\\\/%7C(?:(?:(?%21(?:^%7C\\\\/)\\\\.).)*?)\\\\/)(?%21\\\\.)(?=.)[^/]*?\\\\.stories\\\\.(js%7Cjsx%7Cts%7Ctsx))$\";","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = () => ([]);\nwebpackEmptyContext.resolve = webpackEmptyContext;\nwebpackEmptyContext.id = \"./apps/dotcms-block-editor/src/app sync recursive ^\\\\.(?:(?:^%7C\\\\/%7C(?:(?:(?%21(?:^%7C\\\\/)\\\\.).)*?)\\\\/)(?%21\\\\.)(?=.)[^/]*?\\\\.stories\\\\.mdx)$\";\nmodule.exports = webpackEmptyContext;","import { Directive, ElementRef, forwardRef, Input, OnDestroy, OnInit, Renderer2 } from '@angular/core';\nimport { ControlValueAccessor, NG_VALUE_ACCESSOR } from '@angular/forms';\nimport { Content, Editor, JSONContent } from '@tiptap/core';\nimport { Transaction } from 'prosemirror-state';\n\n@Directive({\n  selector: 'tiptap[editor], [tiptap][editor], tiptap-editor[editor], [tiptapEditor][editor]',\n  providers: [{\n    provide: NG_VALUE_ACCESSOR,\n    useExisting: forwardRef(() => EditorDirective),\n    multi: true\n  }]\n})\n\nexport class EditorDirective implements OnInit, ControlValueAccessor, OnDestroy {\n  @Input() editor!: Editor;\n  @Input() outputFormat: 'json' | 'html' = 'html';\n\n  constructor(private el: ElementRef<HTMLElement>, private _renderer: Renderer2) { }\n\n  private onChange: (value: Content) => void = () => {/** */ };\n  private onTouched: () => void = () => { /** */ };\n\n  // Writes a new value to the element.\n  // This methods is called when programmatic changes from model to view are requested.\n  writeValue(value: Content): void {\n    if (!value) {\n      return;\n    }\n\n    if (!this.outputFormat && typeof value === 'string') {\n      this.outputFormat = 'html';\n    }\n\n    this.editor.chain().setContent(value, false).run();\n  }\n\n  // Registers a callback function that is called when the control's value changes in the UI.\n  registerOnChange(fn: () => void): void {\n    this.onChange = fn;\n  }\n\n  // Registers a callback function that is called by the forms API on initialization to update the form model on blur.\n  registerOnTouched(fn: () => void): void {\n    this.onTouched = fn;\n  }\n\n  // Called by the forms api to enable or disable the element\n  setDisabledState(isDisabled: boolean): void {\n    this.editor.setEditable(!isDisabled);\n    this._renderer.setProperty(this.el.nativeElement, 'disabled', isDisabled);\n  }\n\n  private handleChange = ({ transaction }: { transaction: Transaction }): void => {\n    if (!transaction.docChanged) {\n      return;\n    }\n\n    if (this.outputFormat === 'html') {\n      this.onChange(this.editor.getHTML());\n      return;\n    }\n\n    this.onChange(this.editor.getJSON() as JSONContent);\n  }\n\n  ngOnInit(): void {\n    if (!this.editor) {\n      throw new Error('Required: Input `editor`');\n    }\n\n    // take the inner contents and clear the block\n    const innerHTML = this.el.nativeElement.innerHTML;\n    this.el.nativeElement.innerHTML = '';\n\n    // insert the editor in the dom\n    this.el.nativeElement.appendChild(this.editor.options.element.firstChild as ChildNode);\n\n    // update the options for the editor\n    this.editor.setOptions({ element: this.el.nativeElement });\n\n    // update content to the editor\n    if (innerHTML) {\n      this.editor.chain().setContent(innerHTML, false).run();\n    }\n\n    // register blur handler to update `touched` property\n    this.editor.on('blur', () => {\n      this.onTouched();\n    });\n\n    // register transaction handler to emit changes on update\n    this.editor.on('transaction', this.handleChange);\n  }\n\n  ngOnDestroy(): void {\n    this.editor.destroy();\n  }\n}\n","import { Directive, ElementRef, Input, OnDestroy, OnInit } from '@angular/core';\nimport { Editor } from '@tiptap/core';\nimport { FloatingMenuPlugin, FloatingMenuPluginProps } from '@tiptap/extension-floating-menu';\n\n@Directive({\n    selector: 'tiptap-floating-menu[editor], [tiptapFloatingMenu][editor]'\n})\nexport class FloatingMenuDirective implements OnInit, OnDestroy {\n    @Input() pluginKey: FloatingMenuPluginProps['pluginKey'] = 'NgxTiptapFloatingMenu';\n    @Input() editor!: Editor;\n    @Input() tippyOptions: FloatingMenuPluginProps['tippyOptions'] = {};\n    @Input() shouldShow: FloatingMenuPluginProps['shouldShow'] = null;\n\n    constructor(private _el: ElementRef<HTMLElement>) {}\n\n    ngOnInit(): void {\n        if (!this.editor) {\n            throw new Error('Required: Input `editor`');\n        }\n\n        this.editor.registerPlugin(\n            FloatingMenuPlugin({\n                pluginKey: this.pluginKey,\n                editor: this.editor,\n                element: this._el.nativeElement,\n                tippyOptions: this.tippyOptions,\n                shouldShow: this.shouldShow\n            })\n        );\n    }\n\n    ngOnDestroy(): void {\n        this.editor.unregisterPlugin(this.pluginKey);\n    }\n}\n","import { Directive, ElementRef, Input, OnDestroy, OnInit } from '@angular/core';\nimport { Editor } from '@tiptap/core';\nimport { BubbleMenuPlugin, BubbleMenuPluginProps } from '@tiptap/extension-bubble-menu';\n\n@Directive({\n    selector: 'tiptap-bubble-menu[editor], [tiptapBubbleMenu][editor]'\n})\nexport class BubbleMenuDirective implements OnInit, OnDestroy {\n    @Input() pluginKey: BubbleMenuPluginProps['pluginKey'] = 'NgxTiptapBubbleMenu';\n    @Input() editor!: Editor;\n    @Input() tippyOptions: BubbleMenuPluginProps['tippyOptions'] = {};\n    @Input() shouldShow: BubbleMenuPluginProps['shouldShow'] = null;\n\n    constructor(private _el: ElementRef<HTMLElement>) {}\n\n    ngOnInit(): void {\n        if (!this.editor) {\n            throw new Error('Required: Input `editor`');\n        }\n\n        this.editor.registerPlugin(\n            BubbleMenuPlugin({\n                pluginKey: this.pluginKey,\n                editor: this.editor,\n                element: this._el.nativeElement,\n                tippyOptions: this.tippyOptions,\n                shouldShow: this.shouldShow\n            })\n        );\n    }\n\n    ngOnDestroy(): void {\n        this.editor.unregisterPlugin(this.pluginKey);\n    }\n}\n","import { Directive, HostBinding } from '@angular/core';\n\n@Directive({\n  selector: '[tiptapDraggable]'\n})\nexport class DraggableDirective {\n  @HostBinding('attr.draggable') draggable = true\n  @HostBinding('attr.data-drag-handle') handle = ''\n}\n","import { Directive, HostBinding } from '@angular/core';\n\n@Directive({\n  selector: '[tiptapNodeViewContent]'\n})\nexport class NodeViewContentDirective {\n  @HostBinding('attr.data-node-view-content') handle = ''\n}\n","import {\n    ApplicationRef,\n    ComponentFactoryResolver,\n    ComponentRef,\n    ElementRef,\n    Injector,\n    Type\n} from '@angular/core';\n\nexport class AngularRenderer<C, P> {\n    private applicationRef: ApplicationRef;\n    private componentRef: ComponentRef<C>;\n\n    constructor(component: Type<C>, injector: Injector, props: Partial<P>) {\n        this.applicationRef = injector.get(ApplicationRef);\n\n        const componentFactoryResolver = injector.get(ComponentFactoryResolver);\n        const factory = componentFactoryResolver.resolveComponentFactory(component);\n\n        this.componentRef = factory.create(injector, []);\n\n        // set input props to the component\n        this.updateProps(props);\n\n        // Attach to the view so that the change detector knows to run\n        this.applicationRef.attachView(this.componentRef.hostView);\n    }\n\n    get instance(): C {\n        return this.componentRef.instance;\n    }\n\n    get elementRef(): ElementRef {\n        return this.componentRef.injector.get(ElementRef);\n    }\n\n    get dom(): HTMLElement {\n        return this.elementRef.nativeElement;\n    }\n\n    updateProps<T extends P>(props: Partial<T>): void {\n        Object.entries(props).forEach(([key, value]) => {\n            this.instance[key as keyof C] = value as C[keyof C];\n        });\n    }\n\n    detectChanges(): void {\n        this.componentRef.changeDetectorRef.detectChanges();\n    }\n\n    destroy(): void {\n        this.componentRef.destroy();\n        this.applicationRef.detachView(this.componentRef.hostView);\n    }\n}\n","import { Component, Injector, Input, Type } from '@angular/core';\nimport {\n    Editor,\n    NodeView,\n    NodeViewProps,\n    NodeViewRenderer,\n    NodeViewRendererProps,\n    NodeViewRendererOptions\n} from '@tiptap/core';\nimport type { Decoration } from 'prosemirror-view';\nimport type { Node as ProseMirrorNode } from 'prosemirror-model';\n\nimport { AngularRenderer } from './AngularRenderer';\n\n@Component({ template: '' })\nexport class AngularNodeViewComponent implements NodeViewProps {\n    @Input() editor!: NodeViewProps['editor'];\n    @Input() node!: NodeViewProps['node'];\n    @Input() decorations!: NodeViewProps['decorations'];\n    @Input() selected!: NodeViewProps['selected'];\n    @Input() extension!: NodeViewProps['extension'];\n    @Input() getPos!: NodeViewProps['getPos'];\n    @Input() updateAttributes!: NodeViewProps['updateAttributes'];\n    @Input() deleteNode!: NodeViewProps['deleteNode'];\n}\n\ninterface AngularNodeViewRendererOptions extends NodeViewRendererOptions {\n    update?: ((node: ProseMirrorNode, decorations: Decoration[]) => boolean) | null;\n    injector: Injector;\n}\n\nclass AngularNodeView extends NodeView<\n    Type<AngularNodeViewComponent>,\n    Editor,\n    AngularNodeViewRendererOptions\n> {\n    renderer!: AngularRenderer<AngularNodeViewComponent, NodeViewProps>;\n    contentDOMElement!: HTMLElement | null;\n\n    mount() {\n        const injector = this.options.injector as Injector;\n\n        const props: NodeViewProps = {\n            editor: this.editor,\n            node: this.node,\n            decorations: this.decorations,\n            selected: false,\n            extension: this.extension,\n            getPos: () => this.getPos(),\n            updateAttributes: (attributes = {}) => this.updateAttributes(attributes),\n            deleteNode: () => this.deleteNode()\n        };\n\n        // create renderer\n        this.renderer = new AngularRenderer(this.component, injector, props);\n\n        // Register drag handler\n        if (this.extension.config.draggable) {\n            this.renderer.elementRef.nativeElement.ondragstart = (e: DragEvent) => {\n                this.onDragStart(e);\n            };\n        }\n\n        this.contentDOMElement = this.node.isLeaf\n            ? null\n            : document.createElement(this.node.isInline ? 'span' : 'div');\n\n        if (this.contentDOMElement) {\n            // For some reason the whiteSpace prop is not inherited properly in Chrome and Safari\n            // With this fix it seems to work fine\n            // See: https://github.com/ueberdosis/tiptap/issues/1197\n            this.contentDOMElement.style.whiteSpace = 'inherit';\n            this.renderer.detectChanges();\n        }\n    }\n\n    get dom() {\n        return this.renderer.dom;\n    }\n\n    get contentDOM() {\n        if (this.node.isLeaf) {\n            return null;\n        }\n\n        this.maybeMoveContentDOM();\n        return this.contentDOMElement;\n    }\n\n    private maybeMoveContentDOM(): void {\n        const contentElement = this.dom.querySelector('[data-node-view-content]');\n\n        if (\n            this.contentDOMElement &&\n            contentElement &&\n            !contentElement.contains(this.contentDOMElement)\n        ) {\n            contentElement.appendChild(this.contentDOMElement);\n        }\n    }\n\n    update(node: ProseMirrorNode, decorations: Decoration[]): boolean {\n        if (this.options.update) {\n            return this.options.update(node, decorations);\n        }\n\n        if (node.type !== this.node.type) {\n            return false;\n        }\n\n        if (node === this.node && this.decorations === decorations) {\n            return true;\n        }\n\n        this.node = node;\n        this.decorations = decorations;\n        this.renderer.updateProps({ node, decorations });\n        this.maybeMoveContentDOM();\n\n        return true;\n    }\n\n    selectNode() {\n        this.renderer.updateProps({ selected: true });\n    }\n\n    deselectNode() {\n        this.renderer.updateProps({ selected: false });\n    }\n\n    destroy() {\n        this.renderer.destroy();\n    }\n}\n\nexport const AngularNodeViewRenderer = (\n    component: Type<AngularNodeViewComponent>,\n    options: Partial<AngularNodeViewRendererOptions>\n): NodeViewRenderer => {\n    return (props: NodeViewRendererProps) => {\n        return new AngularNodeView(component, props, options);\n    };\n};\n","import { Component, OnInit, ViewEncapsulation } from '@angular/core';\nimport { AngularNodeViewComponent } from '../../../NodeViewRenderer';\n\n@Component({\n    selector: 'dotcms-contentlet-block',\n    templateUrl: './contentlet-block.component.html',\n    styleUrls: ['./contentlet-block.component.scss'],\n    encapsulation: ViewEncapsulation.None\n})\nexport class ContentletBlockComponent extends AngularNodeViewComponent implements OnInit {\n    data: {\n        title: string;\n        inode: string;\n    };\n\n    ngOnInit() {\n        this.data = this.node.attrs.data;\n    }\n}\n","import { Injectable } from '@angular/core';\n\nimport { Observable } from 'rxjs';\nimport { pluck } from 'rxjs/operators';\n\nimport { DotCMSContentlet, DotCMSContentType } from '@dotcms/dotcms-models';\n// eslint-disable-next-line max-len\nimport { HttpClient, HttpHeaders } from '@angular/common/http';\n\n@Injectable()\nexport class SuggestionsService {\n\n    constructor(private http: HttpClient) {}\n\n    get defaultHeaders() {\n        const headers = new HttpHeaders();\n        headers\n            .set('Accept', '*/*')\n            .set('Content-Type', 'application/json');\n        return headers;\n    }\n\n    getContentTypes(filter = ''): Observable<DotCMSContentType[]> {\n        return this.http\n            .get(`/api/v1/contenttype?filter=${filter}&orderby=name&direction=ASC&per_page=40`, {\n                headers: this.defaultHeaders\n            })\n            .pipe(pluck('entity'));\n    }\n\n    getContentlets(contentType = ''): Observable<DotCMSContentlet[]> {\n        return this.http\n            // eslint-disable-next-line max-len\n            .get(`/api/content/render/false/query/+contentType:${contentType}%20+languageId:1%20+deleted:false%20+working:true/orderby/modDate%20desc`, {\n                headers: this.defaultHeaders\n            })\n            .pipe(pluck('contentlets'));\n    }\n\n}\n","import { Component, ElementRef, HostBinding, Input, OnInit } from '@angular/core';\n\nimport { FocusableOption } from '@angular/cdk/a11y';\n\n@Component({\n    selector: 'dotcms-suggestions-list-item',\n    templateUrl: './suggestions-list-item.component.html',\n    styleUrls: ['./suggestions-list-item.component.scss'],\n})\nexport class SuggestionsListItemComponent implements FocusableOption, OnInit {\n    @HostBinding('attr.role') role = 'list-item'\n    @HostBinding('attr.tabindex') tabindex = '-1'\n\n    @HostBinding('attr.data-index')\n    @Input() index: number;\n\n    @Input() command: () => void;\n    @Input() label = '';\n    @Input() url = '';\n\n    icon = false;\n\n    constructor(private element: ElementRef) { }\n\n    ngOnInit() {\n        this.icon = this.icon = typeof( this.url ) === 'string' && !(this.url.split('/').length > 1);\n    }\n\n    getLabel(): string {\n        return this.element.nativeElement.innerText;\n    }\n\n    focus() {\n        this.element.nativeElement.style = 'background: #eee';\n    }\n\n    unfocus() {\n        this.element.nativeElement.style = '';\n    }\n\n    scrollIntoView() {\n        if (!this.isIntoView()) {\n            this.element.nativeElement.scrollIntoView(this.alignToTop());\n        }\n    }\n\n    /**\n     *\n     * Check if the element is a visible area \n     * \n     * @private\n     * @return {*}  {boolean}\n     * @memberof SuggestionsListItemComponent\n     */\n    private isIntoView(): boolean {\n        const { bottom, top } = this.element.nativeElement.getBoundingClientRect();\n        const containerRect = this.element.nativeElement.parentElement.getBoundingClientRect();\n        return top >= containerRect.top && bottom <= containerRect.bottom;\n    }\n\n    /**\n     *\n     * If true, the top of the element will be aligned to the top of the visible area\n     * of the scrollable ancestorIf true, the top of the element will be aligned to \n     * the top of the visible area of the scrollable ancestor.\n     *\n     * @private\n     * @return {*}  {boolean}\n     * @memberof SuggestionsListItemComponent\n     */\n    private alignToTop(): boolean {\n        const { top } = this.element.nativeElement.getBoundingClientRect();\n        const { top: containerTop} = this.element.nativeElement.parentElement.getBoundingClientRect();\n        return top < containerTop;\n    }\n\n}\n","import { FocusKeyManager } from '@angular/cdk/a11y';\nimport { AfterContentInit, Component, ContentChildren, QueryList } from '@angular/core';\nimport { SuggestionsListItemComponent } from '../suggestions-list-item/suggestions-list-item.component';\n\n@Component({\n    selector: 'dotcms-suggestion-list',\n    templateUrl: './suggestion-list.component.html',\n    styleUrls: ['./suggestion-list.component.scss']\n})\nexport class SuggestionListComponent implements AfterContentInit {\n    keyManager: FocusKeyManager<SuggestionsListItemComponent>;\n\n    @ContentChildren(SuggestionsListItemComponent) items: QueryList<SuggestionsListItemComponent>;\n\n    ngAfterContentInit() {\n        this.keyManager = new FocusKeyManager(this.items).withWrap();\n    }\n\n    /**\n     * Update the selected item in the list\n     *\n     * @param {KeyboardEvent} event\n     * @memberof SuggestionListComponent\n     */\n    updateSelection(event: KeyboardEvent) {\n        if (this.keyManager.activeItem) {\n            this.keyManager.activeItem.unfocus();\n        }\n\n        this.keyManager.onKeydown(event);\n        this.keyManager.activeItem.scrollIntoView();\n    }\n\n    /**\n     * Execute the command function in the list item component\n     *\n     * @memberof SuggestionListComponent\n     */\n    execCommand() {\n        this.keyManager.activeItem.command()\n    }\n\n    /**\n     * Set the first item of the list active\n     *\n     * @memberof SuggestionListComponent\n     */\n    setFirstItemActive() {\n        this.keyManager.activeItem?.unfocus();\n        this.keyManager.setFirstItemActive();\n        this.keyManager.activeItem.focus();\n    }\n\n    /**\n     * Reset the key manager with the new options\n     *\n     * @memberof SuggestionListComponent\n     */\n    resetKeyManager() {\n        this.keyManager = new FocusKeyManager(this.items).withWrap();\n\n        // Needs to wait until the new items are rendered\n        setTimeout(() => {\n            this.setFirstItemActive();\n        }, 0)\n    }\n\n    /**\n     * Set an active item manually\n     *\n     * @param {number} index\n     * @memberof SuggestionListComponent\n     */\n    updateActiveItem(index: number): void {\n        this.keyManager.activeItem?.unfocus();\n        this.keyManager.setActiveItem(index)\n    }\n\n}\n","/* eslint-disable max-len */\n\nexport const headerIcons = ['data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTYuNjMyODEgMjJWMjEuMDE1Nkw3LjkwNjI1IDIwLjc5NjlWMTEuODM1OUw2LjYzMjgxIDExLjYxNzJWMTAuNjI1SDEwLjcxODhWMTEuNjE3Mkw5LjQ0NTMxIDExLjgzNTlWMTUuNzY1NkgxNC44ODI4VjExLjgzNTlMMTMuNjA5NCAxMS42MTcyVjEwLjYyNUgxNy42OTUzVjExLjYxNzJMMTYuNDIxOSAxMS44MzU5VjIwLjc5NjlMMTcuNjk1MyAyMS4wMTU2VjIySDEzLjYwOTRWMjEuMDE1NkwxNC44ODI4IDIwLjc5NjlWMTYuOTc2Nkg5LjQ0NTMxVjIwLjc5NjlMMTAuNzE4OCAyMS4wMTU2VjIySDYuNjMyODFaTTE5LjI3MzQgMjJWMjEuMDE1NkwyMS4wMzEyIDIwLjc5NjlWMTIuMjczNEwxOS4yNDIyIDEyLjMwNDdWMTEuMzQzOEwyMi41NzAzIDEwLjYyNVYyMC43OTY5TDI0LjMyMDMgMjEuMDE1NlYyMkgxOS4yNzM0WiIgZmlsbD0iIzIyMjIyMiIvPgo8L3N2Zz4K', 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTUuNjMyODEgMjJWMjEuMDE1Nkw2LjkwNjI1IDIwLjc5NjlWMTEuODM1OUw1LjYzMjgxIDExLjYxNzJWMTAuNjI1SDkuNzE4NzVWMTEuNjE3Mkw4LjQ0NTMxIDExLjgzNTlWMTUuNzY1NkgxMy44ODI4VjExLjgzNTlMMTIuNjA5NCAxMS42MTcyVjEwLjYyNUgxNi42OTUzVjExLjYxNzJMMTUuNDIxOSAxMS44MzU5VjIwLjc5NjlMMTYuNjk1MyAyMS4wMTU2VjIySDEyLjYwOTRWMjEuMDE1NkwxMy44ODI4IDIwLjc5NjlWMTYuOTc2Nkg4LjQ0NTMxVjIwLjc5NjlMOS43MTg3NSAyMS4wMTU2VjIySDUuNjMyODFaTTE4LjA4NTkgMjJWMjAuOTQ1M0wyMS44MTI1IDE2LjgwNDdDMjIuMjU1MiAxNi4zMDk5IDIyLjYwMTYgMTUuODg4IDIyLjg1MTYgMTUuNTM5MUMyMy4xMDE2IDE1LjE4NDkgMjMuMjc2IDE0Ljg2NDYgMjMuMzc1IDE0LjU3ODFDMjMuNDc0IDE0LjI5MTcgMjMuNTIzNCAxMy45OTQ4IDIzLjUyMzQgMTMuNjg3NUMyMy41MjM0IDEzLjExOTggMjMuMzUxNiAxMi42NDMyIDIzLjAwNzggMTIuMjU3OEMyMi42NjQxIDExLjg2NzIgMjIuMTcxOSAxMS42NzE5IDIxLjUzMTIgMTEuNjcxOUMyMC44NjQ2IDExLjY3MTkgMjAuMzQzOCAxMS44NzI0IDE5Ljk2ODggMTIuMjczNEMxOS41OTkgMTIuNjc0NSAxOS40MTQxIDEzLjI0MjIgMTkuNDE0MSAxMy45NzY2SDE3LjkzNzVMMTcuOTIxOSAxMy45Mjk3QzE3LjkwNjIgMTMuMjczNCAxOC4wNDQzIDEyLjY4NDkgMTguMzM1OSAxMi4xNjQxQzE4LjYyNzYgMTEuNjM4IDE5LjA0OTUgMTEuMjI0IDE5LjYwMTYgMTAuOTIxOUMyMC4xNTg5IDEwLjYxNDYgMjAuODIwMyAxMC40NjA5IDIxLjU4NTkgMTAuNDYwOUMyMi4zMDQ3IDEwLjQ2MDkgMjIuOTIxOSAxMC41OTkgMjMuNDM3NSAxMC44NzVDMjMuOTU4MyAxMS4xNDU4IDI0LjM1OTQgMTEuNTE4MiAyNC42NDA2IDExLjk5MjJDMjQuOTIxOSAxMi40NjYxIDI1LjA2MjUgMTMuMDEwNCAyNS4wNjI1IDEzLjYyNUMyNS4wNjI1IDE0LjI1IDI0Ljg3NzYgMTQuODcyNCAyNC41MDc4IDE1LjQ5MjJDMjQuMTQzMiAxNi4xMTIgMjMuNjI3NiAxNi43ODEyIDIyLjk2MDkgMTcuNUwxOS45Njg4IDIwLjc1NzhMMTkuOTg0NCAyMC43OTY5SDI0LjAyMzRMMjQuMTQ4NCAxOS40OTIySDI1LjQ1MzFWMjJIMTguMDg1OVoiIGZpbGw9IiMyMjIyMjIiLz4KPC9zdmc+Cg==', 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTUuNjMyODEgMjJWMjEuMDE1Nkw2LjkwNjI1IDIwLjc5NjlWMTEuODM1OUw1LjYzMjgxIDExLjYxNzJWMTAuNjI1SDkuNzE4NzVWMTEuNjE3Mkw4LjQ0NTMxIDExLjgzNTlWMTUuNzY1NkgxMy44ODI4VjExLjgzNTlMMTIuNjA5NCAxMS42MTcyVjEwLjYyNUgxNi42OTUzVjExLjYxNzJMMTUuNDIxOSAxMS44MzU5VjIwLjc5NjlMMTYuNjk1MyAyMS4wMTU2VjIySDEyLjYwOTRWMjEuMDE1NkwxMy44ODI4IDIwLjc5NjlWMTYuOTc2Nkg4LjQ0NTMxVjIwLjc5NjlMOS43MTg3NSAyMS4wMTU2VjIySDUuNjMyODFaTTIxLjQ2ODggMjIuMTY0MUMyMC43NzYgMjIuMTY0MSAyMC4xNTg5IDIyLjAzOTEgMTkuNjE3MiAyMS43ODkxQzE5LjA3NTUgMjEuNTMzOSAxOC42NTEgMjEuMTc0NSAxOC4zNDM4IDIwLjcxMDlDMTguMDQxNyAyMC4yNDIyIDE3Ljg5ODQgMTkuNjg3NSAxNy45MTQxIDE5LjA0NjlMMTcuOTM3NSAxOUgxOS40MDYyQzE5LjQwNjIgMTkuNTk5IDE5LjU4ODUgMjAuMDc1NSAxOS45NTMxIDIwLjQyOTdDMjAuMzIyOSAyMC43ODM5IDIwLjgyODEgMjAuOTYwOSAyMS40Njg4IDIwLjk2MDlDMjIuMTE5OCAyMC45NjA5IDIyLjYzMDIgMjAuNzgzOSAyMyAyMC40Mjk3QzIzLjM2OTggMjAuMDc1NSAyMy41NTQ3IDE5LjU1MjEgMjMuNTU0NyAxOC44NTk0QzIzLjU1NDcgMTguMTU2MiAyMy4zOTA2IDE3LjYzOCAyMy4wNjI1IDE3LjMwNDdDMjIuNzM0NCAxNi45NzE0IDIyLjIxNjEgMTYuODA0NyAyMS41MDc4IDE2LjgwNDdIMjAuMTY0MVYxNS42MDE2SDIxLjUwNzhDMjIuMTkwMSAxNS42MDE2IDIyLjY3MTkgMTUuNDMyMyAyMi45NTMxIDE1LjA5MzhDMjMuMjM5NiAxNC43NSAyMy4zODI4IDE0LjI3MzQgMjMuMzgyOCAxMy42NjQxQzIzLjM4MjggMTIuMzM1OSAyMi43NDQ4IDExLjY3MTkgMjEuNDY4OCAxMS42NzE5QzIwLjg2OTggMTEuNjcxOSAyMC4zODggMTEuODQ5IDIwLjAyMzQgMTIuMjAzMUMxOS42NjQxIDEyLjU1MjEgMTkuNDg0NCAxMy4wMTgyIDE5LjQ4NDQgMTMuNjAxNkgxOC4wMDc4TDE3Ljk5MjIgMTMuNTU0N0MxNy45NzY2IDEyLjk4MTggMTguMTEyIDEyLjQ2MDkgMTguMzk4NCAxMS45OTIyQzE4LjY5MDEgMTEuNTIzNCAxOS4wOTkgMTEuMTUxIDE5LjYyNSAxMC44NzVDMjAuMTU2MiAxMC41OTkgMjAuNzcwOCAxMC40NjA5IDIxLjQ2ODggMTAuNDYwOUMyMi41MjA4IDEwLjQ2MDkgMjMuMzU5NCAxMC43NDIyIDIzLjk4NDQgMTEuMzA0N0MyNC42MDk0IDExLjg2MiAyNC45MjE5IDEyLjY1ODkgMjQuOTIxOSAxMy42OTUzQzI0LjkyMTkgMTQuMTY0MSAyNC43Nzg2IDE0LjYzMjggMjQuNDkyMiAxNS4xMDE2QzI0LjIxMDkgMTUuNTY1MSAyMy43ODY1IDE1LjkxOTMgMjMuMjE4OCAxNi4xNjQxQzIzLjkwMSAxNi4zODggMjQuMzgyOCAxNi43Mzk2IDI0LjY2NDEgMTcuMjE4OEMyNC45NTA1IDE3LjY5NzkgMjUuMDkzOCAxOC4yMzQ0IDI1LjA5MzggMTguODI4MUMyNS4wOTM4IDE5LjUyMDggMjQuOTM3NSAyMC4xMTcyIDI0LjYyNSAyMC42MTcyQzI0LjMxNzcgMjEuMTEyIDIzLjg5MDYgMjEuNDk0OCAyMy4zNDM4IDIxLjc2NTZDMjIuNzk2OSAyMi4wMzEyIDIyLjE3MTkgMjIuMTY0MSAyMS40Njg4IDIyLjE2NDFaIiBmaWxsPSIjMjIyMjIyIi8+Cjwvc3ZnPgo=']\nexport const olIcon = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTYuNzA4OTggMjAuNTMxMlYxOS43OTNMOC4wMjczNCAxOS42Mjg5VjEzLjIzNjNMNi42ODU1NSAxMy4yNTk4VjEyLjUzOTFMOS4xODE2NCAxMlYxOS42Mjg5TDEwLjQ5NDEgMTkuNzkzVjIwLjUzMTJINi43MDg5OFoiIGZpbGw9IiMyMjIyMjIiLz4KPHBhdGggZD0iTTExLjc5NDkgMjAuNTMxMlYxOS4zNDc3SDEyLjk0OTJWMjAuNTMxMkgxMS43OTQ5WiIgZmlsbD0iIzIyMjIyMiIvPgo8cmVjdCB4PSIxNSIgeT0iMTMiIHdpZHRoPSIxMSIgaGVpZ2h0PSIxIiBmaWxsPSIjMjIyMjIyIi8+CjxyZWN0IHg9IjE1IiB5PSIxNiIgd2lkdGg9IjExIiBoZWlnaHQ9IjEiIGZpbGw9IiMyMjIyMjIiLz4KPHJlY3QgeD0iMTUiIHk9IjE5IiB3aWR0aD0iMTEiIGhlaWdodD0iMSIgZmlsbD0iIzIyMjIyMiIvPgo8L3N2Zz4K';\nexport const ulIcon = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3QgeD0iMTQiIHk9IjEyIiB3aWR0aD0iMTIiIGhlaWdodD0iMSIgZmlsbD0iIzIyMjIyMiIvPgo8cmVjdCB4PSIxNCIgeT0iMTUiIHdpZHRoPSIxMiIgaGVpZ2h0PSIxIiBmaWxsPSIjMjIyMjIyIi8+CjxyZWN0IHg9IjE0IiB5PSIxOCIgd2lkdGg9IjEyIiBoZWlnaHQ9IjEiIGZpbGw9IiMyMjIyMjIiLz4KPGNpcmNsZSBjeD0iOC41IiBjeT0iMTUuNSIgcj0iMi41IiBmaWxsPSIjMjIyMjIyIi8+Cjwvc3ZnPgo=';\nexport const pIcon = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTYuNDc0NjEgMTZWMTUuMjYxN0w3LjQyOTY5IDE1LjA5NzdWOC4zNzY5NUw2LjQ3NDYxIDguMjEyODlWNy40Njg3NUgxMC4zOTQ1QzExLjMwNDcgNy40Njg3NSAxMi4wMTE3IDcuNzAzMTIgMTIuNTE1NiA4LjE3MTg4QzEzLjAyMzQgOC42NDA2MiAxMy4yNzczIDkuMjU3ODEgMTMuMjc3MyAxMC4wMjM0QzEzLjI3NzMgMTAuNzk2OSAxMy4wMjM0IDExLjQxNiAxMi41MTU2IDExLjg4MDlDMTIuMDExNyAxMi4zNDU3IDExLjMwNDcgMTIuNTc4MSAxMC4zOTQ1IDEyLjU3ODFIOC41ODM5OFYxNS4wOTc3TDkuNTM5MDYgMTUuMjYxN1YxNkg2LjQ3NDYxWk04LjU4Mzk4IDExLjY3NThIMTAuMzk0NUMxMC45NzI3IDExLjY3NTggMTEuNDA0MyAxMS41MjE1IDExLjY4OTUgMTEuMjEyOUMxMS45Nzg1IDEwLjkwMDQgMTIuMTIzIDEwLjUwNzggMTIuMTIzIDEwLjAzNTJDMTIuMTIzIDkuNTYyNSAxMS45Nzg1IDkuMTY3OTcgMTEuNjg5NSA4Ljg1MTU2QzExLjQwNDMgOC41MzUxNiAxMC45NzI3IDguMzc2OTUgMTAuMzk0NSA4LjM3Njk1SDguNTgzOThWMTEuNjc1OFoiIGZpbGw9IiMyMjIyMjIiLz4KPHJlY3QgeD0iMTUiIHk9IjE0IiB3aWR0aD0iMTEiIGhlaWdodD0iMSIgZmlsbD0iIzIyMjIyMiIvPgo8cmVjdCB4PSI2IiB5PSIxOCIgd2lkdGg9IjIwIiBoZWlnaHQ9IjEiIGZpbGw9IiMyMjIyMjIiLz4KPHJlY3QgeD0iNiIgeT0iMjIiIHdpZHRoPSIyMCIgaGVpZ2h0PSIxIiBmaWxsPSIjMjIyMjIyIi8+Cjwvc3ZnPgo=';\nexport const quoteIcon = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTcuNjI1IDEzQzcuMTI1IDEzIDYuNzI1IDEyLjg1IDYuNDI1IDEyLjU1QzYuMTQxNjcgMTIuMjMzMyA2IDExLjggNiAxMS4yNUM2IDEwLjAzMzMgNi4zNzUgOC45NjY2NyA3LjEyNSA4LjA1QzcuNDU4MzMgNy42MTY2NyA3LjgzMzMzIDcuMjY2NjcgOC4yNSA3TDkgNy44NzVDOC43NjY2NyA4LjA0MTY3IDguNTMzMzMgOC4yNTgzMyA4LjMgOC41MjVDNy44NSA5LjAwODMzIDcuNjI1IDkuNSA3LjYyNSAxMEM4LjAwODMzIDEwIDguMzMzMzMgMTAuMTQxNyA4LjYgMTAuNDI1QzguODY2NjcgMTAuNzA4MyA5IDExLjA2NjcgOSAxMS41QzkgMTEuOTMzMyA4Ljg2NjY3IDEyLjI5MTcgOC42IDEyLjU3NUM4LjMzMzMzIDEyLjg1ODMgOC4wMDgzMyAxMyA3LjYyNSAxM1pNMTEuNjI1IDEzQzExLjEyNSAxMyAxMC43MjUgMTIuODUgMTAuNDI1IDEyLjU1QzEwLjE0MTcgMTIuMjMzMyAxMCAxMS44IDEwIDExLjI1QzEwIDEwLjAzMzMgMTAuMzc1IDguOTY2NjcgMTEuMTI1IDguMDVDMTEuNDU4MyA3LjYxNjY3IDExLjgzMzMgNy4yNjY2NyAxMi4yNSA3TDEzIDcuODc1QzEyLjc2NjcgOC4wNDE2NyAxMi41MzMzIDguMjU4MzMgMTIuMyA4LjUyNUMxMS44NSA5LjAwODMzIDExLjYyNSA5LjUgMTEuNjI1IDEwQzEyLjAwODMgMTAgMTIuMzMzMyAxMC4xNDE3IDEyLjYgMTAuNDI1QzEyLjg2NjcgMTAuNzA4MyAxMyAxMS4wNjY3IDEzIDExLjVDMTMgMTEuOTMzMyAxMi44NjY3IDEyLjI5MTcgMTIuNiAxMi41NzVDMTIuMzMzMyAxMi44NTgzIDEyLjAwODMgMTMgMTEuNjI1IDEzWiIgZmlsbD0iIzIyMjIyMiIvPgo8cmVjdCB4PSIxNSIgeT0iMTQiIHdpZHRoPSIxMSIgaGVpZ2h0PSIxIiBmaWxsPSIjMjIyMjIyIi8+CjxyZWN0IHg9IjYiIHk9IjE4IiB3aWR0aD0iMjAiIGhlaWdodD0iMSIgZmlsbD0iIzIyMjIyMiIvPgo8cmVjdCB4PSI2IiB5PSIyMiIgd2lkdGg9IjIwIiBoZWlnaHQ9IjEiIGZpbGw9IiMyMjIyMjIiLz4KPC9zdmc+Cg==';\nexport const codeIcon = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTEzLjQgMjAuNkw4LjggMTZMMTMuNCAxMS40TDEyIDEwTDYgMTZMMTIgMjJMMTMuNCAyMC42Wk0xOC42IDIwLjZMMjMuMiAxNkwxOC42IDExLjRMMjAgMTBMMjYgMTZMMjAgMjJMMTguNiAyMC42WiIgZmlsbD0iYmxhY2siLz4KPC9zdmc+Cg==';\nexport const lineIcon = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3QgeD0iNiIgeT0iMTUiIHdpZHRoPSIyMCIgaGVpZ2h0PSIyIiBmaWxsPSJibGFjayIvPgo8L3N2Zz4K';","import { ChangeDetectorRef, Component, Input, OnInit, ViewChild, HostListener, AfterViewInit } from '@angular/core';\n\nimport { map, take } from 'rxjs/operators';\nimport { MenuItem } from 'primeng/api';\n\nimport { SuggestionsService } from '../../services/suggestions/suggestions.service';\nimport { DotCMSContentlet } from '@dotcms/dotcms-models';\nimport { SuggestionListComponent } from '../suggestion-list/suggestion-list.component';\nimport { DomSanitizer, SafeUrl } from '@angular/platform-browser';\nimport { headerIcons, pIcon, ulIcon, olIcon, quoteIcon, codeIcon, lineIcon } from './suggestion-icons';\n\nexport interface SuggestionsCommandProps {\n    payload?: DotCMSContentlet;\n    type: { name: string; level?: number };\n}\n\nexport interface DotMenuItem extends Omit<MenuItem, 'icon'> {\n    icon: string | SafeUrl;\n}\n\n@Component({\n    selector: 'dotcms-suggestions',\n    templateUrl: './suggestions.component.html',\n    styleUrls: ['./suggestions.component.scss']\n})\nexport class SuggestionsComponent implements OnInit, AfterViewInit {\n    @ViewChild('list', { static: false }) list: SuggestionListComponent;\n\n    @Input() onSelection: (props: SuggestionsCommandProps) => void;\n    items: DotMenuItem[] = [];\n\n    title = 'Select a block';\n    mouseMove = true;\n\n    @HostListener('mousemove', ['$event'])\n    onMousemove() {\n        this.mouseMove = true;\n    }\n\n    constructor(\n        private suggestionsService: SuggestionsService,\n        private cd: ChangeDetectorRef,\n        private domSanitizer: DomSanitizer\n    ) {}\n\n    ngOnInit(): void {\n        const headings = [...Array(3).keys()].map((level) => {\n            const size = level + 1;\n            return {\n                label: `Heading ${size}`,\n                icon: this.sanitizeUrl(headerIcons[level]),\n                command: () => {\n                    this.onSelection({\n                        type: {\n                            name: 'heading',\n                            level: level + 1\n                        }\n                    });\n                }\n            };\n        });\n\n        const paragraph = [\n            {\n                label: 'Paragraph',\n                icon: this.sanitizeUrl(pIcon),\n                command: () => {\n                    this.onSelection({\n                        type: {\n                            name: 'paragraph'\n                        }\n                    });\n                }\n            }\n        ];\n\n        const list = [\n            {\n                label: 'List Ordered',\n                icon: this.sanitizeUrl(olIcon),\n                command: () => {\n                    this.onSelection({\n                        type: {\n                            name: 'listOrdered'\n                        }\n                    });\n                }\n            },\n            {\n                label: 'List Unordered',\n                icon: this.sanitizeUrl(ulIcon),\n                command: () => {\n                    this.onSelection({\n                        type: {\n                            name: 'listUnordered'\n                        }\n                    });\n                }\n            }\n        ];\n\n        const block = [\n            {\n                label: 'Blockquote',\n                icon: this.sanitizeUrl(quoteIcon),\n                command: () => {\n                    this.onSelection({\n                        type: {\n                            name: 'blockQuote'\n                        }\n                    });\n                }\n            },\n            {\n                label: 'Code Block',\n                icon: this.sanitizeUrl(codeIcon),\n                command: () => {\n                    this.onSelection({\n                        type: {\n                            name: 'codeBlock'\n                        }\n                    });\n                }\n            },\n            {\n                label: 'Horizontal Line',\n                icon: this.sanitizeUrl(lineIcon),\n                command: () => {\n                    this.onSelection({\n                        type: {\n                            name: 'horizontalLine'\n                        }\n                    });\n                }\n            }\n        ];\n\n        this.items = [\n            {\n                label: 'Contentlets',\n                icon: 'receipt',\n                command: () => {\n                    this.initContentletSelection();\n                }\n            },\n            ...headings,\n            ...paragraph,\n            ...list,\n            ...block\n        ];\n\n    }\n\n    ngAfterViewInit() {\n        this.setFirstItemActive();\n\n    }\n\n    /**\n     * Execute the item command\n     *\n     * @memberof SuggestionsComponent\n     */\n    execCommand() {\n        this.list.execCommand();\n    }\n\n    /**\n     * Update the current item selected\n     *\n     * @param {KeyboardEvent} e\n     * @memberof SuggestionsComponent\n     */\n    updateSelection(e: KeyboardEvent) {\n        this.list.updateSelection(e);\n        this.mouseMove = false;\n    }\n\n    /**\n     * Set the first item active\n     *\n     * @memberof SuggestionsComponent\n     */\n    setFirstItemActive() {\n        this.list.setFirstItemActive();\n    }\n\n    /**\n     * Reset the key manager after we add new elements to the list\n     *\n     * @memberof SuggestionsComponent\n     */\n    resetKeyManager() {\n        this.list.resetKeyManager();\n    }\n\n\n    /**\n     * Avoid closing the suggestions on manual scroll\n     *\n     * @param {MouseEvent} e\n     * @memberof SuggestionsComponent\n     */\n    onMouseDownHandler(e: MouseEvent) {\n        e.preventDefault();\n    }\n\n    /**\n     * Handle the active item on menu events\n     *\n     * @param {MouseEvent} e\n     * @memberof SuggestionsComponent\n     */\n    onMouseEnter(e: MouseEvent) {\n        // If mouse does not move then leave the function.\n        if (!this.mouseMove) {\n            return;\n        }\n        e.preventDefault();\n        const index = Number((e.target as HTMLElement).dataset.index);\n        this.list.updateActiveItem(index);\n    }\n\n    /**\n     * Execute the item command on mouse down\n     *\n     * @param {MouseEvent} e\n     * @param {MenuItem} item\n     * @memberof SuggestionsComponent\n     */\n    onMouseDown(e: MouseEvent, item: MenuItem) {\n        e.preventDefault();\n        item.command();\n    }\n\n    /**\n     * Go back to contentlet selection\n     *\n     * @param {MouseEvent} event\n     * @memberof SuggestionsComponent\n     */\n    handleBackButton(event: MouseEvent): void {\n        event.preventDefault();\n        event.stopPropagation();\n        this.initContentletSelection();\n    }\n\n    private initContentletSelection() {\n        this.suggestionsService\n            .getContentTypes()\n            .pipe(\n                map((items) => {\n                    return items.map((item) => {\n                        return {\n                            label: item.name,\n                            icon: item.icon,\n                            command: () => {\n                                this.suggestionsService\n                                    .getContentlets(item.variable)\n                                    .pipe(take(1))\n                                    .subscribe((contentlets) => {\n                                        this.items = contentlets.map((contentlet) => {\n                                            return {\n                                                label: contentlet.title,\n                                                icon: 'image',\n                                                command: () => {\n                                                    this.onSelection({\n                                                        payload: contentlet,\n                                                        type: {\n                                                            name: 'dotContent'\n                                                        }\n                                                    });\n                                                }\n                                            };\n                                        });\n\n                                        if (this.items.length) {\n                                            this.title = 'Select a contentlet';\n                                            this.cd.detectChanges();\n                                            this.resetKeyManager();\n                                        } else {\n                                            this.title = `No results for <b>${item.name}</b>`;\n                                            this.cd.detectChanges();\n                                        }\n                                    });\n                            }\n                        };\n                    });\n                }),\n                take(1)\n            )\n            .subscribe((items) => {\n                this.title = 'Select a content type';\n                this.items = items;\n                this.cd.detectChanges();\n                this.resetKeyManager();\n            });\n    }\n\n    private sanitizeUrl(url: string): SafeUrl {\n        return this.domSanitizer.bypassSecurityTrustUrl(url);\n    }\n}\n","import { Component } from '@angular/core';\n\n@Component({\n    selector: 'dotcms-action-button',\n    templateUrl: './action-button.component.html',\n    styleUrls: ['./action-button.component.scss']\n})\nexport class ActionButtonComponent {\n}\n","import { Injectable } from '@angular/core';\n/**\n * Encapsulate string utils methods.\n */\n@Injectable()\nexport class StringUtils {\n    /**\n     * Get from text, the line number (indexLine), null if it does not exists.\n     * @param text\n     * @param indexLine\n     * @returns string\n     */\n    getLine(text: string, indexLine: number): string {\n        let line: string = null;\n\n        if (text) {\n            const lines = text.split('\\n');\n            line = lines && lines.length > indexLine ? lines[indexLine] : null;\n        }\n\n        return line;\n    } // getLine.\n\n    /**\n     * Get an string and return it camelcased, ex: \"Hello World\" > \"helloWorld\"\n     * @param str\n     * @returns string\n     */\n    camelize(str): string {\n        return str\n            .replace(/(?:^\\w|[A-Z]|\\b\\w)/g, (letter, index) => {\n                return index === 0 ? letter.toLowerCase() : letter.toUpperCase();\n            })\n            .replace(/\\s+/g, '');\n    }\n\n    /**\n     * Return a string with the first char in uppercase\n     *\n     * @param string str\n     * @returns string\n     *\n     * @memberof StringUtils\n     */\n    titleCase(str: string): string {\n        return `${str.charAt(0).toLocaleUpperCase()}${str.slice(1)}`;\n    }\n} // E:O:F:StringUtils.\n","// The file contents for the current environment will overwrite these during build.\n// The build system defaults to the dev environment which uses `environment.ts`, but if you do\n// `ng build --env=prod` then `environment.prod.ts` will be used instead.\n// The list of which env maps to which file can be found in `.angular-cli.json`.\n\nexport const environment = {\n    production: false\n};\n","/**\n * Created by oswaldogallango on 9/27/16.\n */\n\nexport class HttpRequestUtils {\n    /**\n     * Get a map with the url querystring parameters\n     * @returns Map<string, string>\n     */\n    // TODO: change the getQueryParams() with an NG2 method equivalent to QueryParams on NGRX.\n    getQueryParams(): Map<string, string> {\n        const split: string[] = window.location.search.substring(1).split('&');\n        const map: Map<string, string> = new Map();\n\n        split.forEach((param) => {\n            const paramSplit: string[] = param.split('=');\n            map.set(paramSplit[0], paramSplit[1]);\n        });\n\n        return map;\n    }\n\n    /**\n     * Get a single parameter form the query string, null if does not exits.\n     * it is based on the window.location.href.\n     * @returns string\n     */\n    getQueryStringParam(name: string): string {\n        let value = null;\n        const regex = new RegExp('[?&]' + name.replace(/[\\[\\]]/g, '\\\\$&') + '(=([^&#]*)|&|#|$)');\n        const results = regex.exec(window.location.href);\n\n        if (results && results[2]) {\n            value = decodeURIComponent(results[2].replace(/\\+/g, ' '));\n        }\n\n        return value;\n    } // getQueryStringParam.\n}\n","import { Injectable } from '@angular/core';\nimport { StringUtils } from './string-utils.service';\nimport { environment } from '../environments/environment';\nimport { HttpRequestUtils } from './util/http-request-utils';\nconst DEV_MODE_PARAM = 'devMode';\n\n/**\n * LoggerService to log.  Allows logger to be changed at runtime\n * To set the logger level in the console run logger.level=logger.Level.DEBUG\n */\n@Injectable()\nexport class LoggerService {\n    private showLogs = true;\n    private httpRequestUtils: HttpRequestUtils;\n\n    constructor(private stringUtils: StringUtils) {\n        this.httpRequestUtils = new HttpRequestUtils();\n        this.showLogs = this.shouldShowLogs();\n\n        if (this.showLogs) {\n            console.info('Setting the logger --> Developer mode logger on');\n        }\n    }\n\n    info(message?: any, ...optionalParams: any[]): void {\n        if (optionalParams && optionalParams.length > 0) {\n            console.info(this.wrapMessage(message), optionalParams);\n        } else {\n            console.info(this.wrapMessage(message));\n        }\n    }\n\n    error(message?: any, ...optionalParams: any[]): void {\n        if (optionalParams && optionalParams.length > 0) {\n            console.error(this.wrapMessage(message), optionalParams);\n        } else {\n            console.error(this.wrapMessage(message));\n        }\n    }\n\n    warn(message?: any, ...optionalParams: any[]): void {\n        if (optionalParams && optionalParams.length > 0) {\n            console.warn(this.wrapMessage(message), optionalParams);\n        } else {\n            console.warn(this.wrapMessage(message));\n        }\n    }\n\n    debug(message?: any, ...optionalParams: any[]): void {\n        if (optionalParams && optionalParams.length > 0) {\n            console.debug(this.wrapMessage(message), optionalParams);\n        } else {\n            console.debug(this.wrapMessage(message));\n        }\n    }\n\n    /**\n     * Determine if angular should show lo\n     * @returns boolean\n     */\n    shouldShowLogs(): boolean {\n        const devMode: string = this.httpRequestUtils.getQueryStringParam(DEV_MODE_PARAM);\n        return !environment.production || devMode === 'on';\n    } // isProduction.\n\n    private wrapMessage(message?: any): string {\n        // on prod, we do not attach the caller.\n        return this.showLogs ? message : this.getCaller() + '>> ' + message;\n    }\n    private getCaller(): string {\n        let caller = 'unknown';\n        try {\n            throw new Error();\n        } catch (e) {\n            caller = this.cleanCaller(this.stringUtils.getLine(e.stack, 4));\n        }\n        return caller;\n    }\n\n    private cleanCaller(caller: string): string {\n        return caller ? caller.trim().substr(3) : 'unknown';\n    }\n}\n","import { Injectable, Inject, LOCALE_ID } from '@angular/core';\nimport { LoggerService } from '../logger.service';\n\n@Injectable()\nexport class UserModel {\n    username: string;\n    password: string;\n    locale: string;\n    suppressAlerts = false;\n\n    constructor(private loggerService: LoggerService, @Inject(LOCALE_ID) localeId: string) {\n        this.locale = localeId; // default to 'en-US'\n        try {\n            const url = window.location.search.substring(1);\n            this.locale = this.checkQueryForUrl(url);\n        } catch (e) {\n            this.loggerService.error('Could not set locale from URL.');\n        }\n    }\n\n    checkQueryForUrl(locationQuery: string): string {\n        let locale = this.locale;\n        if (locationQuery && locationQuery.length) {\n            const q = locationQuery;\n            const token = 'locale=';\n            const idx = q.indexOf(token);\n            if (idx >= 0) {\n                let end = q.indexOf('&', idx);\n                end = end !== -1 ? end : q.indexOf('#', idx);\n                end = end !== -1 ? end : q.length;\n                locale = q.substring(idx + token.length, end);\n            }\n        }\n        return locale;\n    }\n}\n","import { Injectable } from '@angular/core';\nimport { UserModel } from './shared/user.model';\nimport { LoggerService } from './logger.service';\n\n@Injectable()\nexport class ApiRoot {\n    siteId = '48190c8c-42c4-46af-8d1a-0cd5db894797';\n    authUser: UserModel;\n    hideFireOn = false;\n    hideRulePushOptions = false;\n\n    static parseQueryParam(query: string, token: string): string {\n        let idx = -1;\n        let result = null;\n        token = token + '=';\n        if (query && query.length) {\n            idx = query.indexOf(token);\n        }\n        if (idx >= 0) {\n            let end = query.indexOf('&', idx);\n            end = end !== -1 ? end : query.length;\n            result = query.substring(idx + token.length, end);\n        }\n\n        return result;\n    }\n\n    constructor(authUser: UserModel, private loggerService: LoggerService) {\n        this.authUser = authUser;\n\n        try {\n            let query = document.location.search.substring(1);\n            if (query === '') {\n                if (document.location.hash.indexOf('?') >= 0) {\n                    query = document.location.hash.substr(document.location.hash.indexOf('?') + 1);\n                }\n            }\n            const siteId = ApiRoot.parseQueryParam(query, 'realmId');\n            if (siteId) {\n                this.siteId = siteId;\n                this.loggerService.debug('Site Id set to ', this.siteId);\n            }\n            const hideFireOn = ApiRoot.parseQueryParam(query, 'hideFireOn');\n            if (hideFireOn) {\n                this.hideFireOn = hideFireOn === 'true' || hideFireOn === '1';\n                this.loggerService.debug('hideFireOn set to ', this.hideFireOn);\n            }\n\n            const hideRulePushOptions = ApiRoot.parseQueryParam(query, 'hideRulePushOptions');\n            if (hideRulePushOptions) {\n                this.hideRulePushOptions =\n                    hideRulePushOptions === 'true' || hideRulePushOptions === '1';\n                this.loggerService.debug('hideRulePushOptions set to ', this.hideRulePushOptions);\n            }\n\n            this.configureUser(query, authUser);\n        } catch (e) {\n            this.loggerService.error('Could not set baseUrl automatically.', e);\n        }\n    }\n\n    private configureUser(query: string, user: UserModel): void {\n        user.suppressAlerts = ApiRoot.parseQueryParam(query, 'suppressAlerts') === 'true';\n    }\n}\n","import { Injectable } from '@angular/core';\n/**\n * Check if the browser is ie11\n *\n * @export\n * @class BrowserUtil\n * @deprecated We don't support IE11 anymore\n */\n@Injectable()\nexport class BrowserUtil {\n    public isIE11(): boolean {\n        return navigator.appName === 'Netscape' && navigator.appVersion.indexOf('Trident') !== -1;\n    }\n}\n","export enum HttpCode {\n    BAD_REQUEST = 400,\n    FORBIDDEN = 403,\n    NOT_FOUND = 404,\n    NO_CONTENT = 204,\n    SERVER_ERROR = 500,\n    UNAUTHORIZED = 401\n}\n","import { HttpCode } from './http-code';\nimport { HttpRequest, HttpErrorResponse, HttpResponse } from '@angular/common/http';\n\nexport const NETWORK_CONNECTION_ERROR = 1;\nexport const UNKNOWN_RESPONSE_ERROR = 2;\nexport const SERVER_RESPONSE_ERROR = 3;\nexport const CLIENTS_ONLY_MESSAGES = {\n    1: 'Could not connect to server.'\n};\n\nexport class CwError {\n    constructor(\n        public code: number,\n        public message: string,\n        public request?: HttpRequest<any>,\n        public response?: HttpErrorResponse,\n        public source?: any\n    ) {}\n}\n\nexport interface ResponseError {\n    response: HttpResponse<any>;\n    msg: string;\n}\n\nexport function isSuccess(resp: HttpResponse<any>): boolean {\n    return resp.status > 199 && resp.status < 300;\n}\n\nexport function hasContent(resp: HttpResponse<any>): boolean {\n    return isSuccess(resp) && resp.status !== HttpCode.NO_CONTENT;\n}\n","import { HttpResponse, HttpHeaders } from '@angular/common/http';\nimport { DotCMSResponse } from '../core-web.service';\n\n/**\n *\n *\n * <code>\n * {\n *   \"errors\":[],\n *   \"entity\":{},\n *   \"messages\":[],\n *   \"i18nMessagesMap\":{}\n * }\n * </code>\n */\nexport class ResponseView<T = any> {\n    private bodyJsonObject: DotCMSResponse<T>;\n    private headers: HttpHeaders;\n\n    public constructor(private resp: HttpResponse<DotCMSResponse<T>>) {\n        try {\n            this.bodyJsonObject = resp.body;\n            this.headers = resp.headers;\n        } catch (e) {\n            this.bodyJsonObject = null;\n        }\n    }\n\n    public header(headerName: string): string {\n        return this.headers.get(headerName);\n    }\n\n    get i18nMessagesMap(): { [key: string]: string } {\n        return this.bodyJsonObject.i18nMessagesMap;\n    }\n\n    get contentlets(): T {\n        return this.bodyJsonObject.contentlets;\n    }\n\n    get entity(): T {\n        return this.bodyJsonObject.entity;\n    }\n\n    get tempFiles(): T {\n        return this.bodyJsonObject.tempFiles;\n    }\n\n    get errorsMessages(): string {\n        let errorMessages = '';\n\n        if (this.bodyJsonObject.errors) {\n            this.bodyJsonObject.errors.forEach((e: any) => {\n                errorMessages += e.message;\n            });\n        } else {\n            errorMessages = this.bodyJsonObject.messages.toString();\n        }\n\n        return errorMessages;\n    }\n\n    get status(): number {\n        return this.resp.status;\n    }\n\n    get response(): HttpResponse<DotCMSResponse<T>> {\n        return this.resp;\n    }\n\n    public existError(errorCode: string): boolean {\n        return (\n            this.bodyJsonObject.errors &&\n            this.bodyJsonObject.errors.filter((e: any) => e.errorCode === errorCode).length > 0\n        );\n    }\n}\n","import { Injectable } from '@angular/core';\nimport { Subject, Observable, throwError } from 'rxjs';\nimport { map, catchError, filter } from 'rxjs/operators';\n\nimport {\n    CwError,\n    NETWORK_CONNECTION_ERROR,\n    UNKNOWN_RESPONSE_ERROR,\n    CLIENTS_ONLY_MESSAGES,\n    SERVER_RESPONSE_ERROR\n} from './util/http-response-util';\nimport { ResponseView } from './util/response-view';\nimport { LoggerService } from './logger.service';\nimport { HttpCode } from './util/http-code';\nimport { Router } from '@angular/router';\nimport {\n    HttpClient,\n    HttpRequest,\n    HttpHeaders,\n    HttpParams,\n    HttpResponse,\n    HttpEventType,\n    HttpEvent,\n    HttpErrorResponse\n} from '@angular/common/http';\n\nexport interface DotCMSResponse<T> {\n    contentlets?: T;\n    entity?: T;\n    tempFiles?: T; // /api/v1/temp don't have entity\n    errors: string[];\n    i18nMessagesMap: { [key: string]: string };\n    messages: string[];\n    permissions: string[];\n}\n\nexport interface DotRequestOptionsArgs {\n    url: string;\n    body?:\n        | {\n              [key: string]: any;\n          }\n        | string;\n    method?: string;\n    params?: {\n        [key: string]: any;\n    };\n    headers?: {\n        [key: string]: any;\n    };\n}\n\n@Injectable()\nexport class CoreWebService {\n    private httpErrosSubjects: Subject<any>[] = [];\n\n    constructor(\n        private loggerService: LoggerService,\n        private router: Router,\n        private http: HttpClient\n    ) {}\n\n    /**\n     *\n     * Request data from dotCMS endpoints\n     *\n     * @template T\n     * @param {DotRequestOptionsArgs} options\n     * @return {*}  {Observable<HttpResponse<any>>}\n     * @memberof CoreWebService\n     * @deprecated\n     */\n    request<T>(options: DotRequestOptionsArgs): Observable<HttpResponse<T | unknown> | T> {\n        if (!options.method) {\n            options.method = 'GET';\n        }\n\n        const request = this.getRequestOpts(options);\n        const source = options.body;\n\n        return this.http.request(request).pipe(\n            filter(\n                (event: HttpEvent<HttpResponse<DotCMSResponse<T>> | any>) =>\n                    event.type === HttpEventType.Response\n            ),\n            map((resp: HttpResponse<DotCMSResponse<T>>) => {\n                // some endpoints have empty body.\n                try {\n                    return resp.body;\n                } catch (error) {\n                    return resp;\n                }\n            }),\n            catchError(\n                (response: HttpErrorResponse, _original: Observable<any>): Observable<any> => {\n                    if (response) {\n                        this.emitHttpError(response.status);\n\n                        if (\n                            response.status === HttpCode.SERVER_ERROR ||\n                            response.status === HttpCode.FORBIDDEN\n                        ) {\n                            if (\n                                response.statusText &&\n                                response.statusText.indexOf('ECONNREFUSED') >= 0\n                            ) {\n                                throw new CwError(\n                                    NETWORK_CONNECTION_ERROR,\n                                    CLIENTS_ONLY_MESSAGES[NETWORK_CONNECTION_ERROR],\n                                    request,\n                                    response,\n                                    source\n                                );\n                            } else {\n                                throw new CwError(\n                                    SERVER_RESPONSE_ERROR,\n                                    response.error.message,\n                                    request,\n                                    response,\n                                    source\n                                );\n                            }\n                        } else if (response.status === HttpCode.NOT_FOUND) {\n                            this.loggerService.error(\n                                'Could not execute request: 404 path not valid.',\n                                options.url\n                            );\n                            throw new CwError(\n                                UNKNOWN_RESPONSE_ERROR,\n                                response.headers.get('error-message'),\n                                request,\n                                response,\n                                source\n                            );\n                        }\n                    }\n                    return null;\n                }\n            )\n        );\n    }\n\n    /**\n     * Return a response adapted to the follow json format:\n     *\n     * <code>\n     * {\n     *   \"errors\":[],\n     *   \"entity\":{},\n     *   \"messages\":[],\n     *   \"i18nMessagesMap\":{}\n     * }\n     * </code>\n     *\n     * @RequestOptionsArgs options\n     * @returns Observable<ResponseView>\n     */\n    requestView<T = any>(options: DotRequestOptionsArgs): Observable<ResponseView<T>> {\n        if (!options.method) {\n            options.method = 'GET';\n        }\n\n        let request;\n\n        if (options.body) {\n            if (typeof options.body === 'string') {\n                request = this.getRequestOpts<string>(options);\n            } else {\n                request = this.getRequestOpts<{ [key: string]: any }>(options);\n            }\n        } else {\n            request = this.getRequestOpts(options);\n        }\n\n        return this.http.request(request).pipe(\n            filter(\n                (event: HttpEvent<HttpResponse<DotCMSResponse<T>> | any>) =>\n                    event.type === HttpEventType.Response\n            ),\n            map((resp: HttpResponse<DotCMSResponse<T>>) => {\n                if (resp.body && resp.body.errors && resp.body.errors.length > 0) {\n                    return this.handleRequestViewErrors<T>(resp);\n                } else {\n                    return new ResponseView<T>(resp);\n                }\n            }),\n            catchError((err: HttpErrorResponse) => {\n                this.emitHttpError(err.status);\n                return throwError(this.handleResponseHttpErrors(err));\n            })\n        );\n    }\n\n    /**\n     * Emit to the subscriber when the request fail\n     *\n     * @param {number} httpErrorCode\n     * @returns {Observable<number>}\n     * @memberof CoreWebService\n     */\n    subscribeToHttpError(httpErrorCode: number): Observable<void> {\n        if (!this.httpErrosSubjects[httpErrorCode]) {\n            this.httpErrosSubjects[httpErrorCode] = new Subject();\n        }\n\n        return this.httpErrosSubjects[httpErrorCode].asObservable();\n    }\n\n    private handleRequestViewErrors<T>(resp: HttpResponse<DotCMSResponse<T>>): ResponseView<T> {\n        if (resp.status === 401) {\n            this.router.navigate(['/public/login']);\n        }\n\n        return new ResponseView<T>(resp);\n    }\n\n    private handleResponseHttpErrors(resp: HttpErrorResponse): HttpErrorResponse {\n        if (resp.status === 401) {\n            this.router.navigate(['/public/login']);\n        }\n\n        return resp;\n    }\n\n    private emitHttpError(status: number): void {\n        if (this.httpErrosSubjects[status]) {\n            this.httpErrosSubjects[status].next();\n        }\n    }\n\n    private getRequestOpts<T>(options: DotRequestOptionsArgs): HttpRequest<T> {\n        const headers = this.getHttpHeaders(options.headers);\n        const params = this.getHttpParams(options.params);\n        const url = this.getFixedUrl(options.url);\n        const body = <T>options.body || null;\n\n        if (\n            options.method === 'POST' ||\n            options.method === 'PUT' ||\n            options.method === 'PATCH' ||\n            options.method === 'DELETE'\n        ) {\n            return new HttpRequest<T>(options.method, url, body, {\n                headers,\n                params\n            });\n        }\n\n        const method = <'GET' | 'HEAD' | 'JSONP' | 'OPTIONS'>options.method;\n        return new HttpRequest<T>(method, url, {\n            headers,\n            params\n        });\n    }\n\n    private getHttpHeaders(headers: { [key: string]: string }): HttpHeaders {\n        let httpHeaders = this.getDefaultRequestHeaders();\n\n        if (headers && Object.keys(headers).length) {\n            Object.keys(headers).forEach((key) => {\n                httpHeaders = httpHeaders.set(key, headers[key]);\n            });\n\n            // If Content-Type == 'multipart/form-data' we need to remove Content-Type,\n            // otherwise \"boundary\" will not be added to Content-Type in the Header\n            if (headers['Content-Type'] === 'multipart/form-data') {\n                httpHeaders = httpHeaders.delete('Content-Type');\n            }\n        }\n        return httpHeaders;\n    }\n\n    private getFixedUrl(url: string): string {\n        if (url?.startsWith('api')) {\n            return `/${url}`;\n        }\n\n        const version = url ? url.split('/')[0] : '';\n        if (version.match(/v[1-9]/g)) {\n            return `/api/${url}`;\n        }\n        return url;\n    }\n\n    private getHttpParams(params: { [key: string]: any }): HttpParams {\n        if (params && Object.keys(params).length) {\n            let httpParams = new HttpParams();\n\n            Object.keys(params).forEach((key: string) => {\n                httpParams = httpParams.set(key, params[key]);\n            });\n            return httpParams;\n        }\n\n        return null;\n    }\n\n    private getDefaultRequestHeaders(): HttpHeaders {\n        const headers = new HttpHeaders()\n            .set('Accept', '*/*')\n            .set('Content-Type', 'application/json');\n        return headers;\n    }\n}\n","import { Injectable } from '@angular/core';\nimport { Observable, Subject } from 'rxjs';\nimport { DotPushPublishDialogData } from '@dotcms/dotcms-models';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class DotPushPublishDialogService {\n    private data: Subject<DotPushPublishDialogData> = new Subject<DotPushPublishDialogData>();\n\n    get showDialog$(): Observable<DotPushPublishDialogData> {\n        return this.data.asObservable();\n    }\n\n    open(data: DotPushPublishDialogData): void {\n        this.data.next(data);\n    }\n}\n","import { Injectable } from '@angular/core';\nimport { Router } from '@angular/router';\n/**\n * Router service with common routing methods\n *\n * @export\n * @class DotRouterService\n * @deprecated Please use @services/dot-router/dot-router.service\n */\n@Injectable()\nexport class DotRouterService {\n    constructor(private router: Router) {}\n\n    public goToMain(): void {\n        this.router.navigate(['/c']);\n    }\n\n    public goToLogin(parameters?: any): void {\n        this.router.navigate(['/public/login'], parameters);\n    }\n\n    public goToURL(url: string): void {\n        this.router.navigate([url]);\n    }\n\n    public isPublicUrl(url: string): boolean {\n        return url.startsWith('/public');\n    }\n\n    public isFromCoreUrl(url: string): boolean {\n        return url.startsWith('/fromCore');\n    }\n\n    public isRootUrl(url: string): boolean {\n        return url === '/';\n    }\n\n    public gotoPortlet(portletId: string): void {\n        this.router.navigate([`c/${portletId.replace(' ', '_')}`]);\n    }\n\n    public goToForgotPassword(): void {\n        this.router.navigate(['/public/forgotPassword']);\n    }\n\n    public goToNotLicensed(): void {\n        this.router.navigate(['c/notLicensed']);\n    }\n}\n","import { CoreWebService } from './core-web.service';\nimport { Injectable } from '@angular/core';\nimport { Observable, BehaviorSubject } from 'rxjs';\nimport { pluck, filter, map, take } from 'rxjs/operators';\nimport { LoggerService } from './logger.service';\nimport { Menu } from './routing.service';\n\n/**\n * Created by josecastro on 7/29/16.\n *\n * Wraps the configuration properties for dotCMS in order to provide an\n * easier way to access the information.\n *\n */\nconst DOTCMS_WEBSOCKET_RECONNECT_TIME = 'dotcms.websocket.reconnect.time';\nconst DOTCMS_DISABLE_WEBSOCKET_PROTOCOL = 'dotcms.websocket.disable';\nconst DOTCMS_PAGINATOR_ROWS = 'dotcms.paginator.rows';\nconst DOTCMS_PAGINATOR_LINKS = 'dotcms.paginator.links';\nconst EMAIL_REGEX = 'emailRegex';\n\nexport interface DotUiColors {\n    primary: string;\n    secondary: string;\n    background: string;\n}\n\nexport interface ConfigParams {\n    colors: DotUiColors;\n    emailRegex: string;\n    license: {\n        displayServerId: string;\n        isCommunity: boolean;\n        level: number;\n        levelName: string;\n    };\n    logos: {\n        loginScreen: string;\n        navBar: string;\n    };\n    menu: Menu[];\n    paginatorLinks: number;\n    paginatorRows: number;\n    releaseInfo: {\n        buildDate: string;\n        version: string;\n    };\n    websocket: WebSocketConfigParams;\n}\n\nexport interface WebSocketConfigParams {\n    disabledWebsockets: boolean;\n    websocketReconnectTime: number;\n}\n\nexport interface DotTimeZone {\n    id: string;\n    label: string;\n    offset: string;\n}\n\n@Injectable()\nexport class DotcmsConfigService {\n    private configParamsSubject: BehaviorSubject<ConfigParams> = new BehaviorSubject(null);\n    private configUrl: string;\n\n    /**\n     * Initializes this class with the dotCMS core configuration parameters.\n     *\n     * @param configParams - The configuration properties for the current instance.\n     */\n    constructor(private coreWebService: CoreWebService, private loggerService: LoggerService) {\n        this.configUrl = 'v1/appconfiguration';\n        this.loadConfig();\n    }\n\n    getConfig(): Observable<ConfigParams> {\n        return this.configParamsSubject\n            .asObservable()\n            .pipe(filter((config: ConfigParams) => !!config));\n    }\n\n    loadConfig(): void {\n        this.loggerService.debug('Loading configuration on: ', this.configUrl);\n\n        this.coreWebService\n            .requestView({\n                url: this.configUrl\n            })\n            .pipe(pluck('entity'))\n            .subscribe((res: any) => {\n                this.loggerService.debug('Configuration Loaded!', res);\n\n                const configParams: ConfigParams = {\n                    colors: res.config.colors,\n                    emailRegex: res.config[EMAIL_REGEX],\n                    license: res.config.license,\n                    logos: res.config.logos,\n                    menu: res.menu,\n                    paginatorLinks: res.config[DOTCMS_PAGINATOR_LINKS],\n                    paginatorRows: res.config[DOTCMS_PAGINATOR_ROWS],\n                    releaseInfo: {\n                        buildDate: res.config.releaseInfo?.buildDate,\n                        version: res.config.releaseInfo?.version\n                    },\n                    websocket: {\n                        websocketReconnectTime:\n                            res.config.websocket[DOTCMS_WEBSOCKET_RECONNECT_TIME],\n                        disabledWebsockets: res.config.websocket[DOTCMS_DISABLE_WEBSOCKET_PROTOCOL]\n                    }\n                };\n\n                this.configParamsSubject.next(configParams);\n\n                this.loggerService.debug('this.configParams', configParams);\n\n                return res;\n            });\n    }\n\n    /**\n     * Return a list of timezones.\n     * @returns Observable<DotTimeZone[]>\n     * @memberof DotcmsConfigService\n     */\n    getTimeZones(): Observable<DotTimeZone[]> {\n        return this.coreWebService\n            .requestView({\n                url: this.configUrl\n            })\n            .pipe(\n                pluck('entity', 'config', 'timezones'),\n                map((timezones: DotTimeZone[]) => {\n                    return timezones.sort((a: DotTimeZone, b: DotTimeZone) => {\n                        if (a.label > b.label) {\n                            return 1;\n                        }\n                        if (a.label < b.label) {\n                            return -1;\n                        }\n                        // a must be equal to b\n                        return 0;\n                    });\n                })\n            );\n    }\n\n    /**\n     * Return the system Timezone.\n     * @returns Observable<DotTimeZone[]>\n     * @memberof DotcmsConfigService\n     */\n    getSystemTimeZone(): Observable<DotTimeZone> {\n        return this.coreWebService\n            .requestView({\n                url: this.configUrl\n            })\n            .pipe(pluck('entity', 'config', 'systemTimezone'), take(1));\n    }\n}\n","import { Observable, Subject } from 'rxjs';\nimport { LoggerService } from '../logger.service';\n\nexport abstract class Protocol {\n    protected _open: Subject<any> = new Subject<any>();\n    protected _close: Subject<any> = new Subject<any>();\n    protected _message: Subject<any> = new Subject<any>();\n    protected _error: Subject<any> = new Subject<any>();\n\n    constructor(protected loggerService: LoggerService) {}\n\n    abstract connect(): void;\n    abstract close(): void;\n\n    message$(): Observable<any> {\n        return this._message.asObservable();\n    }\n\n    open$(): Observable<any> {\n        return this._open.asObservable();\n    }\n\n    close$(): Observable<any> {\n        return this._close.asObservable();\n    }\n\n    error$(): Observable<any> {\n        return this._error.asObservable();\n    }\n\n    reconnect(): void {\n        this.close();\n        setTimeout(() => {\n            this.connect();\n        }, 0);\n    }\n\n    destroy(): void {\n        this._open.complete();\n        this._close.complete();\n        this._message.complete();\n        this._error.complete();\n    }\n}\n","import { Subject } from 'rxjs';\nimport { LoggerService } from '../logger.service';\nimport { Protocol } from './protocol';\n\nenum WEB_SOCKET_PROTOCOL_CODE {\n    NORMAL_CLOSE_CODE = 1000,\n    GO_AWAY_CODE = 1001\n}\nexport class WebSocketProtocol extends Protocol {\n    dataStream: Subject<{}> = new Subject();\n    private socket: WebSocket;\n    private errorThrown: boolean;\n\n    constructor(private url: string, loggerService: LoggerService) {\n        super(loggerService);\n\n        const match = new RegExp('wss?://').test(url);\n        if (!match) {\n            throw new Error('Invalid url provided [' + url + ']');\n        }\n    }\n\n    connect(): void {\n        this.errorThrown = false;\n        this.loggerService.debug('Connecting with Web socket', this.url);\n\n        try {\n            this.socket = new WebSocket(this.url);\n\n            this.socket.onopen = (ev: Event) => {\n                this.loggerService.debug('Web socket connected', this.url);\n                this._open.next(ev);\n            };\n\n            this.socket.onmessage = (ev: MessageEvent) => {\n                this._message.next(JSON.parse(ev.data));\n            };\n\n            this.socket.onclose = (ev: CloseEvent) => {\n                if (!this.errorThrown) {\n                    if (ev.code === WEB_SOCKET_PROTOCOL_CODE.NORMAL_CLOSE_CODE) {\n                        this._close.next(ev);\n                        this._message.complete();\n                    } else {\n                        this._error.next(ev);\n                    }\n                }\n            };\n\n            this.socket.onerror = (ev: ErrorEvent) => {\n                this.errorThrown = true;\n                this._error.next(ev);\n            };\n        } catch (error) {\n            this.loggerService.debug('Web EventsSocket connection error', error);\n            this._error.next(error);\n        }\n    }\n\n    close(): void {\n        if (this.socket && this.socket.readyState !== 3) {\n            this.socket.close();\n        }\n    }\n}\n","import { Protocol } from './protocol';\nimport { LoggerService } from '../logger.service';\nimport { CoreWebService } from '../core-web.service';\nimport { pluck, take } from 'rxjs/operators';\n\nexport class LongPollingProtocol extends Protocol {\n    private isClosed = false;\n    private isAlreadyOpen = false;\n    private lastCallback: number;\n\n    constructor(\n        private url: string,\n        loggerService: LoggerService,\n        private coreWebService: CoreWebService\n    ) {\n        super(loggerService);\n    }\n\n    /**\n     * Connect to a Long Polling connection\n     */\n    connect(): void {\n        this.connectLongPooling();\n    }\n\n    /**\n     * Close the connection\n     */\n    close(): void {\n        this.loggerService.info('destroying long polling');\n        this.isClosed = true;\n        this.isAlreadyOpen = false;\n        this._close.next();\n    }\n\n    private getLastCallback(data): number {\n        this.lastCallback =\n            data.length > 0 ? data[data.length - 1].creationDate + 1 : this.lastCallback;\n        return this.lastCallback;\n    }\n\n    private connectLongPooling(lastCallBack?: number): void {\n        this.isClosed = false;\n        this.loggerService.info('Starting long polling connection');\n\n        this.coreWebService\n            .requestView({\n                url: this.url,\n                params: lastCallBack ? { lastCallBack: lastCallBack } : {}\n            })\n            .pipe(pluck('entity'), take(1))\n            .subscribe(\n                (data) => {\n                    this.loggerService.debug('new Events', data);\n                    this.triggerOpen();\n\n                    if (data instanceof Array) {\n                        data.forEach((message) => {\n                            this._message.next(message);\n                        });\n                    } else {\n                        this._message.next(data);\n                    }\n\n                    if (!this.isClosed) {\n                        this.connectLongPooling(this.getLastCallback(data));\n                    }\n                },\n                (e) => {\n                    this.loggerService.info('A error occur connecting through long polling');\n                    this._error.next(e);\n                }\n            );\n    }\n\n    private triggerOpen(): void {\n        if (!this.isAlreadyOpen) {\n            this._open.next(true);\n            this.isAlreadyOpen = true;\n        }\n    }\n}\n","/**\n * Represent a url to connect with a evend end point\n *\n * @export\n */\nexport class DotEventsSocketURL {\n    constructor(private url: string, private useSSL: boolean) {}\n\n    /**\n     * Return the web socket url to connect with the Event end point\n     *\n     * @returns string\n     * @memberof DotEventsSocketURL\n     */\n    public getWebSocketURL(): string {\n        return `${this.getWebSocketProtocol()}://${this.url}`;\n    }\n\n    /**\n     * Return the long polling url to connect with the Event end point\n     *\n     * @returns string\n     * @memberof DotEventsSocketURL\n     */\n    public getLongPoolingURL(): string {\n        return `${this.getHttpProtocol()}://${this.url}`;\n    }\n\n    private getWebSocketProtocol(): string {\n        return `${this.useSSL ? 'wss' : 'ws'}`;\n    }\n\n    private getHttpProtocol(): string {\n        return `${this.useSSL ? 'https' : 'http'}`;\n    }\n}\n","import { WebSocketProtocol } from './websockets-protocol';\nimport { Protocol } from './protocol';\nimport { LoggerService } from '../logger.service';\nimport { LongPollingProtocol } from './long-polling-protocol';\nimport { CoreWebService } from '../core-web.service';\nimport { ConfigParams, DotcmsConfigService, WebSocketConfigParams } from '../dotcms-config.service';\nimport { Subject, Observable } from 'rxjs';\nimport { DotEventsSocketURL } from './models/dot-event-socket-url';\nimport { DotEventMessage } from './models/dot-event-message';\nimport { Injectable } from '@angular/core';\nimport { tap, pluck } from 'rxjs/operators';\n\nenum ConnectionStatus {\n    NONE,\n    CONNECTING,\n    RECONNECTING,\n    CONNECTED,\n    CLOSED\n}\n\n/**\n * It is a socket to receive notifications when a event is tiggered by the server, first this try to stablish a web socket\n * connection if it fail then try to a Long polling connection instead.\n *\n * If the connection is lost in any point the it try to reconnect automaticatly after a time set by configuration parameters.\n *\n * @export\n */\n@Injectable()\nexport class DotEventsSocket {\n    private protocolImpl: Protocol;\n\n    private status: ConnectionStatus = ConnectionStatus.NONE;\n    private _message: Subject<DotEventMessage> = new Subject<DotEventMessage>();\n    private _open: Subject<boolean> = new Subject<boolean>();\n    private webSocketConfigParams: WebSocketConfigParams;\n\n    /**\n     * Initializes this service with the configuration properties that are\n     * necessary for opening the Websocket with the System Events end-point.\n     *\n     * @param dotcmsConfigService - The dotCMS configuration properties that include\n     * the Websocket parameters.\n     */\n    constructor(\n        private dotEventsSocketURL: DotEventsSocketURL,\n        private dotcmsConfigService: DotcmsConfigService,\n        private loggerService: LoggerService,\n        private coreWebService: CoreWebService\n    ) {}\n\n    /**\n     * Connect to a Event socket using  Web Socket protocol,\n     * if a Web Socket connection can be stablish then try again with a Long Polling connection.\n     *\n     * @returns Observable<ConfigParams>\n     * @memberof DotEventsSocket\n     */\n    connect(): Observable<ConfigParams> {\n        return this.init().pipe(\n            tap(() => {\n                this.status = ConnectionStatus.CONNECTING;\n                this.connectProtocol();\n            })\n        );\n    }\n\n    /**\n     * Destroy the Event socket\n     *\n     * @memberof DotEventsSocket\n     */\n    destroy(): void {\n        // On logout, meaning no authenticated user lets try to close the socket\n        if (this.protocolImpl) {\n            this.loggerService.debug('Closing socket');\n            this.status = ConnectionStatus.CLOSED;\n            this.protocolImpl.close();\n        }\n    }\n\n    /**\n     * Trigger when a message is received\n     *\n     * @returns Observable<DotEventMessage>\n     * @memberof DotEventsSocket\n     */\n    messages(): Observable<DotEventMessage> {\n        return this._message.asObservable();\n    }\n\n    /**\n     * Trigger when a connect is open\n     *\n     * @returns Observable<boolean>\n     * @memberof DotEventsSocket\n     */\n    open(): Observable<boolean> {\n        return this._open.asObservable();\n    }\n\n    /**\n     * Return true if the socket is connected otherwise return false\n     *\n     * @returns boolean\n     * @memberof DotEventsSocket\n     */\n    isConnected(): boolean {\n        return this.status === ConnectionStatus.CONNECTED;\n    }\n\n    private init(): Observable<any> {\n        return this.dotcmsConfigService.getConfig().pipe(\n            pluck('websocket'),\n            tap((webSocketConfigParams: WebSocketConfigParams) => {\n                this.webSocketConfigParams = webSocketConfigParams;\n                this.protocolImpl =\n                    this.isWebSocketsBrowserSupport() && !webSocketConfigParams.disabledWebsockets\n                        ? this.getWebSocketProtocol()\n                        : this.getLongPollingProtocol();\n            })\n        );\n    }\n\n    private connectProtocol(): void {\n        this.protocolImpl.open$().subscribe(() => {\n            this.status = ConnectionStatus.CONNECTED;\n            this._open.next(true);\n        });\n\n        this.protocolImpl.error$().subscribe(() => {\n            if (this.shouldTryWithLongPooling()) {\n                this.loggerService.info(\n                    'Error connecting with Websockets, trying again with long polling'\n                );\n\n                this.protocolImpl.destroy();\n                this.protocolImpl = this.getLongPollingProtocol();\n                this.connectProtocol();\n            } else {\n                setTimeout(() => {\n                    this.status = this.getAfterErrorStatus();\n                    this.protocolImpl.connect();\n                }, this.webSocketConfigParams.websocketReconnectTime);\n            }\n        });\n\n        this.protocolImpl.close$().subscribe((_event) => {\n            this.status = ConnectionStatus.CLOSED;\n        });\n\n        this.protocolImpl.message$().subscribe(\n            (res) => this._message.next(res),\n            (e) => this.loggerService.debug('Error in the System Events service: ' + e.message),\n            () => this.loggerService.debug('Completed')\n        );\n\n        this.protocolImpl.connect();\n    }\n\n    private getAfterErrorStatus(): ConnectionStatus {\n        return this.status === ConnectionStatus.CONNECTING\n            ? ConnectionStatus.CONNECTING\n            : ConnectionStatus.RECONNECTING;\n    }\n\n    private shouldTryWithLongPooling(): boolean {\n        return (\n            this.isWebSocketProtocol() &&\n            this.status !== ConnectionStatus.CONNECTED &&\n            this.status !== ConnectionStatus.RECONNECTING\n        );\n    }\n\n    private getWebSocketProtocol(): WebSocketProtocol {\n        return new WebSocketProtocol(this.dotEventsSocketURL.getWebSocketURL(), this.loggerService);\n    }\n\n    private getLongPollingProtocol(): LongPollingProtocol {\n        return new LongPollingProtocol(\n            this.dotEventsSocketURL.getLongPoolingURL(),\n            this.loggerService,\n            this.coreWebService\n        );\n    }\n\n    private isWebSocketsBrowserSupport(): boolean {\n        return 'WebSocket' in window || 'MozWebSocket' in window;\n    }\n\n    private isWebSocketProtocol(): boolean {\n        return this.protocolImpl instanceof WebSocketProtocol;\n    }\n}\n","import { Injectable } from '@angular/core';\nimport { Observable, Subscription } from 'rxjs';\nimport { LoggerService } from './logger.service';\nimport { Subject } from 'rxjs';\nimport { DotEventTypeWrapper } from './models';\nimport { DotEventsSocket } from './util/dot-event-socket';\nimport { DotEventMessage } from './util/models/dot-event-message';\nimport { switchMap } from 'rxjs/operators';\n\n@Injectable()\nexport class DotcmsEventsService {\n    private subjects = [];\n    private messagesSub: Subscription;\n\n    constructor(private dotEventsSocket: DotEventsSocket, private loggerService: LoggerService) {}\n\n    /**\n     * Close the socket\n     *\n     * @memberof DotcmsEventsService\n     */\n    destroy(): void {\n        this.dotEventsSocket.destroy();\n        this.messagesSub.unsubscribe();\n    }\n\n    /**\n     * Start the socket\n     *\n     * @memberof DotcmsEventsService\n     */\n    start(): void {\n        this.loggerService.debug('start DotcmsEventsService', this.dotEventsSocket.isConnected());\n        if (!this.dotEventsSocket.isConnected()) {\n            this.loggerService.debug('Connecting with socket');\n\n            this.messagesSub = this.dotEventsSocket\n                .connect()\n                .pipe(switchMap(() => this.dotEventsSocket.messages()))\n                .subscribe(\n                    ({ event, payload }: DotEventMessage) => {\n                        if (!this.subjects[event]) {\n                            this.subjects[event] = new Subject();\n                        }\n                        this.subjects[event].next(payload.data);\n                    },\n                    (e) => {\n                        this.loggerService.debug(\n                            'Error in the System Events service: ' + e.message\n                        );\n                    },\n                    () => {\n                        this.loggerService.debug('Completed');\n                    }\n                );\n        }\n    }\n\n    /**\n     * This method will be called by clients that want to receive notifications\n     * regarding incoming system events. The events they will receive will be\n     * based on the type of event clients register for.\n     *\n     * @memberof DotcmsEventsService\n     */\n    subscribeTo<T>(clientEventType: string): Observable<T> {\n        if (!this.subjects[clientEventType]) {\n            this.subjects[clientEventType] = new Subject<T>();\n        }\n\n        return this.subjects[clientEventType].asObservable();\n    }\n\n    /**\n     * Subscribe to multiple events from the DotCMS WebSocket\n     *\n     * @memberof DotcmsEventsService\n     */\n    subscribeToEvents<T>(clientEventTypes: string[]): Observable<DotEventTypeWrapper<T>> {\n        const subject: Subject<DotEventTypeWrapper<T>> = new Subject<DotEventTypeWrapper<T>>();\n\n        clientEventTypes.forEach((eventType: string) => {\n            this.subscribeTo(eventType).subscribe((data: T) => {\n                subject.next({\n                    data: data,\n                    name: eventType\n                });\n            });\n        });\n\n        return subject.asObservable();\n    }\n\n    /**\n     * Listen  when the socket is opened\n     *\n     * @returns Observable<boolean>\n     * @memberof DotcmsEventsService\n     */\n    open(): Observable<boolean> {\n        return this.dotEventsSocket.open();\n    }\n}\n","/**\n * Created by oswaldogallango on 7/11/16.\n */\nimport { CoreWebService } from './core-web.service';\nimport { Injectable } from '@angular/core';\nimport { Observable, Subject, of } from 'rxjs';\nimport { HttpCode } from './util/http-code';\nimport { pluck, tap, map } from 'rxjs/operators';\nimport { DotcmsEventsService } from './dotcms-events.service';\nimport { HttpResponse } from '@angular/common/http';\nimport { ResponseView } from './util/response-view';\nimport { DotLoginInformation } from '@dotcms/dotcms-models';\n\nexport interface DotLoginParams {\n    login: string;\n    password: string;\n    rememberMe: boolean;\n    language: string;\n    backEndLogin: boolean;\n}\n\nexport const LOGOUT_URL = '/dotAdmin/logout';\n\n/**\n * This Service get the server configuration to display in the login component\n * and execute the login and forgot password routines\n */\n@Injectable()\nexport class LoginService {\n    private _auth$: Subject<Auth> = new Subject<Auth>();\n    private _logout$: Subject<any> = new Subject<any>();\n    private _auth: Auth;\n    private _loginAsUsersList$: Subject<User[]>;\n    private country = '';\n    private lang = '';\n    private urls: Record<string, string>;\n\n    constructor(\n        private coreWebService: CoreWebService,\n        private dotcmsEventsService: DotcmsEventsService\n    ) {\n        this._loginAsUsersList$ = <Subject<User[]>>new Subject();\n        this.urls = {\n            changePassword: 'v1/changePassword',\n            getAuth: 'v1/authentication/logInUser',\n            loginAs: 'v1/users/loginas',\n            logout: 'v1/logout',\n            logoutAs: 'v1/users/logoutas',\n            recoverPassword: 'v1/forgotpassword',\n            serverInfo: 'v1/loginform',\n            userAuth: 'v1/authentication',\n            current: '/api/v1/users/current/'\n        };\n\n        // when the session is expired/destroyed\n        dotcmsEventsService.subscribeTo('SESSION_DESTROYED').subscribe(() => this.logOutUser());\n    }\n\n    /**\n     * Get current logged in user\n     *\n     * @return {*}  {Observable<CurrentUser>}\n     * @memberof LoginService\n     */\n    getCurrentUser(): Observable<CurrentUser> {\n        return this.coreWebService\n            .request<CurrentUser>({\n                url: this.urls.current\n            })\n            .pipe(\n                map((res: HttpResponse<CurrentUser>) => res)\n            ) as unknown as Observable<CurrentUser>;\n    }\n\n    get loginAsUsersList$(): Observable<User[]> {\n        return this._loginAsUsersList$.asObservable();\n    }\n\n    get auth$(): Observable<Auth> {\n        return this._auth$.asObservable();\n    }\n\n    get logout$(): Observable<any> {\n        return this._logout$.asObservable();\n    }\n\n    get auth(): Auth {\n        return this._auth;\n    }\n\n    get isLogin$(): Observable<boolean> {\n        if (!!this.auth && !!this.auth.user) {\n            return of(true);\n        }\n\n        return this.loadAuth().pipe(map((auth) => !!auth && !!auth.user));\n    }\n\n    /**\n     * Return the login status\n     *\n     * @return {*}  {Observable<Auth>}\n     * @memberof LoginService\n     */\n    loadAuth(): Observable<Auth> {\n        return this.coreWebService\n            .requestView({\n                url: this.urls.getAuth\n            })\n            .pipe(\n                pluck('entity'),\n                tap((auth: Auth) => {\n                    if (auth.user) {\n                        this.setAuth(auth);\n                    }\n                }),\n                map((auth: Auth) => auth)\n            );\n    }\n\n    /**\n     * Change password\n     *\n     * @param {string} password\n     * @param {string} token\n     * @return {*}  {Observable<string>}\n     * @memberof LoginService\n     */\n    changePassword(password: string, token: string): Observable<string> {\n        const body = JSON.stringify({ password: password, token: token });\n\n        return this.coreWebService\n            .requestView({\n                body: body,\n                method: 'POST',\n                url: this.urls.changePassword\n            })\n            .pipe(pluck('entity'));\n    }\n\n    /**\n     * Get the server information to configure the login component\n     *\n     * @param {string} language\n     * @param {Array<string>} i18nKeys\n     * @return {*}  {Observable<DotLoginInformation>}\n     * @memberof LoginService\n     */\n    getLoginFormInfo(language: string, i18nKeys: Array<string>): Observable<DotLoginInformation> {\n        this.setLanguage(language);\n\n        return this.coreWebService\n            .requestView<DotLoginInformation>({\n                body: { messagesKey: i18nKeys, language: this.lang, country: this.country },\n                method: 'POST',\n                url: this.urls.serverInfo\n            })\n            .pipe(pluck('bodyJsonObject'));\n    }\n\n    /**\n     * Do the login as request and return an Observable.\n     *\n     * @param {{ user: User; password: string }} userData\n     * @return {*}  {Observable<boolean>}\n     * @memberof LoginService\n     */\n    loginAs(userData: { user: User; password: string }): Observable<boolean> {\n        return this.coreWebService\n            .requestView<{ loginAs: boolean }>({\n                body: {\n                    password: userData.password,\n                    userId: userData.user.userId\n                },\n                method: 'POST',\n                url: this.urls.loginAs\n            })\n            .pipe(\n                map((res) => {\n                    if (!res.entity.loginAs) {\n                        throw res.errorsMessages;\n                    }\n\n                    this.setAuth({\n                        loginAsUser: userData.user,\n                        user: this._auth.user,\n                        isLoginAs: true\n                    });\n                    return res;\n                }),\n                pluck('entity', 'loginAs')\n            );\n    }\n\n    /**\n     * Executes the call to the login rest api\n     *\n     * @param {DotLoginParams} {\n     *         login,\n     *         password,\n     *         rememberMe,\n     *         language,\n     *         backEndLogin\n     *     }\n     * @return {*}  {Observable<User>}\n     * @memberof LoginService\n     */\n    loginUser({\n        login,\n        password,\n        rememberMe,\n        language,\n        backEndLogin\n    }: DotLoginParams): Observable<User> {\n        this.setLanguage(language);\n\n        return this.coreWebService\n            .requestView<User>({\n                body: {\n                    userId: login,\n                    password: password,\n                    rememberMe: rememberMe,\n                    language: this.lang,\n                    country: this.country,\n                    backEndLogin: backEndLogin\n                },\n                method: 'POST',\n                url: this.urls.userAuth\n            })\n            .pipe(\n                map((response) => {\n                    const auth = {\n                        loginAsUser: null,\n                        user: response.entity,\n                        isLoginAs: false\n                    };\n\n                    this.setAuth(auth);\n                    this.coreWebService\n                        .subscribeToHttpError(HttpCode.UNAUTHORIZED)\n                        .subscribe(() => {\n                            this.logOutUser();\n                        });\n                    return response.entity;\n                })\n            );\n    }\n\n    /**\n     * Logout \"login as\" user\n     *\n     * @return {*}  {Observable<boolean>}\n     * @memberof LoginService\n     */\n    logoutAs(): Observable<boolean> {\n        return this.coreWebService\n            .requestView<{ logoutAs: boolean }>({\n                method: 'PUT',\n                url: `${this.urls.logoutAs}`\n            })\n            .pipe(\n                map((res) => {\n                    this.setAuth({\n                        loginAsUser: null,\n                        user: this._auth.user,\n                        isLoginAs: true\n                    });\n                    return res.entity.logoutAs;\n                })\n            );\n    }\n\n    /**\n     * Executes the call to the recover passwrod rest api\n     *\n     * @param {string} login\n     * @return {*}  {Observable<string>}\n     * @memberof LoginService\n     */\n    recoverPassword(login: string): Observable<string> {\n        return this.coreWebService\n            .requestView<string>({\n                body: { userId: login },\n                method: 'POST',\n                url: this.urls.recoverPassword\n            })\n            .pipe(pluck('entity'));\n    }\n\n    /**\n     * Subscribe to ser change and call received function on change.\n     *\n     * @param {(params?: unknown) => void} func\n     * @memberof LoginService\n     */\n    watchUser(func: (params?: unknown) => void): void {\n        if (this.auth) {\n            func(this.auth);\n        }\n\n        this.auth$.subscribe((auth) => {\n            if (auth.user) {\n                func(auth);\n            }\n        });\n    }\n\n    /**\n     * Set logged_auth and update auth Observable\n     *\n     * @param {Auth} auth\n     * @memberof LoginService\n     */\n    setAuth(auth: Auth): void {\n        this._auth = auth;\n        this._auth$.next(auth);\n\n        // When not logged user we need to fire the observable chain\n        if (!auth.user) {\n            this._logout$.next();\n        } else {\n            this.dotcmsEventsService.start();\n        }\n    }\n\n    private setLanguage(language: string): void {\n        if (language !== undefined && language !== '') {\n            const languageDesc = language.split('_');\n            this.lang = languageDesc[0];\n            this.country = languageDesc[1];\n        } else {\n            this.lang = '';\n            this.country = '';\n        }\n    }\n\n    private logOutUser(): void {\n        window.location.href = `${LOGOUT_URL}?r=${new Date().getTime()}`;\n    }\n}\n\nexport interface CurrentUser {\n    email: string;\n    givenName: string;\n    loginAs: boolean;\n    roleId: string;\n    surname: string;\n    userId: string;\n}\n\nexport interface User {\n    active?: boolean;\n    actualCompanyId?: string;\n    birthday?: number; // Timestamp\n    comments?: string;\n    companyId?: string;\n    createDate?: number; // Timestamp\n    deleteDate?: number; // Timestamp\n    deleteInProgress?: boolean;\n    emailAddress: string;\n    failedLoginAttempts?: number;\n    female?: boolean;\n    firstName: string;\n    fullName?: string;\n    id?: string;\n    languageId?: string;\n    lastLoginDate?: number; // Timestamp\n    lastLoginIP?: string;\n    lastName: string;\n    male?: boolean;\n    middleName?: string;\n    modificationDate?: number; // Timestamp\n    name?: string;\n    nickname?: string;\n    requestPassword?: boolean;\n    timeZoneId?: string;\n    type?: string;\n    userId: string;\n    password?: string;\n    editModeUrl?: string;\n}\n\nexport interface Auth {\n    user: User;\n    loginAsUser: User;\n    isLoginAs?: boolean;\n}\n","import { CoreWebService } from './core-web.service';\nimport { Injectable } from '@angular/core';\nimport { LoginService } from './login.service';\nimport { Observable } from 'rxjs';\nimport { DotRouterService } from './dot-router.service';\nimport { Subject } from 'rxjs';\nimport { DotcmsEventsService } from './dotcms-events.service';\n\n@Injectable()\nexport class RoutingService {\n    private _menusChange$: Subject<Menu[]> = new Subject();\n    private menus: Menu[];\n    private urlMenus: string;\n    private portlets: Map<string, string>;\n    private _currentPortletId: string;\n\n    private _portletUrlSource$ = new Subject<string>();\n    private _currentPortlet$ = new Subject<string>();\n\n    // TODO: I think we should be able to remove the routing injection\n    constructor(\n        loginService: LoginService,\n        private router: DotRouterService,\n        private coreWebService: CoreWebService,\n        dotcmsEventsService: DotcmsEventsService\n    ) {\n        this.urlMenus = 'v1/CORE_WEB/menu';\n        this.portlets = new Map();\n\n        loginService.watchUser(this.loadMenus.bind(this));\n        dotcmsEventsService\n            .subscribeTo('UPDATE_PORTLET_LAYOUTS')\n            .subscribe(this.loadMenus.bind(this));\n    }\n\n    get currentPortletId(): string {\n        return this._currentPortletId;\n    }\n\n    get currentMenu(): Menu[] {\n        return this.menus;\n    }\n\n    get menusChange$(): Observable<Menu[]> {\n        return this._menusChange$.asObservable();\n    }\n\n    get portletUrl$(): Observable<string> {\n        return this._portletUrlSource$.asObservable();\n    }\n\n    get firstPortlet(): string {\n        const porlets = this.portlets.entries().next().value;\n        return porlets ? porlets[0] : null;\n    }\n\n    public addPortletURL(portletId: string, url: string): void {\n        this.portlets.set(portletId.replace(' ', '_'), url);\n    }\n\n    public getPortletURL(portletId: string): string {\n        return this.portlets.get(portletId);\n    }\n\n    public goToPortlet(portletId: string): void {\n        this.router.gotoPortlet(portletId);\n        this._currentPortletId = portletId;\n    }\n\n    public isPortlet(url: string): boolean {\n        let id = this.getPortletId(url);\n        if (id.indexOf('?') >= 0) {\n            id = id.substr(0, id.indexOf('?'));\n        }\n\n        return this.portlets.has(id);\n    }\n\n    public setCurrentPortlet(url: string): void {\n        let id = this.getPortletId(url);\n        if (id.indexOf('?') >= 0) {\n            id = id.substr(0, id.indexOf('?'));\n        }\n        this._currentPortletId = id;\n        this._currentPortlet$.next(id);\n    }\n\n    get currentPortlet$(): Observable<string> {\n        return this._currentPortlet$;\n    }\n\n    public setMenus(menus: Menu[]): void {\n        this.menus = menus;\n\n        if (this.menus.length) {\n            this.portlets = new Map();\n\n            for (let i = 0; i < this.menus.length; i++) {\n                const menu = this.menus[i];\n\n                for (let k = 0; k < menu.menuItems.length; k++) {\n                    const subMenuItem = menu.menuItems[k];\n                    if (subMenuItem.angular) {\n                        this.portlets.set(subMenuItem.id, subMenuItem.url);\n                    } else {\n                        subMenuItem.menuLink = '/c/' + subMenuItem.id;\n                        this.portlets.set(subMenuItem.id, subMenuItem.url);\n                    }\n                }\n            }\n            this._menusChange$.next(this.menus);\n        }\n    }\n\n    /**\n     * Refresh the portlet displayed. with the\n     * @param url portlet url\n     */\n    public changeRefreshPortlet(url: string): void {\n        const portletId = this.getPortletId(url);\n        if (portletId === this.currentPortletId) {\n            this._portletUrlSource$.next(url);\n        }\n    }\n\n    private loadMenus(): void {\n        this.coreWebService\n            .requestView({\n                url: this.urlMenus\n            })\n            .subscribe(\n                (response) => {\n                    this.setMenus(response.entity);\n                },\n                (error) => this._menusChange$.error(error)\n            );\n    }\n\n    private getPortletId(url: string): string {\n        const urlSplit = url.split('/');\n        return urlSplit[urlSplit.length - 1];\n    }\n}\n\nexport interface Menu {\n    tabDescription: string;\n    tabName: string;\n    url: string;\n    menuItems: MenuItem[];\n}\n\nexport interface MenuItem {\n    ajax: boolean;\n    angular: boolean;\n    id: string;\n    name: string;\n    url: string;\n    menuLink: string;\n}\n","import { Injectable } from '@angular/core';\nimport { CoreWebService } from './core-web.service';\nimport { Observable, Subject, of, merge } from 'rxjs';\nimport { pluck, map, take } from 'rxjs/operators';\nimport { LoginService, Auth } from './login.service';\nimport { LoggerService } from './logger.service';\nimport { DotcmsEventsService } from './dotcms-events.service';\nimport { DotEventTypeWrapper } from './models/dot-events/dot-event-type-wrapper';\n\n/**\n * Provide methods and data to hable the sites.\n * @export\n */\n@Injectable({\n    providedIn: 'root'\n})\nexport class SiteService {\n    private selectedSite: Site;\n    private urls: any;\n    private events: string[] = [\n        'SAVE_SITE',\n        'PUBLISH_SITE',\n        'UPDATE_SITE_PERMISSIONS',\n        'UN_ARCHIVE_SITE',\n        'UPDATE_SITE',\n        'ARCHIVE_SITE'\n    ];\n    private _switchSite$: Subject<Site> = new Subject<Site>();\n    private _refreshSites$: Subject<Site> = new Subject<Site>();\n\n    constructor(\n        loginService: LoginService,\n        dotcmsEventsService: DotcmsEventsService,\n        private coreWebService: CoreWebService,\n        private loggerService: LoggerService\n    ) {\n        this.urls = {\n            currentSiteUrl: 'v1/site/currentSite',\n            sitesUrl: 'v1/site',\n            switchSiteUrl: 'v1/site/switch'\n        };\n\n        dotcmsEventsService\n            .subscribeToEvents<Site>(['ARCHIVE_SITE', 'UPDATE_SITE'])\n            .subscribe((event: DotEventTypeWrapper<Site>) => this.eventResponse(event));\n\n        dotcmsEventsService\n            .subscribeToEvents<Site>(this.events)\n            .subscribe(({ data }: DotEventTypeWrapper<Site>) => this.siteEventsHandler(data));\n\n        dotcmsEventsService\n            .subscribeToEvents<Site>(['SWITCH_SITE'])\n            .subscribe(({ data }: DotEventTypeWrapper<Site>) => this.setCurrentSite(data));\n\n        loginService.watchUser((auth: Auth) => {\n            if (!auth.isLoginAs) {\n                this.loadCurrentSite();\n            }\n        });\n    }\n\n    /**\n     * Manage the response when an event happen\n     *\n     * @memberof SiteService\n     */\n    eventResponse({ name, data }: DotEventTypeWrapper<Site>): void {\n        this.loggerService.debug('Capturing Site event', name, data);\n\n        const siteIdentifier = data.identifier;\n        if (siteIdentifier === this.selectedSite.identifier) {\n\n            name === 'ARCHIVE_SITE'\n                ? this.switchToDefaultSite()\n                      .pipe(take(1))\n                      .subscribe((currentSite: Site) => {\n                          this.switchSite(currentSite);\n                      })\n                : this.loadCurrentSite();\n\n        }\n    }\n\n    /**\n     * Refresh the sites list if a event happen\n     *\n     * @memberof SiteService\n     */\n    siteEventsHandler(site: Site): void {\n        this._refreshSites$.next(site);\n    }\n\n    /**\n     * Observable trigger when an site event happens\n     * @readonly\n     * @memberof SiteService\n     */\n    get refreshSites$(): Observable<Site> {\n        return this._refreshSites$.asObservable();\n    }\n\n    /**\n     * Observable tigger when the current site is changed\n     * @readonly\n     * @memberof SiteService\n     */\n    get switchSite$(): Observable<Site> {\n        return this._switchSite$.asObservable();\n    }\n\n    /**\n     * Return the current site for the login user.\n     * @readonly\n     * @memberof SiteService\n     */\n    get currentSite(): Site {\n        return this.selectedSite;\n    }\n\n    /**\n     * Switch To Default Site in the BE and returns it.\n     *\n     * @returns Observable<Site>\n     * @memberof SiteService\n     */\n    switchToDefaultSite(): Observable<Site> {\n        return this.coreWebService\n            .requestView({\n                method: 'PUT',\n                url: 'v1/site/switch'\n            })\n            .pipe(pluck('entity'));\n    }\n\n    /**\n     * Get a site by the id\n     *\n     * @param string id\n     * @returns Observable<Site>\n     * @memberof SiteService\n     */\n    getSiteById(id: string): Observable<Site> {\n        return this.coreWebService\n            .requestView({\n                url: `/api/content/render/false/query/+contentType:host%20+identifier:${id}`\n            })\n            .pipe(\n                pluck('contentlets'),\n                map((sites: Site[]) => sites[0])\n            );\n    }\n\n    /**\n     * Change the current site\n     * @param Site site\n     * @memberof SiteService\n     */\n    switchSite(site: Site): void {\n        this.loggerService.debug('Applying a Site Switch', site.identifier);\n        this.coreWebService\n            .requestView({\n                method: 'PUT',\n                url: `${this.urls.switchSiteUrl}/${site.identifier}`\n            })\n            .pipe(take(1))\n            .subscribe(() => {\n                this.setCurrentSite(site);\n            });\n    }\n\n    /**\n     * Get the current site\n     * @returns Observable<Site>\n     * @memberof SiteService\n     */\n    getCurrentSite(): Observable<Site> {\n        return merge(\n            this.selectedSite ? of(this.selectedSite) : this.requestCurrentSite(),\n            this.switchSite$\n        );\n    }\n\n    private requestCurrentSite(): Observable<Site> {\n        return this.coreWebService\n            .requestView({\n                url: this.urls.currentSiteUrl\n            })\n            .pipe(pluck('entity'));\n    }\n\n    private setCurrentSite(site: Site): void {\n        if (this.selectedSite?.identifier !== site.identifier) {\n            this.selectedSite = site;\n            this._switchSite$.next({ ...site });\n        }\n    }\n\n    private loadCurrentSite(): void {\n        this.getCurrentSite()\n            .pipe(take(1))\n            .subscribe((currentSite: Site) => {\n                this.setCurrentSite(currentSite);\n            });\n    }\n}\n\nexport interface Site {\n    hostname: string;\n    type: string;\n    identifier: string;\n    archived: boolean;\n}\n","import { Injectable } from '@angular/core';\n/**\n * Configuration class for dotcms-js. You can extend this class to overide one to many config options and inject\n * the your AppConfig in the app.module ts file of your application\n */\n@Injectable()\nexport class AppConfig {\n    public iconPath = './src/assets/images/icons';\n    public dotCMSURLKey = 'siteURLJWT';\n}\n","import { Injectable, NgModule } from '@angular/core';\n\n/**\n * LocalStoreService. Basic wraper for localStorage\n */\n@Injectable()\nexport class LocalStoreService {\n    /**\n     * Stores Value in localstorage\n     * @param key\n     * @param value\n     */\n    storeValue(key: string, value: any): void {\n        localStorage.setItem(key, value);\n        // storage.set(key, value, callback);\n    }\n\n    /**\n     * Gets a value from localstorage\n     * @param key\n     * @returns any\n     */\n    getValue(key: string): any {\n        return localStorage.getItem(key);\n        // return storage.get(key, callback);\n    }\n\n    /**\n     * Clears a value from localstorage\n     * @param key\n     */\n    clearValue(key: string): void {\n        localStorage.removeItem(key);\n    }\n\n    /**\n     * Clears all localstorage\n     */\n    clear(): void {\n        localStorage.clear();\n    }\n}\n\n@NgModule({\n    providers: [LocalStoreService]\n})\nexport class DotLocalStoreModule {}\n","import { AppConfig } from './app.config';\nimport { Inject, Injectable, NgModule } from '@angular/core';\n\n/**\n * Used by the NotificationService to set Desktop Notifications\n */\ndeclare class Notification {\n    constructor(title: string, options?: Object);\n}\n\n/**\n * NotificationService will notify using Desktop Notifications\n * https://developer.mozilla.org/en-US/docs/Web/API/notification\n * Can change icons by setting iconPath in the AppConfig if needed\n */\n@Injectable()\n@Inject('config')\nexport class NotificationService {\n    iconPath: string;\n\n    constructor(config: AppConfig) {\n        this.iconPath = config.iconPath;\n    }\n\n    /**\n     * Displays an error message\n     * @param body\n     */\n    displayErrorMessage(body: string): void {\n        this.displayMessage('Error', body, 'error');\n    }\n\n    /**\n     * Displays a success message\n     * @param body\n     */\n    displaySuccessMessage(body: string): void {\n        this.displayMessage('Success', body, 'success');\n    }\n\n    /**\n     * Displays an Info message\n     * @param body\n     */\n    displayInfoMessage(body: string): void {\n        this.displayMessage('Info', body, 'info');\n    }\n\n    /**\n     * Display message for passed in type\n     * @param title\n     * @param body\n     * @param type\n     */\n    displayMessage(_title: string, body: string, type: string): Notification {\n        let myNotification: Notification;\n        myNotification = new Notification(type, {\n            body: body,\n            icon: this.iconPath + '/' + type + '.png'\n        });\n\n        return myNotification;\n    }\n}\n\n@NgModule({\n    providers: [AppConfig, NotificationService]\n})\nexport class DotNotificationModule {}\n","import { Injectable } from '@angular/core';\nimport { Observable, of } from 'rxjs';\nimport { map, filter } from 'rxjs/operators';\nimport {\n    HttpClient,\n    HttpRequest,\n    HttpEvent,\n    HttpEventType,\n    HttpResponse,\n    HttpParams,\n    HttpHeaders\n} from '@angular/common/http';\nimport { DotCMSResponse, DotRequestOptionsArgs } from './core-web.service';\nimport { ResponseView } from './util/response-view';\n\n@Injectable()\nexport class CoreWebServiceMock {\n    constructor(private _http: HttpClient) {}\n\n    request<T = any>(options: DotRequestOptionsArgs): Observable<any> {\n        if (!options.method) {\n            options.method = 'GET';\n        }\n\n        const optionsArgs = {\n            params: new HttpParams()\n        };\n\n        if (options.params) {\n            Object.keys(options.params).forEach((key) => {\n                optionsArgs.params = optionsArgs.params.set(key, options.params[key]);\n            });\n        }\n\n        return this._http\n            .request(\n                new HttpRequest(options.method, options.url, options.body, {\n                    params: optionsArgs.params\n                })\n            )\n            .pipe(\n                filter(\n                    (event: HttpEvent<HttpResponse<DotCMSResponse<T>> | any>) =>\n                        event.type === HttpEventType.Response\n                ),\n                map((resp: HttpResponse<DotCMSResponse<T>>) => {\n                    try {\n                        return resp.body;\n                    } catch (error) {\n                        return resp;\n                    }\n                })\n            );\n    }\n\n    requestView<T = any>(options: DotRequestOptionsArgs): Observable<ResponseView<T>> {\n        if (!options.method) {\n            options.method = 'GET';\n        }\n\n        const optionsArgs = {\n            headers: new HttpHeaders(),\n            params: new HttpParams()\n        };\n\n        if (options.params) {\n            Object.keys(options.params).forEach((key: string) => {\n                optionsArgs.params = optionsArgs.params.set(key, options.params[key]);\n            });\n        }\n\n        return this._http\n            .request(\n                new HttpRequest(options.method, options.url, options.body, {\n                    params: optionsArgs.params\n                })\n            )\n            .pipe(\n                filter(\n                    (event: HttpEvent<HttpResponse<DotCMSResponse<T>> | any>) =>\n                        event.type === HttpEventType.Response\n                ),\n                map((resp: HttpResponse<DotCMSResponse<T>>) => {\n                    return new ResponseView<T>(resp);\n                })\n            );\n    }\n\n    subscribeTo(httpErrorCode: number): Observable<any> {\n        return of({\n            error: httpErrorCode\n        });\n    }\n}\n","import { Component, ViewEncapsulation } from '@angular/core';\n\n@Component({\n    selector: 'dotcms-drag-handler',\n    templateUrl: './drag-handler.component.html',\n    styleUrls: ['./drag-handler.component.scss']\n})\nexport class DragHandlerComponent {}\n","import { Component, OnInit, ElementRef, OnDestroy } from '@angular/core';\nimport { AngularNodeViewComponent } from '../../../NodeViewRenderer';\n\ninterface ImageData {\n    asset: string;\n    name: string;\n}\n\n@Component({\n    selector: 'dotcms-image-block',\n    templateUrl: './image-block.component.html',\n    styleUrls: ['./image-block.component.scss']\n})\nexport class ImageBlockComponent extends AngularNodeViewComponent implements OnInit, OnDestroy {\n    public data: ImageData;\n    public href: string;\n\n    constructor(private _elementRef: ElementRef) {\n        super();\n    }\n\n    ngOnInit(): void {\n        this.data = this.node.attrs.data;\n        this.editor.on('update', this.updateImageAttributes.bind(this));\n    }\n\n    ngOnDestroy(): void {\n        this.editor.off('update', this.updateImageAttributes.bind(this));\n    }\n\n    private updateImageAttributes(): void {\n        this._elementRef.nativeElement.style.textAlign = this.node.attrs.textAlign;\n        this.href = this.node.attrs.href;\n    }\n}\n","import { Component, ViewEncapsulation } from '@angular/core';\nimport { AngularNodeViewComponent } from '../../../NodeViewRenderer';\n\nexport const enum MessageType {\n    INFO = 'info',\n    ERROR = 'error'\n}\n\n@Component({\n    selector: 'dotcms-message',\n    templateUrl: './loader.component.html',\n    styleUrls: ['./loader.component.scss'],\n    encapsulation: ViewEncapsulation.None\n})\nexport class LoaderComponent extends AngularNodeViewComponent {\n    data: {\n        type: MessageType;\n        message: string;\n    };\n}\n","import { DotCMSTempFile, DotHttpErrorResponse, DotHttpRequestOptions } from '@dotcms/dotcms-models';\n\nexport const fallbackErrorMessages = {\n    500: '500 Internal Server Error',\n    400: '400 Bad Request',\n    401: '401 Unauthorized Error'\n};\n\nconst TEMP_API_URL = '/api/v1/temp';\n\n/**\n * Will call the corresponding endpoint to upload a temporary file.\n * Return the information of tha file in the server\n * @param file\n * @param maxSize\n *\n */\nexport function uploadFile(file: string | File, maxSize?: string): Promise<DotCMSTempFile> {\n    if (typeof file === 'string') {\n        return uploadFileByURL(file);\n    } else {\n        return uploadBinaryFile(file, maxSize) as Promise<DotCMSTempFile>;\n    }\n}\n\nfunction uploadFileByURL(url: string): Promise<DotCMSTempFile> {\n    const UPLOAD_FILE_FROM_URL = `${TEMP_API_URL}/byUrl`;\n    return fetch(UPLOAD_FILE_FROM_URL, {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json',\n            Origin: window.location.hostname\n        },\n        body: JSON.stringify({\n            remoteUrl: url\n        })\n    }).then(async (response: Response) => {\n        if (response.status === 200) {\n            return (await response.json()).tempFiles[0];\n        } else {\n            throw errorHandler(await response.json(), response.status);\n        }\n    });\n}\n\n/**\n * Will call the temp resource endpoint to upload a temporary file.\n * With a callback to track the progress of the upload\n * Return the information of tha file(s) in the server\n * @param data\n * @param progressCallBack\n * @param maxSize\n *\n */\nexport function uploadBinaryFile(\n    data: File | File[],\n    progressCallBack?,\n    maxSize?: string\n): Promise<DotCMSTempFile | DotCMSTempFile[]> {\n    let path = TEMP_API_URL;\n    path += maxSize ? `?maxFileLength=${maxSize}` : '';\n    const formData = new FormData();\n\n    const files = Array.isArray(data) ? data : [data];\n    files.forEach((file: File) => {\n        formData.append('files', file);\n    });\n\n    return dotRequest(\n        path,\n        {\n            method: 'POST',\n            headers: {},\n            body: formData\n        },\n        progressCallBack\n    )\n        .then(async (request: XMLHttpRequest) => {\n            if (request.status === 200) {\n                const data = JSON.parse(request.response).tempFiles;\n                return data.length > 1 ? data : data[0];\n            } else {\n                throw request;\n            }\n        })\n        .catch((request) => {\n            throw errorHandler(JSON.parse(request.response), request.status);\n        });\n}\n\nfunction dotRequest(\n    url: string,\n    opts: DotHttpRequestOptions,\n    progressCallBack: (progress: number) => {}\n): Promise<XMLHttpRequest> {\n    return new Promise((res, rej) => {\n        const xhr = new XMLHttpRequest();\n        xhr.open(opts.method || 'get', url);\n        for (const name in opts.headers || {}) {\n            xhr.setRequestHeader(name, opts.headers[name]);\n        }\n        xhr.onload = () => res(xhr);\n        xhr.onerror = rej;\n        if (xhr.upload && progressCallBack) {\n            xhr.upload.onprogress = (e: ProgressEvent) => {\n                const percentComplete = (e.loaded / e.total) * 100;\n                progressCallBack(percentComplete);\n            };\n        }\n        xhr.send(opts.body);\n    });\n}\n\nfunction errorHandler(response: any, status: number): DotHttpErrorResponse {\n    let message = '';\n    try {\n        message = response.message || fallbackErrorMessages[status];\n    } catch (e) {\n        message = fallbackErrorMessages[status || 500];\n    }\n    return {\n        message: message,\n        status: status | 500\n    };\n}\n","import { Injectable } from '@angular/core';\nimport { uploadBinaryFile } from '@dotcms/utils';\nimport { from, Observable } from 'rxjs';\nimport { pluck, switchMap } from 'rxjs/operators';\nimport { DotCMSContentlet, DotCMSTempFile } from '@dotcms/dotcms-models';\nimport { HttpClient } from '@angular/common/http';\n\n@Injectable()\nexport class DotImageService {\n    constructor(private http: HttpClient) {}\n\n    publishContent(data: File | File[], maxSize?: string): Observable<DotCMSContentlet[]> {\n        return this.setTempResource(data, maxSize).pipe(\n            switchMap((response: DotCMSTempFile | DotCMSTempFile[]) => {\n                const files = Array.isArray(response) ? response : [response];\n                const contentlets = [];\n                files.forEach((file: DotCMSTempFile) => {\n                    contentlets.push({\n                        baseType: 'dotAsset',\n                        asset: file.id,\n                        hostFolder: '',\n                        indexPolicy: 'WAIT_FOR'\n                    });\n                });\n                return this.http\n                    .post(\n                        '/api/v1/workflow/actions/default/fire/PUBLISH',\n                        JSON.stringify({ contentlets }),\n                        {\n                            headers: {\n                                Origin: window.location.hostname,\n                                'Content-Type': 'application/json;charset=UTF-8'\n                            }\n                        }\n                    )\n                    .pipe(pluck('entity', 'results')) as Observable<DotCMSContentlet[]>;\n            })\n        );\n    }\n\n    private setTempResource(\n        data: File | File[],\n        maxSize?: string\n    ): Observable<DotCMSTempFile | DotCMSTempFile[]> {\n        return from(uploadBinaryFile(data, () => {}, maxSize));\n    }\n}\n","import { Component, EventEmitter, Input, Output } from '@angular/core';\nimport { BubbleMenuItem } from '@dotcms/block-editor';\n\n@Component({\n    selector: 'dotcms-bubble-menu',\n    templateUrl: './bubble-menu.component.html',\n    styleUrls: ['./bubble-menu.component.scss']\n})\nexport class BubbleMenuComponent {\n    @Input() items: BubbleMenuItem[] = [];\n    @Output() command: EventEmitter<BubbleMenuItem> = new EventEmitter();\n\n    preventDeSelection(event: MouseEvent): void {\n        event.preventDefault();\n    }\n}\n","import { Component, Input } from '@angular/core';\n\n// Interface\nimport type { BubbleMenuItem } from '@dotcms/block-editor';\n\n@Component({\n    selector: 'dotcms-bubble-menu-button',\n    templateUrl: './bubble-menu-button.component.html',\n    styleUrls: ['./bubble-menu-button.component.scss']\n})\nexport class BubbleMenuButtonComponent {\n    @Input() item: BubbleMenuItem;\n    @Input() active = false;\n}\n","import {\n    Component,\n    ViewChild,\n    ElementRef,\n    EventEmitter,\n    Output,\n    Input\n} from '@angular/core';\n\n@Component({\n    selector: 'dotcms-bubble-menu-link-form',\n    templateUrl: './bubble-menu-link-form.component.html',\n    styleUrls: ['./bubble-menu-link-form.component.scss']\n})\nexport class BubbleMenuLinkFormComponent {\n\n    @ViewChild('input') input: ElementRef;\n    \n    @Output() hideForm: EventEmitter<boolean> = new EventEmitter(false);\n    @Output() removeLink: EventEmitter<boolean> = new EventEmitter(false);\n    @Output() setLink: EventEmitter<string> = new EventEmitter();\n\n    @Input() nodeLink = '';\n    @Input() newLink = '';\n\n    addLink() {\n        this.setLink.emit( this.newLink );\n    }\n\n    copyLink() {\n        navigator.clipboard\n            .writeText(this.nodeLink)\n            .then(() => this.hideForm.emit(true))\n            .catch(() => alert('Could not copy link'));\n    }\n\n    focusInput() {\n        this.input.nativeElement.focus();\n    }\n}\n","import { NgModule } from '@angular/core';\nimport { FormsModule } from '@angular/forms';\n\nimport { EditorDirective } from './editor.directive';\nimport { BubbleMenuDirective } from './bubble-menu.directive';\nimport { DraggableDirective } from './draggable.directive';\nimport { NodeViewContentDirective } from './node-view-content.directive';\n\nimport { MenuModule } from 'primeng/menu';\nimport { CommonModule } from '@angular/common';\nimport { CardModule } from 'primeng/card';\nimport { ContentletBlockComponent } from './extensions/blocks/contentlet-block/contentlet-block.component';\n\nimport { SuggestionsService } from './extensions/services/suggestions/suggestions.service';\nimport { SuggestionsComponent } from './extensions/components/suggestions/suggestions.component';\nimport { SuggestionListComponent } from './extensions/components/suggestion-list/suggestion-list.component';\nimport { ActionButtonComponent } from './extensions/components/action-button/action-button.component';\nimport { SuggestionsListItemComponent } from './extensions/components/suggestions-list-item/suggestions-list-item.component';\nimport { LoggerService } from '@dotcms/dotcms-js';\nimport { StringUtils } from '@dotcms/dotcms-js';\nimport { DragHandlerComponent } from './extensions/components/drag-handler/drag-handler.component';\nimport { ImageBlockComponent } from './extensions/blocks/image-block/image-block.component';\nimport { LoaderComponent } from './extensions/components/loader/loader.component';\nimport { DotImageService } from './extensions/services/dot-image/dot-image.service';\nimport { BubbleMenuComponent } from './extensions/components/bubble-menu/bubble-menu.component';\nimport { BubbleMenuButtonComponent } from './extensions/components/bubble-menu-button/bubble-menu-button.component';\nimport { BubbleMenuLinkFormComponent } from './extensions/components/bubble-menu-link-form/bubble-menu-link-form.component';\n\n@NgModule({\n    imports: [CommonModule, FormsModule, CardModule, MenuModule],\n    declarations: [\n        EditorDirective,\n        BubbleMenuDirective,\n        DraggableDirective,\n        NodeViewContentDirective,\n        SuggestionsComponent,\n        SuggestionListComponent,\n        SuggestionsListItemComponent,\n        ContentletBlockComponent,\n        ActionButtonComponent,\n        DragHandlerComponent,\n        ImageBlockComponent,\n        LoaderComponent,\n        BubbleMenuComponent,\n        BubbleMenuButtonComponent,\n        BubbleMenuLinkFormComponent\n    ],\n    providers: [SuggestionsService, DotImageService, LoggerService, StringUtils],\n    exports: [\n        SuggestionsComponent,\n        EditorDirective,\n        BubbleMenuDirective,\n        DraggableDirective,\n        NodeViewContentDirective,\n        ActionButtonComponent,\n        BubbleMenuComponent,\n        BubbleMenuLinkFormComponent\n    ]\n})\nexport class NgxTiptapModule {}\n","import { Editor, posToDOMRect, Range } from '@tiptap/core';\nimport { EditorState, Plugin, PluginKey, Transaction } from 'prosemirror-state';\nimport { EditorView } from 'prosemirror-view';\nimport tippy, { Instance, Props } from 'tippy.js';\nimport { SuggestionsCommandProps } from '../extensions/components/suggestions/suggestions.component';\n\ninterface PluginState {\n    open: boolean;\n}\n\nexport interface FloatingActionsPluginProps {\n    editor: Editor;\n    element: HTMLElement;\n    tippyOptions?: Partial<Props>;\n    render?: () => FloatingRenderActions;\n    command: ({\n        editor,\n        range,\n        props\n    }: {\n        editor: Editor;\n        range: Range;\n        props: SuggestionsCommandProps;\n    }) => void;\n}\n\nexport type FloatingActionsViewProps = FloatingActionsPluginProps & {\n    view: EditorView;\n    key: PluginKey;\n};\n\nexport interface FloatingActionsProps {\n    range: Range;\n    editor: Editor;\n    command: (props: { editor: Editor; range: Range; props: SuggestionsCommandProps }) => void;\n    clientRect: (() => DOMRect) | null;\n}\n\nexport interface FloatingActionsKeydownProps {\n    view: EditorView;\n    event: KeyboardEvent;\n    range: Range;\n}\n\nexport interface FloatingRenderActions {\n    onStart?: (props: FloatingActionsProps) => void;\n    onExit?: (props: FloatingActionsProps) => void;\n    onKeyDown?: (props: FloatingActionsKeydownProps) => boolean;\n}\n\nexport const FLOATING_ACTIONS_MENU_KEYBOARD = 'menuFloating';\n\nexport class FloatingActionsView {\n    editor: Editor;\n    element: HTMLElement;\n    view: EditorView;\n    tippy!: Instance;\n    render: () => FloatingRenderActions;\n    command: (props: { editor: Editor; range: Range; props: SuggestionsCommandProps }) => void;\n    key: PluginKey;\n    invalidNodes = ['codeBlock', 'blockquote'];\n\n    constructor({\n        editor,\n        element,\n        view,\n        tippyOptions,\n        render,\n        command,\n        key\n    }: FloatingActionsViewProps) {\n        this.editor = editor;\n        this.element = element;\n        this.view = view;\n        this.element.addEventListener('mousedown', this.mousedownHandler, { capture: true });\n        this.editor.on('focus', () => {\n            this.tippy.unmount();\n            this.update(this.editor.view);\n        });\n        this.element.style.visibility = 'visible';\n        this.render = render;\n        this.command = command;\n        this.key = key;\n        this.createTooltip(tippyOptions);\n    }\n\n    /**\n     * Element mousedown handler to update the plugin state and open\n     *\n     * @param {MouseEvent} e\n     * @memberof FloatingActionsView\n     */\n    mousedownHandler = (e: MouseEvent): void => {\n        e.preventDefault();\n\n        const transaction = this.editor.state.tr.setMeta(FLOATING_ACTIONS_MENU_KEYBOARD, {\n            open: true\n        });\n        this.editor.view.dispatch(transaction);\n    };\n\n    /**\n     * Create the tooltip for the element\n     *\n     * @param {Partial<Props>} [options={}]\n     * @memberof FloatingActionsView\n     */\n    createTooltip(options: Partial<Props> = {}): void {\n        this.tippy = tippy(this.view.dom, {\n            duration: 0,\n            getReferenceClientRect: null,\n            content: this.element,\n            interactive: true,\n            trigger: 'manual',\n            placement: 'left',\n            hideOnClick: 'toggle',\n            ...options\n        });\n    }\n\n    /**\n     * Check the EditorState and based on that modify the DOM\n     *\n     * @param {EditorView} view\n     * @param {EditorState} prevState\n     * @return {*}  {void}\n     * @memberof FloatingActionsView\n     */\n    update(view: EditorView, prevState?: EditorState): void {\n        const { selection } = view.state;\n        const { $anchor, empty, from, to } = selection;\n        const isRootDepth = $anchor.depth === 1;\n        const isNodeEmpty =\n        !selection.$anchor.parent.isLeaf && !selection.$anchor.parent.textContent;\n        const isActive = isRootDepth && isNodeEmpty;\n        const nodeType = $anchor.parent.type.name;\n        \n        const next = this.key?.getState(view.state);\n        const prev = prevState ? this.key?.getState(prevState) : null;\n\n        if (!prev?.open && (!empty || !isActive)) {\n            this.hide();\n            return;\n        }\n\n        // Hide is Parent node is not the editor\n        if (!prev?.open && this.invalidNodes.includes(nodeType)) {\n            this.hide();\n            return;\n        }\n\n        this.tippy.setProps({\n            getReferenceClientRect: () => posToDOMRect(view, from, to)\n        });\n\n        this.show();\n\n        if (next.open) {\n            const { from, to } = this.editor.state.selection;\n            const rect = posToDOMRect(this.view, from, to);\n\n            this.render().onStart({\n                clientRect: () => rect,\n                range: { from, to },\n                editor: this.editor,\n                command: this.command\n            });\n        } else if (prev && prev.open) {\n            this.render().onExit(null);\n        }\n    }\n\n    show() {\n        this.tippy.show();\n    }\n\n    hide() {\n        this.tippy.hide();\n    }\n\n    destroy() {\n        this.tippy.destroy();\n        this.element.removeEventListener('mousedown', this.mousedownHandler);\n    }\n}\n\nexport const FloatingActionsPluginKey = new PluginKey(FLOATING_ACTIONS_MENU_KEYBOARD);\n\nexport const FloatingActionsPlugin = (options: FloatingActionsPluginProps) => {\n    return new Plugin({\n        key: FloatingActionsPluginKey,\n        view: (view) =>\n            new FloatingActionsView({ key: FloatingActionsPluginKey, view, ...options }),\n        state: {\n            /**\n             * Init the plugin state\n             *\n             * @return {*}  {PluginState}\n             */\n            init(): PluginState {\n                return {\n                    open: false\n                };\n            },\n            /**\n             * Update the plugin state base on meta information\n             *\n             * @param {Transaction} transaction\n             * @return {*}  {PluginState}\n             */\n            apply(transaction: Transaction): PluginState {\n                const transactionMeta = transaction.getMeta(FLOATING_ACTIONS_MENU_KEYBOARD);\n\n                if (transactionMeta?.open) {\n                    return {\n                        open: transactionMeta?.open\n                    };\n                }\n\n                return {\n                    open: false\n                };\n            }\n        },\n        props: {\n            /**\n             * Catch and handle the keydown in the plugin\n             *\n             * @param {EditorView} view\n             * @param {KeyboardEvent} event\n             * @return {*}\n             */\n            handleKeyDown(view: EditorView, event: KeyboardEvent) {\n                const { open, range } = this.getState(view.state);\n                if (!open) {\n                    return false;\n                }\n                return options.render().onKeyDown({ event, range, view });\n            }\n        }\n    });\n};\n","import { ComponentFactoryResolver, ComponentRef, Injector } from '@angular/core';\n\nimport { Editor, Extension, Range } from '@tiptap/core';\nimport { FloatingMenuPluginProps } from '@tiptap/extension-floating-menu';\nimport Suggestion, { SuggestionOptions, SuggestionProps } from '@tiptap/suggestion';\n\nimport tippy, { GetReferenceClientRect } from 'tippy.js';\n\nimport {\n    FloatingActionsKeydownProps,\n    FloatingActionsPlugin,\n    FloatingActionsProps,\n    FLOATING_ACTIONS_MENU_KEYBOARD\n} from '../plugins/floating.plugin';\nimport {\n    SuggestionsCommandProps,\n    SuggestionsComponent\n} from './components/suggestions/suggestions.component';\nimport { ActionButtonComponent } from './components/action-button/action-button.component';\n\ndeclare module '@tiptap/core' {\n    interface Commands<ReturnType> {\n        actionsMenu: {\n            /**\n             * Add Heading\n             */\n            addHeading: (attr: any) => ReturnType;\n            addContentletBlock: (attr: any) => ReturnType;\n        };\n    }\n}\n\nexport type FloatingMenuOptions = Omit<FloatingMenuPluginProps, 'editor' | 'element'> & {\n    element: HTMLElement | null;\n    suggestion: Omit<SuggestionOptions, 'editor'>;\n};\n\nfunction getSuggestionComponent(injector: Injector, resolver: ComponentFactoryResolver) {\n    const factory = resolver.resolveComponentFactory(SuggestionsComponent);\n    const component = factory.create(injector);\n    component.changeDetectorRef.detectChanges();\n    return component;\n}\n\nfunction getTippyInstance({\n    element,\n    content,\n    rect,\n    onHide\n}: {\n    element: Element;\n    content: Element;\n    rect: GetReferenceClientRect;\n    onHide?: () => void;\n}) {\n    return tippy(element, {\n        appendTo: document.body,\n        content: content,\n        placement: 'auto-start',\n        getReferenceClientRect: rect,\n        showOnCreate: true,\n        interactive: true,\n        trigger: 'manual',\n        offset: [30, 0],\n        onHide\n    });\n}\n\nfunction execCommand({\n    editor,\n    range,\n    props\n}: {\n    editor: Editor;\n    range: Range;\n    props: SuggestionsCommandProps;\n}) {\n    const whatToDo = {\n        dotContent: () => {\n            editor.chain().addContentletBlock({ range, payload: props.payload }).run();\n        },\n        heading: () => {\n            editor.chain().addHeading({ range, type: props.type }).run();\n        },\n        listOrdered: () => {\n            editor.chain().deleteRange(range).toggleOrderedList().focus().run();\n        },\n        listUnordered: () => {\n            editor.chain().deleteRange(range).toggleBulletList().focus().run();\n        },\n        blockQuote: () => {\n            editor.chain().deleteRange(range).setBlockquote().focus().run();\n        },\n        codeBlock: () => {\n            editor.chain().deleteRange(range).setCodeBlock().focus().run();\n        },\n        horizontalLine: () => {\n            editor.chain().deleteRange(range).setHorizontalRule().focus().run();\n        }\n    };\n\n    whatToDo[props.type.name]\n        ? whatToDo[props.type.name]()\n        : editor.chain().setTextSelection(range).focus().run();\n}\n\nexport const ActionsMenu = (injector: Injector, resolver: ComponentFactoryResolver) => {\n    let myTippy;\n    let suggestionsComponent: ComponentRef<SuggestionsComponent>;\n\n    /**\n     * Get's called on button click or suggestion char\n     *\n     * @param {(SuggestionProps | FloatingActionsProps)} { editor, range, clientRect }\n     */\n    function onStart({ editor, range, clientRect }: SuggestionProps | FloatingActionsProps): void {\n        suggestionsComponent = getSuggestionComponent(injector, resolver);\n        suggestionsComponent.instance.onSelection = (item) => {\n            execCommand({ editor: editor, range: range, props: item });\n        };\n\n        myTippy = getTippyInstance({\n            element: editor.view.dom,\n            content: suggestionsComponent.location.nativeElement,\n            rect: clientRect,\n            onHide: () => {\n                const transaction = editor.state.tr.setMeta(FLOATING_ACTIONS_MENU_KEYBOARD, {\n                    open: false\n                });\n                editor.view.dispatch(transaction);\n            }\n        });\n    }\n\n    /**\n     * Handle the keyboard events when the suggestion are opened\n     *\n     * @param {FloatingActionsKeydownProps} { event }\n     * @return {*}  {boolean}\n     */\n    function onKeyDown({ event }: FloatingActionsKeydownProps): boolean {\n        const { key } = event;\n\n        if (key === 'Escape') {\n            myTippy.hide();\n            return true;\n        }\n\n        if (key === 'Enter') {\n            suggestionsComponent.instance.execCommand();\n            return true;\n        }\n\n        if (key === 'ArrowDown' || key === 'ArrowUp') {\n            suggestionsComponent.instance.updateSelection(event);\n            return true;\n        }\n\n        return false;\n    }\n\n    function onExit() {\n        myTippy?.destroy();\n    }\n\n    return Extension.create<FloatingMenuOptions>({\n        name: 'actionsMenu',\n        defaultOptions: {\n            pluginKey: 'actionsMenu',\n            element: null,\n            suggestion: {\n                char: '/',\n                allowSpaces: false,\n                startOfLine: true,\n                render: () => {\n                    return {\n                        onStart,\n                        onKeyDown,\n                        onExit\n                    };\n                }\n            }\n        },\n\n        addCommands() {\n            return {\n                addHeading: ({ range, type }) => ({ chain }) => {\n                    return chain()\n                        .focus()\n                        .deleteRange(range)\n                        .toggleHeading({ level: type.level })\n                        .focus()\n                        .run();\n                },\n                addContentletBlock: ({ range, payload }) => ({ chain }) => {\n                    return chain()\n                        .deleteRange(range)\n                        .command((data) => {\n                            const node = data.editor.schema.nodes.dotContent.create({\n                                data: payload\n                            });\n                            data.tr.replaceSelectionWith(node);\n                            return true;\n                        })\n                        .focus()\n                        .run();\n                }\n            };\n        },\n\n        addProseMirrorPlugins() {\n            const factoryButton = resolver.resolveComponentFactory(ActionButtonComponent);\n            const button = factoryButton.create(injector);\n\n            return [\n                FloatingActionsPlugin({\n                    command: execCommand,\n                    editor: this.editor,\n                    element: button.location.nativeElement,\n                    render: () => {\n                        return {\n                            onStart,\n                            onKeyDown,\n                            onExit\n                        };\n                    }\n                }),\n                Suggestion({\n                    editor: this.editor,\n                    ...this.options.suggestion\n                })\n            ];\n        }\n    });\n};\n","import { Node, mergeAttributes, NodeViewRenderer } from '@tiptap/core';\nimport { Injector } from '@angular/core';\nimport { DOMOutputSpec, ParseRule } from 'prosemirror-model';\nimport { ImageBlockComponent } from './image-block.component';\nimport { AngularNodeViewRenderer } from '../../../NodeViewRenderer';\n\ndeclare module '@tiptap/core' {\n    interface Commands<ReturnType> {\n        ImageBlock: {\n            /**\n             * Set Image Link mark\n             */\n            setImageLink: (attributes: { href: string }) => ReturnType;\n            /**\n             * Unset Image Link mark\n             */\n            unsetImageLink: () => ReturnType;\n        };\n    }\n}\n\nexport const ImageBlock = (injector: Injector): Node => {\n    return Node.create({\n        name: 'dotImage',\n        group: 'block',\n        inline: false,\n        draggable: true,\n\n        addAttributes() {\n            return {\n                data: {\n                    default: null,\n                    parseHTML: (element) => element.getAttribute('data'),\n                    renderHTML: (attributes) => {\n                        return { data: attributes.data };\n                    }\n                },\n                href: {\n                    default: null,\n                    parseHTML: (element) => element.getAttribute('href'),\n                    renderHTML: (attributes) => {\n                        return { href: attributes.href };\n                    }\n                }\n            };\n        },\n\n        addCommands() {\n            return {\n                setImageLink:\n                    (attributes) =>\n                    ({ commands }) => {\n                        return commands.updateAttributes('dotImage', attributes);\n                    },\n                unsetImageLink:\n                    () =>\n                    ({ commands }) => {\n                        return commands.updateAttributes('dotImage', { href: '' });\n                    }\n            };\n        },\n\n        parseHTML(): ParseRule[] {\n            return [{ tag: 'dotcms-image-block' }];\n        },\n\n        renderHTML({ HTMLAttributes }): DOMOutputSpec {\n            return ['dotcms-image-block', mergeAttributes(HTMLAttributes)];\n        },\n\n        addNodeView(): NodeViewRenderer {\n            return AngularNodeViewRenderer(ImageBlockComponent, { injector });\n        }\n    });\n};\n","import { Plugin } from 'prosemirror-state';\nimport { Decoration, DecorationSet } from 'prosemirror-view';\n\nexport const PlaceholderPlugin = new Plugin({\n    state: {\n        init() {\n            return DecorationSet.empty;\n        },\n        apply(tr, set) {\n            // Adjust decoration positions to changes made by the transaction\n            set = set.map(tr.mapping, tr.doc);\n            // See if the transaction adds or removes any placeholders\n            const action = tr.getMeta(this);\n            if (action && action.add) {\n                const deco = Decoration.widget(action.add.pos, action.add.element, {\n                    id: action.add.id\n                });\n                set = set.add(tr.doc, [deco]);\n            } else if (action && action.remove) {\n                set = set.remove(set.find(null, null, (spec) => spec.id == action.remove.id));\n            }\n            return set;\n        }\n    },\n    props: {\n        decorations(state) {\n            return this.getState(state);\n        }\n    }\n});\n","import { Plugin, PluginKey } from 'prosemirror-state';\nimport { ComponentFactoryResolver, ComponentRef, Injector } from '@angular/core';\nimport { Extension } from '@tiptap/core';\nimport { DotImageService } from './services/dot-image/dot-image.service';\nimport { EditorView } from 'prosemirror-view';\nimport { LoaderComponent, MessageType } from './components/loader/loader.component';\nimport { PlaceholderPlugin } from '../plugins/placeholder.plugin';\nimport { take } from 'rxjs/operators';\nimport { DotCMSContentlet } from '@dotcms/dotcms-models';\n\nexport const ImageUpload = (injector: Injector, resolver: ComponentFactoryResolver) => {\n    return Extension.create({\n        name: 'imageUpload',\n\n        addProseMirrorPlugins() {\n            const dotImageService = injector.get(DotImageService);\n            const loaderComponentFactory = resolver.resolveComponentFactory(LoaderComponent);\n\n            function areImageFiles(event: ClipboardEvent | DragEvent): boolean {\n                let files: FileList;\n                if (event.type === 'drop') {\n                    files = (event as DragEvent).dataTransfer.files;\n                } else {\n                    //paste\n                    files = (event as ClipboardEvent).clipboardData.files;\n                }\n                if (!!files.length) {\n                    for (let i = 0; i < files.length; i++) {\n                        if (!files[i].type.startsWith('image/')) {\n                            return false;\n                        }\n                    }\n                }\n\n                return !!files.length;\n            }\n\n            function findPlaceholder(state, id): number {\n                const decorations = PlaceholderPlugin.getState(state);\n                const found = decorations.find(null, null, (spec) => spec.id == id);\n                return found.length ? found[0].from : null;\n            }\n\n            function setPlaceHolder(view: EditorView, position: number, id: string) {\n                const loadingBlock: ComponentRef<LoaderComponent> = loaderComponentFactory.create(\n                    injector\n                );\n                const tr = view.state.tr;\n                loadingBlock.instance.data = {\n                    message: 'Uploading...',\n                    type: MessageType.INFO\n                };\n                loadingBlock.changeDetectorRef.detectChanges();\n\n                tr.setMeta(PlaceholderPlugin, {\n                    add: {\n                        id: id,\n                        pos: position,\n                        element: loadingBlock.location.nativeElement\n                    }\n                });\n\n                view.dispatch(tr);\n            }\n\n            function uploadImages(view: EditorView, files: File[], position = 0) {\n                const { schema } = view.state;\n\n                setPlaceHolder(view, position, files[0].name);\n\n                dotImageService\n                    .publishContent(files)\n                    .pipe(take(1))\n                    .subscribe(\n                        (dotAssets: DotCMSContentlet[]) => {\n                            const tr = view.state.tr;\n                            const data = dotAssets[0][Object.keys(dotAssets[0])[0]];\n                            const pos = findPlaceholder(view.state, data.name);\n                            const imageNode = schema.nodes.dotImage.create({\n                                data: data\n                            });\n                            view.dispatch(\n                                tr.replaceWith(pos, pos, imageNode).setMeta(PlaceholderPlugin, {\n                                    remove: { id: data.name }\n                                })\n                            );\n                        },\n                        (error) => {\n                            alert(error.message);\n                            view.dispatch(\n                                view.state.tr.setMeta(PlaceholderPlugin, {\n                                    remove: { id: files[0].name }\n                                })\n                            );\n                        }\n                    );\n            }\n\n            return [\n                PlaceholderPlugin,\n                new Plugin({\n                    key: new PluginKey('imageUpload'),\n                    props: {\n                        handleDOMEvents: {\n                            paste(view, event) {\n                                if (areImageFiles(event)) {\n                                    if (event.clipboardData.files.length !== 1) {\n                                        alert('Can paste just one image at a time');\n                                        return false;\n                                    }\n                                    event.preventDefault();\n                                    uploadImages(\n                                        view,\n                                        Array.from(event.clipboardData.files),\n                                        view.state.selection.to\n                                    );\n                                }\n\n                                return false;\n                            },\n\n                            drop(view, event) {\n                                if (areImageFiles(event)) {\n                                    event.preventDefault();\n                                    if (event.dataTransfer.files.length !== 1) {\n                                        alert('Can drop just one image at a time');\n                                        return false;\n                                    }\n                                    const { pos } = view.posAtCoords({\n                                        left: event.clientX,\n                                        top: event.clientY\n                                    });\n                                    uploadImages(view, Array.from(event.dataTransfer.files), pos);\n                                }\n                                return false;\n                            }\n                        }\n                    }\n                })\n            ];\n        }\n    });\n};\n","import { Extension } from '@tiptap/core';\nimport { NodeSelection, Plugin, PluginKey } from 'prosemirror-state';\nimport { EditorView } from 'prosemirror-view';\nimport { ComponentFactoryResolver, Injector } from '@angular/core';\nimport { DragHandlerComponent } from './components/drag-handler/drag-handler.component';\n\nexport const DragHandler = (injector: Injector, resolver: ComponentFactoryResolver) => {\n    return Extension.create({\n        name: 'dragHandler',\n\n        addProseMirrorPlugins() {\n            let nodeToBeDragged = null;\n            const WIDTH = 24;\n            const HANDLER_GAP = 50;\n            const dragHandlerFactory = resolver.resolveComponentFactory(DragHandlerComponent);\n            const dragHandler = dragHandlerFactory.create(injector).location.nativeElement;\n\n            function createRect(rect) {\n                if (rect == null) {\n                    return null;\n                }\n                const newRect = {\n                    left: rect.left + document.body.scrollLeft,\n                    top: rect.top + document.body.scrollTop,\n                    width: rect.width,\n                    height: rect.height,\n                    bottom: 0,\n                    right: 0\n                };\n                newRect.bottom = newRect.top + newRect.height;\n                newRect.right = newRect.left + newRect.width;\n                return newRect;\n            }\n\n            function removeNode(node) {\n                if (node && node.parentNode) {\n                    node.parentNode.removeChild(node);\n                }\n            }\n\n            function blockPosAtCoords(coords, view) {\n                const pos = view.posAtCoords(coords);\n                if (pos) {\n                    const node = getDirectChild(view.nodeDOM(pos.inside));\n                    if (node && node.nodeType === 1) {\n                        const desc = view.docView.nearestDesc(node, true);\n                        if (!(!desc || desc === view.docView)) {\n                            return desc.posBefore;\n                        }\n                    }\n                }\n                return null;\n            }\n\n            function dragStart(e, view: EditorView) {\n                if (!e.dataTransfer) return;\n                const coords = { left: e.clientX + HANDLER_GAP, top: e.clientY };\n                const pos = blockPosAtCoords(coords, view);\n                if (pos != null) {\n                    view.dispatch(\n                        view.state.tr.setSelection(NodeSelection.create(view.state.doc, pos))\n                    );\n                    const slice = view.state.selection.content();\n                    e.dataTransfer.clearData();\n                    e.dataTransfer.setDragImage(nodeToBeDragged, 10, 10);\n                    view.dragging = { slice, move: true };\n                }\n            }\n\n            // Get the direct child of the Editor. To cover cases when the user is hovering nested nodes.\n            function getDirectChild(node) {\n                while (node && node.parentNode) {\n                    if (\n                        node.classList?.contains('ProseMirror') ||\n                        node.parentNode.classList?.contains('ProseMirror')\n                    ) {\n                        break;\n                    }\n                    node = node.parentNode;\n                }\n                return node;\n            }\n\n            // Check if node has content and is not an empty <p>. To show the handler.\n            function nodeHasContent(view: EditorView, positon: number): boolean {\n                const node = view.nodeDOM(positon);\n\n                return (\n                    !!node?.hasChildNodes() &&\n                    !(node.childNodes.length === 1 && node.childNodes[0].nodeName == 'BR')\n                );\n            }\n\n            function bindEventsToDragHandler(editorView: EditorView) {\n                dragHandler.setAttribute('draggable', 'true');\n                dragHandler.addEventListener('dragstart', (e) => dragStart(e, editorView));\n                document.body.appendChild(dragHandler);\n            }\n\n            return [\n                new Plugin({\n                    key: new PluginKey('dragHandler'),\n                    view: (editorView) => {\n                        bindEventsToDragHandler(editorView);\n                        return {\n                            destroy() {\n                                removeNode(dragHandler);\n                            }\n                        };\n                    },\n                    props: {\n                        handleDOMEvents: {\n                            drop() {\n                                setTimeout(() => {\n                                    const node = document.querySelector(\n                                        '.ProseMirror-hideselection'\n                                    );\n                                    if (node) {\n                                        node.classList.remove('ProseMirror-hideselection');\n                                    }\n                                });\n                                return false;\n                            },\n                            mousemove(view, event) {\n                                const coords = {\n                                    left: event.clientX + HANDLER_GAP,\n                                    top: event.clientY\n                                };\n                                const position = view.posAtCoords(coords);\n                                if (position && nodeHasContent(view, position.inside)) {\n                                    nodeToBeDragged = getDirectChild(view.nodeDOM(position.inside));\n                                    if (\n                                        nodeToBeDragged &&\n                                        !nodeToBeDragged.classList?.contains('ProseMirror')\n                                    ) {\n                                        const rect = createRect(\n                                            nodeToBeDragged.getBoundingClientRect()\n                                        );\n                                        const win = nodeToBeDragged.ownerDocument.defaultView;\n                                        rect.top += win.pageYOffset;\n                                        rect.left += win.pageXOffset;\n                                        dragHandler.style.left = rect.left - WIDTH + 'px';\n                                        dragHandler.style.top = rect.top - 4 + 'px';\n                                        dragHandler.style.visibility = 'visible';\n                                    } else {\n                                        dragHandler.style.visibility = 'hidden';\n                                    }\n                                } else {\n                                    nodeToBeDragged = null;\n                                    dragHandler.style.visibility = 'hidden';\n                                }\n                                return false;\n                            }\n                        }\n                    }\n                })\n            ];\n        }\n    });\n};\n","import { Editor, posToDOMRect, isNodeSelection } from '@tiptap/core';\nimport { EditorState, Plugin, PluginKey, Transaction } from 'prosemirror-state';\nimport { EditorView } from 'prosemirror-view';\nimport tippy, { Instance, Props } from 'tippy.js';\n\nimport { ComponentRef } from '@angular/core';\nimport { BubbleMenuLinkFormComponent } from '../extensions/components/bubble-menu-link-form/bubble-menu-link-form.component';\n\n// Interface\nimport { PluginStorage } from '../extensions/bubble-link-form.extension';\n\n// Utils\nimport { getNodePosition } from '@dotcms/block-editor';\n\ninterface PluginState {\n    toggle: boolean;\n}\n\nexport interface BubbleLinkFormProps {\n    pluginKey: PluginKey;\n    editor: Editor;\n    element: HTMLElement;\n    tippyOptions?: Partial<Props>;\n    storage: PluginStorage;\n    component?: ComponentRef<BubbleMenuLinkFormComponent>;\n}\n\nexport type BubbleLinkFormViewProps = BubbleLinkFormProps & {\n    view: EditorView;\n};\n\nexport class BubbleLinkFormView {\n    public editor: Editor;\n\n    public element: HTMLElement;\n\n    public view: EditorView;\n\n    public tippy: Instance | undefined;\n\n    public tippyOptions?: Partial<Props>;\n\n    public pluginKey: PluginKey;\n\n    public component?: ComponentRef<BubbleMenuLinkFormComponent>;\n\n    public storage: PluginStorage;\n\n    constructor({\n        editor,\n        element,\n        view,\n        tippyOptions = {},\n        pluginKey,\n        storage,\n        component\n    }: BubbleLinkFormViewProps) {\n        this.editor = editor;\n        this.element = element;\n        this.view = view;\n\n        this.tippyOptions = tippyOptions;\n\n        // Detaches menu content from its current parent\n        this.element.remove();\n        this.element.style.visibility = 'visible';\n        this.pluginKey = pluginKey;\n        this.component = component;\n        this.storage = storage;\n\n        this.editor.on('focus', this.focusHandler);\n        this.setComponentEvents();\n    }\n\n    update(view: EditorView, prevState?: EditorState): void {\n        const next = this.pluginKey.getState(view.state);\n        const prev = this.pluginKey.getState(prevState);\n\n        // Check that the current plugin state is different to previous plugin state.\n        if (next.toggle === prev.toggle) {\n            this.detectLinkFormChanges();\n            return;\n        }\n\n        this.createTooltip();\n\n        this.tippy?.state.isVisible ? this.hide() : this.show();\n        this.detectLinkFormChanges();\n    }\n\n    focusHandler = () => {\n        if (this.tippy?.state.isVisible) {\n            this.hide();\n        }\n    };\n\n    createTooltip() {\n        const { element: editorElement } = this.editor.options;\n        const editorIsAttached = !!editorElement.parentElement;\n\n        if (this.tippy || !editorIsAttached) {\n            return;\n        }\n\n        this.tippy = tippy(editorElement, {\n            duration: 250,\n            getReferenceClientRect: null,\n            content: this.element,\n            interactive: true,\n            trigger: 'manual',\n            placement: 'bottom',\n            hideOnClick: 'toggle',\n            ...this.tippyOptions\n        });\n    }\n\n    show() {\n        this.tippy?.show();\n        // Afther show the component set values\n        this.setInputValues();\n        this.focusInput();\n        this.setTippyPosition();\n    }\n\n    hide() {\n        this.tippy?.hide();\n        // Afther show the component focus editor\n        this.editor.view.focus();\n        this.editor.commands.unsetHighlight();\n    }\n\n    setTippyPosition() {\n        const { view } = this.editor;\n        const { state } = view;\n        const { doc, selection } = state;\n        const { ranges } = selection;\n        const from = Math.min(...ranges.map((range) => range.$from.pos));\n        const to = Math.max(...ranges.map((range) => range.$to.pos));\n        this.tippy.setProps({\n            getReferenceClientRect: () => {\n                if (isNodeSelection(selection)) {\n                    const node = view.nodeDOM(from) as HTMLElement;\n                    const type = doc.nodeAt(from).type.name;\n\n                    if (node) {\n                        return getNodePosition(node, type);\n                    }\n                }\n                return posToDOMRect(view, from, to);\n            }\n        });\n    }\n\n    addLink(link: string) {\n        if (this.isDotImageNode()) {\n            this.editor.commands.setImageLink({ href: link });\n        } else {\n            this.editor.commands.setLink({ href: link });\n        }\n        this.hide();\n    }\n\n    removeLink() {\n        if (this.isDotImageNode()) {\n            this.editor.commands.unsetImageLink();\n        } else {\n            this.editor.commands.unsetLink();\n        }\n        this.hide();\n    }\n\n    setInputValues() {\n        this.component.instance.nodeLink = this.getNodeLink();\n        this.component.instance.newLink = this.getNodeLink() || this.getLinkSelect();\n    }\n\n    focusInput() {\n        this.component.instance.focusInput();\n    }\n\n    setComponentEvents() {\n        this.component.instance.hideForm.subscribe(() => this.hide());\n        this.component.instance.removeLink.subscribe(() => this.removeLink());\n        this.component.instance.setLink.subscribe((event) => this.addLink(event));\n    }\n\n    detectLinkFormChanges() {\n        this.component.changeDetectorRef.detectChanges();\n    }\n\n    getNodeLink(): string {\n        return this.editor.isActive('link')\n            ? this.editor.getAttributes('link').href\n            : this.editor.getAttributes('dotImage').href || '';\n    }\n\n    getLinkSelect() {\n        const { state } = this.editor;\n        const { from, to } = state.selection;\n        const text = state.doc.textBetween(from, to, ' ');\n\n        return this.isLink(text) ? text : '';\n    }\n\n    isLink(nodeText: string) {\n        const pattern = new RegExp(\n            '^(https?:\\\\/\\\\/)?' + // protocol\n                '((([a-z\\\\d]([a-z\\\\d-]*[a-z\\\\d])*)\\\\.)+[a-z]{2,}|' + // domain name\n                '((\\\\d{1,3}\\\\.){3}\\\\d{1,3}))' + // OR ip (v4) address\n                '(\\\\:\\\\d+)?(\\\\/[-a-z\\\\d%_.~+]*)*' + // port and path\n                '(\\\\?[;&a-z\\\\d%_.~+=-]*)?' + // query string\n                '(\\\\#[-a-z\\\\d_]*)?$',\n            'i'\n        ); // fragment locator\n        return !!pattern.test(nodeText);\n    }\n\n    isDotImageNode() {\n        const { type } = this.editor.state.doc.nodeAt(this.editor.state.selection.from);\n        return type.name === 'dotImage';\n    }\n\n    destroy() {\n        this.tippy?.destroy();\n        this.editor.off('focus', this.focusHandler);\n    }\n}\n\nexport const bubbleLinkFormPlugin = (options: BubbleLinkFormProps) => {\n    return new Plugin({\n        key: options.pluginKey as PluginKey,\n        view: (view) => new BubbleLinkFormView({ view, ...options }),\n        state: {\n            init(): PluginState {\n                return {\n                    toggle: true\n                };\n            },\n\n            apply(transaction: Transaction): PluginState {\n                const transactionMeta = transaction.getMeta(options.pluginKey);\n                if (transactionMeta) {\n                    return {\n                        toggle: options.storage.show\n                    };\n                }\n\n                return {\n                    toggle: options.storage.show\n                };\n            }\n        }\n    });\n};\n","import { Extension } from '@tiptap/core';\nimport { PluginKey } from 'prosemirror-state';\nimport { BubbleMenuLinkFormComponent } from './components/bubble-menu-link-form/bubble-menu-link-form.component';\nimport { Injector, ComponentFactoryResolver } from '@angular/core';\nimport { bubbleLinkFormPlugin } from '../plugins/bubble-link-form.plugin';\nimport { Props } from 'tippy.js';\n\nexport interface BubbleLinkFormOptions {\n    pluginKey: PluginKey;\n    tippyOptions?: Partial<Props>;\n    element: HTMLElement | null;\n}\nexport interface PluginStorage {\n    show: boolean;\n}\n\ndeclare module '@tiptap/core' {\n    interface Commands<ReturnType> {\n        bubbleLinkForm: {\n            toogleLinkForm: () => ReturnType;\n        };\n    }\n\n    interface Storage {\n        bubbleLinkForm: PluginStorage;\n    }\n}\nexport const LINK_FORM_PLUGIN_KEY = new PluginKey('addLink');\n\nexport const BubbleLinkFormExtension = (injector: Injector, resolver: ComponentFactoryResolver) => {\n    return Extension.create<BubbleLinkFormOptions>({\n        name: 'bubbleLinkForm',\n        defaultOptions: {\n            element: null,\n            tippyOptions: {},\n            pluginKey: LINK_FORM_PLUGIN_KEY\n        },\n\n        addStorage() {\n            return {\n                show: true\n            };\n        },\n\n        addCommands() {\n            return {\n                toogleLinkForm:\n                    () =>\n                    ({ commands }) => {\n                        this.storage.show = !this.storage.show;\n                        return commands.setHighlight();\n                    }\n            };\n        },\n\n        addProseMirrorPlugins() {\n            const factory = resolver.resolveComponentFactory(BubbleMenuLinkFormComponent);\n            const component = factory.create(injector);\n            component.changeDetectorRef.detectChanges();\n\n            return [\n                bubbleLinkFormPlugin({\n                    pluginKey: this.options.pluginKey,\n                    editor: this.editor,\n                    element: component.location.nativeElement,\n                    tippyOptions: this.options.tippyOptions,\n                    storage: this.storage,\n                    component: component\n                })\n            ];\n        }\n    });\n};\n","import { isTextSelection } from '@tiptap/core';\nimport { ShouldShowProps } from '@dotcms/block-editor';\n\n/**\n * Determine when the bubble menu can or cannot be displayed.\n *\n * @param {ShouldShowProps} { editor, state, from, to }\n * @return {*}\n */\nexport const shouldShowBubbleMenu = ({ editor, state, from, to }: ShouldShowProps) => {\n    const { doc, selection } = state;\n    const { empty } = selection;\n\n    // Current selected node\n    const node = editor.state.doc.nodeAt(editor.state.selection.from);\n\n    // Sometime check for `empty` is not enough.\n    // Doubleclick an empty paragraph returns a node size of 2.\n    // So we check also for an empty text size.\n    const isEmptyTextBlock = !doc.textBetween(from, to).length && isTextSelection(state.selection);\n\n    // If it's empty or the current node is type dotContent, it will not open.\n    if (empty || isEmptyTextBlock || node.type.name == 'dotContent') {\n        return false;\n    }\n\n    return true;\n};\n\nexport const getNodePosition = (node: HTMLElement, type: string): DOMRect => {\n    const img = node.getElementsByTagName('img')[0];\n    // If is a dotImage Node, get the image position\n    if (type === 'dotImage' && img) {\n        return img.getBoundingClientRect();\n    }\n    return node.getBoundingClientRect();\n};\n\nexport const isListNode = (editor): boolean => {\n    return editor.isActive('bulletList') || editor.isActive('orderedList');\n};\n\n/* Bubble Menu Items*/\nexport const bubbleMenuItems = [\n    {\n        icon: 'format_bold',\n        markAction: 'bold',\n        active: false\n    },\n    {\n        icon: 'format_underlined',\n        markAction: 'underline',\n        active: false\n    },\n    {\n        icon: 'format_italic',\n        markAction: 'italic',\n        active: false\n    },\n    {\n        icon: 'strikethrough_s',\n        markAction: 'strike',\n        active: false,\n        divider: true\n    },\n    {\n        icon: 'format_align_left',\n        markAction: 'left',\n        active: false\n    },\n    {\n        icon: 'format_align_center',\n        markAction: 'center',\n        active: false\n    },\n    {\n        icon: 'format_align_right',\n        markAction: 'right',\n        active: false,\n        divider: true\n    },\n    {\n        icon: 'format_list_bulleted',\n        markAction: 'bulletList',\n        active: false\n    },\n    {\n        icon: 'format_list_numbered',\n        markAction: 'orderedList',\n        active: false\n    },\n    {\n        icon: 'format_indent_decrease',\n        markAction: 'outdent',\n        active: false\n    },\n    {\n        icon: 'format_indent_increase',\n        markAction: 'indent',\n        active: false,\n        divider: true\n    },\n    {\n        icon: 'link',\n        markAction: 'link',\n        active: false,\n        divider: true\n    },\n    {\n        icon: 'format_clear',\n        markAction: 'clearAll',\n        active: false\n    }\n];\n\nexport const bubbleMenuImageItems = [\n    {\n        icon: 'format_align_left',\n        markAction: 'left',\n        active: false\n    },\n    {\n        icon: 'format_align_center',\n        markAction: 'center',\n        active: false\n    },\n    {\n        icon: 'format_align_right',\n        markAction: 'right',\n        active: false,\n        divider: true\n    },\n    {\n        icon: 'link',\n        markAction: 'link',\n        active: false\n    }\n];\n","import { EditorView } from 'prosemirror-view';\nimport { isNodeSelection, posToDOMRect } from '@tiptap/core';\nimport { PluginKey, Plugin, EditorState } from 'prosemirror-state';\nimport { BubbleMenuView } from '@tiptap/extension-bubble-menu';\n\n// Utils\nimport { getNodePosition } from '@dotcms/block-editor';\nimport { ComponentRef } from '@angular/core';\nimport { bubbleMenuItems, bubbleMenuImageItems, isListNode } from '../utils/bubble-menu.utils';\n\n// Model\nimport {\n    BubbleMenuItem,\n    BubbleMenuComponentProps,\n    DotBubbleMenuPluginProps,\n    DotBubbleMenuViewProps\n} from '@dotcms/block-editor';\n\nexport const DotBubbleMenuPlugin = (options: DotBubbleMenuPluginProps) => {\n    return new Plugin({\n        key:\n            typeof options.pluginKey === 'string'\n                ? new PluginKey(options.pluginKey)\n                : options.pluginKey,\n        view: (view) => new DotBubbleMenuPluginView({ view, ...options })\n    });\n};\n\nexport class DotBubbleMenuPluginView extends BubbleMenuView {\n    public component: ComponentRef<BubbleMenuComponentProps>;\n\n    /* @Overrrider */\n    constructor(props: DotBubbleMenuViewProps) {\n        // Inherit the parent class\n        super(props);\n\n        // New Properties\n        this.component = props.component;\n        this.component.instance.command.subscribe(this.exeCommand.bind(this));\n    }\n\n    /* @Overrrider */\n    update(view: EditorView, oldState?: EditorState) {\n        const { state, composing } = view;\n        const { doc, selection } = state;\n        const isSame = oldState && oldState.doc.eq(doc) && oldState.selection.eq(selection);\n\n        if (composing || isSame) {\n            return;\n        }\n\n        this.createTooltip();\n\n        // support for CellSelections\n        const { ranges } = selection;\n        const from = Math.min(...ranges.map((range) => range.$from.pos));\n        const to = Math.max(...ranges.map((range) => range.$to.pos));\n\n        const shouldShow = this.shouldShow?.({\n            editor: this.editor,\n            view,\n            state,\n            oldState,\n            from,\n            to\n        });\n\n        if (!shouldShow) {\n            this.hide();\n\n            return;\n        }\n\n        this.tippy?.setProps({\n            getReferenceClientRect: () => {\n                if (isNodeSelection(selection)) {\n                    const node = view.nodeDOM(from) as HTMLElement;\n\n                    if (node) {\n                        const type = doc.nodeAt(from).type.name;\n                        return getNodePosition(node, type);\n                    }\n                }\n\n                return posToDOMRect(view, from, to);\n            }\n        });\n        this.setMenuItems(doc, from);\n        this.updateComponent();\n        this.show();\n    }\n\n    /* @Overrrider */\n    destroy() {\n        this.tippy?.destroy();\n        this.element.removeEventListener('mousedown', this.mousedownHandler, { capture: true });\n        this.view.dom.removeEventListener('dragstart', this.dragstartHandler);\n        this.editor.off('focus', this.focusHandler);\n        this.editor.off('blur', this.blurHandler);\n        this.component.instance.command.unsubscribe();\n    }\n\n    /* Update Component */\n    updateComponent() {\n        const { items } = this.component.instance;\n        const aligment: string[] = ['left', 'center', 'right'];\n        const activeMarks = this.setActiveMarks(aligment);\n        this.component.instance.items = this.updateActiveItems(items, activeMarks);\n        this.component.changeDetectorRef.detectChanges();\n    }\n\n    updateActiveItems = (items: BubbleMenuItem[] = [], activeMarks: string[]): BubbleMenuItem[] => {\n        return items.map((item) => {\n            item.active = activeMarks.includes(item.markAction);\n            return item;\n        });\n    };\n\n    enabledMarks = (): string[] => {\n        return [...Object.keys(this.editor.schema.marks), ...Object.keys(this.editor.schema.nodes)];\n    };\n\n    setActiveMarks = (aligment = []): string[] => {\n        return [\n            ...this.enabledMarks().filter((mark) => this.editor.isActive(mark)),\n            ...aligment.filter((alignment) => this.editor.isActive({ textAlign: alignment }))\n        ];\n    };\n\n    setMenuItems(doc, from) {\n        const node = doc.nodeAt(from);\n        const isDotImage = node.type.name == 'dotImage';\n\n        this.component.instance.items = isDotImage ? bubbleMenuImageItems : bubbleMenuItems;\n    }\n\n    /* Run commands */\n    exeCommand(item: BubbleMenuItem) {\n        const { markAction: action, active } = item;\n        switch (action) {\n            case 'bold':\n                this.editor.commands.toggleBold();\n                break;\n            case 'italic':\n                this.editor.commands.toggleItalic();\n                break;\n            case 'strike':\n                this.editor.commands.toggleStrike();\n                break;\n            case 'underline':\n                this.editor.commands.toggleUnderline();\n                break;\n            case 'left':\n                this.toggleTextAlign(action, active);\n                break;\n            case 'center':\n                this.toggleTextAlign(action, active);\n                break;\n            case 'right':\n                this.toggleTextAlign(action, active);\n                break;\n            case 'bulletList':\n                this.editor.commands.toggleBulletList();\n                break;\n            case 'orderedList':\n                this.editor.commands.toggleOrderedList();\n                break;\n            case 'indent':\n                if (isListNode(this.editor)) {\n                    this.editor.commands.sinkListItem('listItem');\n                }\n                break;\n            case 'outdent':\n                if (isListNode(this.editor)) {\n                    this.editor.commands.liftListItem('listItem');\n                }\n                break;\n            case 'link':\n                this.editor.commands.toogleLinkForm();\n                break;\n            case 'clearAll':\n                this.editor.commands.unsetAllMarks();\n                this.editor.commands.clearNodes();\n                break;\n        }\n    }\n\n    toggleTextAlign(alignment, active) {\n        if (active) {\n            this.editor.commands.unsetTextAlign();\n        } else {\n            this.editor.commands.setTextAlign(alignment);\n        }\n    }\n}\n","import { ViewContainerRef, Type } from '@angular/core';\nimport BubbleMenu, { BubbleMenuOptions } from '@tiptap/extension-bubble-menu';\nimport { Props } from 'tippy.js';\nimport { DotBubbleMenuPlugin } from '../plugins/dot-bubble-menu.plugin';\nimport { shouldShowBubbleMenu } from '../utils/bubble-menu.utils';\nimport { BubbleMenuComponentProps } from '@dotcms/block-editor';\n\nconst defaultTippyOptions: Partial<Props> = {\n    duration: 500,\n    maxWidth: 'none',\n    placement: 'top-start',\n    trigger: 'manual'\n};\n\nexport function DotBubbleMenuExtension(\n    type: Type<BubbleMenuComponentProps>,\n    viewContainerRef: ViewContainerRef\n) {\n    // Create Instance Component\n    const angularComponent = viewContainerRef.createComponent(type);\n    const htmlElement = angularComponent.location.nativeElement;\n\n    return BubbleMenu.extend<BubbleMenuOptions>({\n        // Default Options\n        addOptions(): BubbleMenuOptions {\n            return {\n                element: null,\n                tippyOptions: defaultTippyOptions,\n                pluginKey: 'bubbleMenu',\n                shouldShow: shouldShowBubbleMenu\n            };\n        },\n\n        addProseMirrorPlugins() {\n            if (!htmlElement) {\n                return [];\n            }\n\n            return [\n                DotBubbleMenuPlugin({\n                    component: angularComponent,\n                    pluginKey: this.options.pluginKey,\n                    editor: this.editor,\n                    element: htmlElement,\n                    tippyOptions: this.options.tippyOptions,\n                    shouldShow: this.options.shouldShow\n                })\n            ];\n        }\n    });\n}\n","import {\n    Component,\n    OnInit,\n    ComponentFactoryResolver,\n    Injector,\n    ViewEncapsulation\n} from '@angular/core';\nimport { Editor } from '@tiptap/core';\nimport StarterKit from '@tiptap/starter-kit';\n\nimport {\n    ActionsMenu,\n    BubbleLinkFormExtension,\n    ContentletBlock,\n    DotBubbleMenuExtension,\n    DragHandler,\n    ImageBlock,\n    ImageUpload,\n    BubbleMenuComponent\n} from '@dotcms/block-editor';\n\n// Marks Extensions\nimport { Highlight } from '@tiptap/extension-highlight';\nimport { Link } from '@tiptap/extension-link';\nimport { TextAlign } from '@tiptap/extension-text-align';\nimport { Underline } from '@tiptap/extension-underline';\nimport { ViewContainerRef } from '@angular/core';\n\n@Component({\n    selector: 'dotcms-block-editor',\n    templateUrl: './dot-block-editor.component.html',\n    styleUrls: ['./dot-block-editor.component.scss'],\n    encapsulation: ViewEncapsulation.None\n})\nexport class DotBlockEditorComponent implements OnInit {\n    editor: Editor;\n\n    value = ''; // can be HTML or JSON, see https://www.tiptap.dev/api/editor#content\n\n    constructor(\n        private injector: Injector,\n        private resolver: ComponentFactoryResolver,\n        public viewContainerRef: ViewContainerRef\n    ) {}\n\n    ngOnInit() {\n        this.editor = new Editor({\n            extensions: [\n                StarterKit,\n                ContentletBlock(this.injector),\n                ImageBlock(this.injector),\n                ActionsMenu(this.injector, this.resolver),\n                DragHandler(this.injector, this.resolver),\n                ImageUpload(this.injector, this.resolver),\n                BubbleLinkFormExtension(this.injector, this.resolver),\n                DotBubbleMenuExtension(BubbleMenuComponent, this.viewContainerRef),\n                // Marks Extensions\n                Underline,\n                TextAlign.configure({ types: ['heading', 'paragraph', 'listItem', 'dotImage'] }),\n                Highlight.configure({ HTMLAttributes: { class: 'highlighted' } }),\n                Link.configure({ openOnClick: true })\n            ]\n        });\n    }\n}\n","import { Node, mergeAttributes, NodeViewRenderer } from '@tiptap/core';\nimport { DOMOutputSpec, ParseRule } from 'prosemirror-model';\nimport { Injector } from '@angular/core';\n\nimport { ContentletBlockComponent } from '../contentlet-block/contentlet-block.component';\nimport { AngularNodeViewRenderer } from '../../../NodeViewRenderer';\n\nexport type ContentletBlockOptions = {\n    HTMLAttributes: Record<string, unknown>;\n};\n\nexport const ContentletBlock = (injector: Injector): Node<ContentletBlockOptions> => {\n    return Node.create({\n        name: 'dotContent',\n        group: 'block',\n        inline: false,\n        draggable: true,\n\n        // ...configuration\n        addAttributes() {\n            return {\n                data: {\n                    default: null,\n                    parseHTML: (element) => ({\n                        data: element.getAttribute('data')\n                    }),\n                    renderHTML: (attributes) => {\n                        return { data: attributes.data };\n                    }\n                }\n            };\n        },\n\n        parseHTML(): ParseRule[] {\n            return [{ tag: 'dotcms-contentlet-block' }];\n        },\n\n        renderHTML({ HTMLAttributes }): DOMOutputSpec {\n            return ['dotcms-contentlet-block', mergeAttributes(HTMLAttributes)];\n        },\n\n        addNodeView(): NodeViewRenderer {\n            return AngularNodeViewRenderer(ContentletBlockComponent, { injector });\n        }\n    });\n};\n","import { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { BrowserAnimationsModule } from '@angular/platform-browser/animations';\nimport { of } from 'rxjs';\n\nimport { ListboxModule } from 'primeng/listbox';\nimport { OrderListModule } from 'primeng/orderlist';\nimport { MenuModule } from 'primeng/menu';\n\nimport { delay } from 'rxjs/operators';\nimport { DotBlockEditorComponent } from './dot-block-editor.component';\nimport { BubbleMenuLinkFormComponent } from '@dotcms/block-editor';\nimport {\n    ActionButtonComponent,\n    ContentletBlockComponent,\n    NgxTiptapModule,\n    SuggestionsComponent,\n    SuggestionsService,\n    ImageBlockComponent,\n    DragHandlerComponent,\n    LoaderComponent,\n    DotImageService\n} from '@dotcms/block-editor';\n\nexport default {\n    title: 'Block Editor'\n};\n\nexport const primary = () => ({\n    moduleMetadata: {\n        imports: [\n            MenuModule,\n            CommonModule,\n            FormsModule,\n            NgxTiptapModule,\n            OrderListModule,\n            ListboxModule,\n            BrowserAnimationsModule\n        ],\n        providers: [\n            {\n                provide: DotImageService,\n                useValue: {\n                    publishContent() {\n                        return of([\n                            {\n                                cd769844de530f7b5d3434b1b5cfdd62: {\n                                    asset:\n                                        'https://media.istockphoto.com/vectors/costa-rica-vector-id652225694?s=170667a',\n                                    mimeType: 'image/png',\n                                    name: 'costarica.png'\n                                }\n                            }\n                        ]).pipe(delay(800));\n                    }\n                }\n            },\n            {\n                provide: SuggestionsService,\n                useValue: {\n                    getContentTypes() {\n                        return of([\n                            {\n                                name: 'Empty Content',\n                                icon: 'hourglass_disabled',\n                                variable: 'empty'\n                            },\n                            {\n                                name: 'Blog',\n                                icon: 'article',\n                                variable: 'blog'\n                            },\n                            {\n                                name: 'Persona',\n                                icon: 'face',\n                                variable: 'persona'\n                            },\n                            {\n                                name: 'News Item',\n                                icon: 'mic',\n                                variable: 'news_item'\n                            },\n                            {\n                                name: 'Banner',\n                                icon: 'view_carousel',\n                                variable: 'banner'\n                            },\n                            {\n                                name: 'Product in the store',\n                                icon: 'inventory_2',\n                                variable: 'inventory'\n                            },\n                            {\n                                name: 'Reatil information',\n                                icon: 'storefront',\n                                variable: 'retail'\n                            }\n                        ]);\n                    },\n                    getContentlets(type) {\n                        if (type === 'empty') {\n                            return of([]).pipe(delay(800));\n                        }\n\n                        return of([\n                            {\n                                title: 'Lorem ipsum dolor sit amet, consectetuer adipiscing elit.',\n                                inode: '123'\n                            },\n                            {\n                                title: 'Aliquam tincidunt mauris eu risus.',\n                                inode: '456'\n                            },\n                            {\n                                title: 'Vestibulum auctor dapibus neque.',\n                                inode: '789'\n                            },\n                            {\n                                title: 'Nunc dignissim risus id metus.',\n                                inode: '1011'\n                            },\n                            {\n                                title: 'Cras ornare tristique elit.',\n                                inode: '1213'\n                            },\n                            {\n                                title: 'Vivamus vestibulum ntulla nec ante.',\n                                inode: '1415'\n                            },\n                            {\n                                title: 'Lorem ipsum dolor sit amet, consectetuer adipiscing elit.',\n                                inode: '123'\n                            },\n                            {\n                                title: 'Aliquam tincidunt mauris eu risus.',\n                                inode: '456'\n                            },\n                            {\n                                title: 'Vestibulum auctor dapibus neque.',\n                                inode: '789'\n                            },\n                            {\n                                title: 'Nunc dignissim risus id metus.',\n                                inode: '1011'\n                            },\n                            {\n                                title: 'Cras ornare tristique elit.',\n                                inode: '1213'\n                            },\n                            {\n                                title: 'Vivamus vestibulum ntulla nec ante.',\n                                inode: '1415'\n                            },\n                            {\n                                title: 'Lorem ipsum dolor sit amet, consectetuer adipiscing elit.',\n                                inode: '123'\n                            },\n                            {\n                                title: 'Aliquam tincidunt mauris eu risus.',\n                                inode: '456'\n                            },\n                            {\n                                title: 'Vestibulum auctor dapibus neque.',\n                                inode: '789'\n                            },\n                            {\n                                title: 'Nunc dignissim risus id metus.',\n                                inode: '1011'\n                            },\n                            {\n                                title: 'Cras ornare tristique elit.',\n                                inode: '1213'\n                            },\n                            {\n                                title: 'Vivamus vestibulum ntulla nec ante.',\n                                inode: '1415'\n                            },\n                            {\n                                title: 'Lorem ipsum dolor sit amet, consectetuer adipiscing elit.',\n                                inode: '123'\n                            },\n                            {\n                                title: 'Aliquam tincidunt mauris eu risus.',\n                                inode: '456'\n                            },\n                            {\n                                title: 'Vestibulum auctor dapibus neque.',\n                                inode: '789'\n                            },\n                            {\n                                title: 'Nunc dignissim risus id metus.',\n                                inode: '1011'\n                            },\n                            {\n                                title: 'Cras ornare tristique elit.',\n                                inode: '1213'\n                            },\n                            {\n                                title: 'Vivamus vestibulum ntulla nec ante.',\n                                inode: '1415'\n                            }\n                        ]).pipe(delay(800));\n                    }\n                }\n            }\n        ],\n        // We need these here because they are dynamically rendered\n        entryComponents: [\n            SuggestionsComponent,\n            ContentletBlockComponent,\n            ActionButtonComponent,\n            DragHandlerComponent,\n            ImageBlockComponent,\n            LoaderComponent,\n            BubbleMenuLinkFormComponent\n        ]\n    },\n    component: DotBlockEditorComponent\n});\n","\"use strict\";\n\nvar _frameworkImportPath = require(\"@storybook/angular\");\n\n/* eslint-disable import/no-unresolved */\n(0, _frameworkImportPath.configure)([require.context('./apps/dotcms-block-editor/src/app', true, /^\\.(?:(?:^|\\/|(?:(?:(?!(?:^|\\/)\\.).)*?)\\/)(?!\\.)(?=.)[^/]*?\\.stories\\.mdx)$/),require.context('./apps/dotcms-block-editor/src/app', true, /^\\.(?:(?:^|\\/|(?:(?:(?!(?:^|\\/)\\.).)*?)\\/)(?!\\.)(?=.)[^/]*?\\.stories\\.(js|jsx|ts|tsx))$/)], module, false);"],"names":["map","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","e","Error","code","keys","webpackContextKeys","Object","resolve","module","exports","webpackEmptyContext","EditorDirective","constructor","el","_renderer","outputFormat","onChange","onTouched","handleChange","transaction","docChanged","this","editor","getJSON","getHTML","writeValue","value","chain","setContent","run","registerOnChange","fn","registerOnTouched","setDisabledState","isDisabled","setEditable","setProperty","nativeElement","ngOnInit","innerHTML","appendChild","options","element","firstChild","setOptions","on","ngOnDestroy","destroy","ElementRef","Renderer2","Input","Directive","selector","providers","provide","NG_VALUE_ACCESSOR","useExisting","forwardRef","multi","FloatingMenuDirective","_el","pluginKey","tippyOptions","shouldShow","registerPlugin","unregisterPlugin","BubbleMenuDirective","DraggableDirective","draggable","handle","HostBinding","NodeViewContentDirective","AngularRenderer","component","injector","props","applicationRef","get","ApplicationRef","factory","ComponentFactoryResolver","resolveComponentFactory","componentRef","create","updateProps","attachView","hostView","instance","elementRef","dom","entries","forEach","key","detectChanges","changeDetectorRef","detachView","AngularNodeViewComponent","Component","template","AngularNodeView","mount","node","decorations","selected","extension","getPos","updateAttributes","attributes","deleteNode","renderer","config","ondragstart","onDragStart","contentDOMElement","isLeaf","document","createElement","isInline","style","whiteSpace","contentDOM","maybeMoveContentDOM","contentElement","querySelector","contains","update","type","selectNode","deselectNode","AngularNodeViewRenderer","ContentletBlockComponent","data","attrs","encapsulation","ViewEncapsulation","SuggestionsService","http","defaultHeaders","headers","set","getContentTypes","filter","pipe","pluck","getContentlets","contentType","Injectable","SuggestionsListItemComponent","role","tabindex","label","url","icon","split","length","getLabel","innerText","focus","unfocus","scrollIntoView","isIntoView","alignToTop","getBoundingClientRect","containerRect","parentElement","top","bottom","containerTop","SuggestionListComponent","ngAfterContentInit","keyManager","items","withWrap","updateSelection","event","activeItem","onKeydown","execCommand","command","setFirstItemActive","resetKeyManager","setTimeout","updateActiveItem","index","setActiveItem","ContentChildren","headerIcons","SuggestionsComponent","suggestionsService","cd","domSanitizer","title","mouseMove","onMousemove","headings","Array","level","sanitizeUrl","onSelection","name","paragraph","list","block","initContentletSelection","ngAfterViewInit","onMouseDownHandler","preventDefault","onMouseEnter","Number","target","dataset","onMouseDown","item","handleBackButton","stopPropagation","variable","take","subscribe","contentlets","contentlet","payload","bypassSecurityTrustUrl","ChangeDetectorRef","DomSanitizer","ViewChild","static","HostListener","ActionButtonComponent","StringUtils","getLine","text","indexLine","line","lines","camelize","str","replace","letter","toLowerCase","toUpperCase","titleCase","charAt","toLocaleUpperCase","slice","environment","HttpRequestUtils","getQueryParams","window","location","search","substring","Map","param","paramSplit","getQueryStringParam","results","RegExp","exec","href","decodeURIComponent","LoggerService","stringUtils","showLogs","httpRequestUtils","shouldShowLogs","console","info","message","optionalParams","wrapMessage","error","warn","debug","devMode","getCaller","caller","cleanCaller","stack","trim","substr","UserModel","loggerService","localeId","suppressAlerts","locale","checkQueryForUrl","locationQuery","q","token","idx","indexOf","end","Inject","LOCALE_ID","ApiRoot","authUser","siteId","hideFireOn","hideRulePushOptions","query","hash","parseQueryParam","configureUser","result","user","BrowserUtil","isIE11","navigator","appName","appVersion","HttpCode","CLIENTS_ONLY_MESSAGES","CwError","request","response","source","ResponseView","resp","bodyJsonObject","body","header","headerName","i18nMessagesMap","entity","tempFiles","errorsMessages","errorMessages","errors","messages","toString","status","existError","errorCode","CoreWebService","router","httpErrosSubjects","method","getRequestOpts","catchError","_original","emitHttpError","statusText","requestView","handleRequestViewErrors","err","throwError","handleResponseHttpErrors","subscribeToHttpError","httpErrorCode","asObservable","navigate","next","getHttpHeaders","params","getHttpParams","getFixedUrl","httpHeaders","getDefaultRequestHeaders","delete","startsWith","match","httpParams","DotPushPublishDialogService","showDialog$","open","providedIn","DotRouterService","goToMain","goToLogin","parameters","goToURL","isPublicUrl","isFromCoreUrl","isRootUrl","gotoPortlet","portletId","goToForgotPassword","goToNotLicensed","DotcmsConfigService","coreWebService","configParamsSubject","BehaviorSubject","configUrl","loadConfig","getConfig","res","configParams","colors","emailRegex","license","logos","menu","paginatorLinks","paginatorRows","releaseInfo","buildDate","version","websocket","websocketReconnectTime","disabledWebsockets","getTimeZones","timezones","sort","a","b","getSystemTimeZone","Protocol","_open","_close","_message","_error","message$","open$","close$","error$","reconnect","close","connect","complete","WEB_SOCKET_PROTOCOL_CODE","WebSocketProtocol","super","dataStream","test","errorThrown","socket","WebSocket","onopen","ev","onmessage","JSON","parse","onclose","NORMAL_CLOSE_CODE","onerror","readyState","LongPollingProtocol","isClosed","isAlreadyOpen","connectLongPooling","getLastCallback","lastCallback","creationDate","lastCallBack","triggerOpen","DotEventsSocketURL","useSSL","getWebSocketURL","getWebSocketProtocol","getLongPoolingURL","getHttpProtocol","ConnectionStatus","DotEventsSocket","dotEventsSocketURL","dotcmsConfigService","NONE","init","tap","CONNECTING","connectProtocol","protocolImpl","CLOSED","isConnected","CONNECTED","webSocketConfigParams","isWebSocketsBrowserSupport","getLongPollingProtocol","shouldTryWithLongPooling","getAfterErrorStatus","_event","RECONNECTING","isWebSocketProtocol","DotcmsEventsService","dotEventsSocket","subjects","messagesSub","unsubscribe","start","switchMap","subscribeTo","clientEventType","subscribeToEvents","clientEventTypes","subject","eventType","LoginService","dotcmsEventsService","_auth$","_logout$","country","lang","_loginAsUsersList$","urls","changePassword","getAuth","loginAs","logout","logoutAs","recoverPassword","serverInfo","userAuth","current","logOutUser","getCurrentUser","loginAsUsersList$","auth$","logout$","auth","_auth","isLogin$","of","loadAuth","setAuth","password","stringify","getLoginFormInfo","language","i18nKeys","setLanguage","messagesKey","userData","userId","loginAsUser","isLoginAs","loginUser","login","rememberMe","backEndLogin","watchUser","func","undefined","languageDesc","Date","getTime","RoutingService","loginService","_menusChange$","_portletUrlSource$","_currentPortlet$","urlMenus","portlets","loadMenus","bind","currentPortletId","_currentPortletId","currentMenu","menus","menusChange$","portletUrl$","firstPortlet","porlets","addPortletURL","getPortletURL","goToPortlet","isPortlet","getPortletId","has","setCurrentPortlet","currentPortlet$","setMenus","i","k","menuItems","subMenuItem","angular","menuLink","changeRefreshPortlet","urlSplit","SiteService","events","_switchSite$","_refreshSites$","currentSiteUrl","sitesUrl","switchSiteUrl","eventResponse","siteEventsHandler","setCurrentSite","loadCurrentSite","identifier","selectedSite","switchToDefaultSite","currentSite","switchSite","site","refreshSites$","switchSite$","getSiteById","sites","getCurrentSite","requestCurrentSite","AppConfig","iconPath","dotCMSURLKey","LocalStoreService","storeValue","localStorage","setItem","getValue","getItem","clearValue","removeItem","clear","DotLocalStoreModule","NgModule","NotificationService","displayErrorMessage","displayMessage","displaySuccessMessage","displayInfoMessage","_title","myNotification","Notification","DotNotificationModule","CoreWebServiceMock","_http","optionsArgs","DragHandlerComponent","ImageBlockComponent","_elementRef","updateImageAttributes","off","textAlign","LoaderComponent","uploadBinaryFile","progressCallBack","maxSize","path","formData","FormData","isArray","file","append","dotRequest","opts","Promise","rej","xhr","XMLHttpRequest","setRequestHeader","onload","upload","onprogress","percentComplete","loaded","total","send","then","catch","errorHandler","DotImageService","publishContent","setTempResource","files","push","baseType","asset","hostFolder","indexPolicy","post","Origin","hostname","from","BubbleMenuComponent","EventEmitter","preventDeSelection","Output","BubbleMenuButtonComponent","active","BubbleMenuLinkFormComponent","hideForm","removeLink","setLink","nodeLink","newLink","addLink","emit","copyLink","clipboard","writeText","alert","focusInput","input","NgxTiptapModule","imports","FormsModule","declarations","FloatingActionsView","invalidNodes","mousedownHandler","state","tr","setMeta","view","dispatch","addEventListener","capture","tippy","unmount","visibility","render","createTooltip","duration","getReferenceClientRect","content","interactive","trigger","placement","hideOnClick","prevState","selection","isRootDepth","$anchor","depth","isNodeEmpty","parent","textContent","isActive","nodeType","getState","prev","empty","includes","setProps","to","show","rect","onStart","clientRect","range","onExit","hide","removeEventListener","FloatingActionsPluginKey","FloatingActionsPlugin","apply","transactionMeta","getMeta","handleKeyDown","onKeyDown","whatToDo","dotContent","addContentletBlock","heading","addHeading","listOrdered","deleteRange","toggleOrderedList","listUnordered","toggleBulletList","blockQuote","setBlockquote","codeBlock","setCodeBlock","horizontalLine","setHorizontalRule","setTextSelection","ActionsMenu","resolver","myTippy","suggestionsComponent","getSuggestionComponent","getTippyInstance","appendTo","showOnCreate","offset","onHide","defaultOptions","suggestion","char","allowSpaces","startOfLine","addCommands","toggleHeading","schema","nodes","replaceSelectionWith","addProseMirrorPlugins","button","ImageBlock","group","inline","addAttributes","default","parseHTML","getAttribute","renderHTML","setImageLink","commands","unsetImageLink","tag","HTMLAttributes","addNodeView","PlaceholderPlugin","mapping","doc","action","add","deco","pos","remove","find","spec","ImageUpload","dotImageService","loaderComponentFactory","areImageFiles","dataTransfer","clipboardData","uploadImages","position","setPlaceHolder","loadingBlock","dotAssets","findPlaceholder","found","imageNode","dotImage","replaceWith","handleDOMEvents","paste","drop","posAtCoords","left","clientX","clientY","DragHandler","nodeToBeDragged","dragHandler","dragStart","blockPosAtCoords","coords","getDirectChild","nodeDOM","inside","desc","docView","nearestDesc","posBefore","setSelection","clearData","setDragImage","dragging","move","parentNode","classList","editorView","bindEventsToDragHandler","setAttribute","removeNode","removeChild","mousemove","nodeHasContent","positon","hasChildNodes","childNodes","nodeName","createRect","newRect","scrollLeft","scrollTop","width","height","right","win","ownerDocument","defaultView","pageYOffset","pageXOffset","BubbleLinkFormView","focusHandler","isVisible","storage","setComponentEvents","toggle","detectLinkFormChanges","editorElement","editorIsAttached","setInputValues","setTippyPosition","unsetHighlight","Math","min","ranges","$from","max","$to","nodeAt","getNodePosition","link","isDotImageNode","unsetLink","getNodeLink","getLinkSelect","getAttributes","textBetween","isLink","nodeText","LINK_FORM_PLUGIN_KEY","BubbleLinkFormExtension","addStorage","toogleLinkForm","setHighlight","shouldShowBubbleMenu","isEmptyTextBlock","img","getElementsByTagName","isListNode","bubbleMenuItems","markAction","divider","bubbleMenuImageItems","DotBubbleMenuPluginView","updateActiveItems","activeMarks","enabledMarks","marks","setActiveMarks","aligment","mark","alignment","exeCommand","oldState","isSame","eq","composing","setMenuItems","updateComponent","dragstartHandler","blurHandler","isDotImage","toggleBold","toggleItalic","toggleStrike","toggleUnderline","toggleTextAlign","sinkListItem","liftListItem","unsetAllMarks","clearNodes","unsetTextAlign","setTextAlign","defaultTippyOptions","maxWidth","DotBubbleMenuExtension","viewContainerRef","angularComponent","createComponent","htmlElement","addOptions","DotBlockEditorComponent","extensions","types","class","openOnClick","Injector","ViewContainerRef","primary","moduleMetadata","useValue","cd769844de530f7b5d3434b1b5cfdd62","mimeType","delay","inode","entryComponents","require","configure"],"sourceRoot":"webpack:///"}